<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
<title>SWI-Prolog Semantic Web Library</title>
<style type="text/css">

/* Style sheet for SWI-Prolog latex2html
*/

dd.defbody
{ margin-bottom: 1em;
}

dt.pubdef
{ background-color: #c5e1ff;
}

dt.multidef
{ background-color: #c8ffc7;
}

.bib dd
{ margin-bottom: 1em;
}

.bib dt
{ float: left;
margin-right: 1.3ex;
}

pre.code
{ margin-left: 1.5em;
margin-right: 1.5em;
border: 1px dotted;
padding-top: 5px;
padding-left: 5px;
padding-bottom: 5px;
background-color: #f8f8f8;
}

div.navigate
{ text-align: center;
background-color: #f0f0f0;
border: 1px dotted;
padding: 5px;
}

div.title
{ text-align: center;
padding-bottom: 1em;
font-size: 200%;
font-weight: bold;
}

div.author
{ text-align: center;
font-style: italic;
}

div.abstract
{ margin-top: 2em;
background-color: #f0f0f0;
border: 1px dotted;
padding: 5px;
margin-left: 10%; margin-right:10%;
}

div.abstract-title
{ text-align: center;
padding: 5px;
font-size: 120%;
font-weight: bold;
}

div.toc-h1
{ font-size: 200%;
font-weight: bold;
}

div.toc-h2
{ font-size: 120%;
font-weight: bold;
margin-left: 2em;
}

div.toc-h3
{ font-size: 100%;
font-weight: bold;
margin-left: 4em;
}

div.toc-h4
{ font-size: 100%;
margin-left: 6em;
}

span.sec-nr
{
}

span.sec-title
{
}

span.pred-ext
{ font-weight: bold;
}

span.pred-tag
{ float: right;
padding-top: 0.2em;
font-size: 80%;
font-style: italic;
color: #202020;
}

/* Footnotes */

sup.fn { color: blue; text-decoration: underline; }
span.fn-text { display: none; }
sup.fn span {display: none;}
sup:hover span
{ display: block !important;
position: absolute; top: auto; left: auto; width: 80%;
color: #000; background: white;
border: 2px solid;
padding: 5px; margin: 10px; z-index: 100;
font-size: smaller;
}

/* Lists */

dl.latex
{ margin-top: 1ex;
margin-bottom: 0.5ex;
}

dl.latex dl.latex dd.defbody
{ margin-bottom: 0.5ex;
}

/* PlDoc Tags */

dl.tags
{ font-size: 90%;
margin-left: 5ex;
margin-top: 1ex;
margin-bottom: 0.5ex;
}

dl.tags dt
{ margin-left: 0pt;
font-weight: bold;
}

dl.tags dd
{ margin-left: 3ex;
}

td.param
{ font-style: italic;
font-weight: bold;
}

/* Index */

dt.index-sep
{ font-weight: bold;
font-size: +1;
margin-top: 1ex;
}
</style>
</head>
<body bgcolor="white"> 
<div class="title">SWI-Prolog Semantic Web Library</div>
<div class="author">Jan Wielemaker <br>
University of Amsterdam/VU University Amsterdam <br>
The Netherlands <br>
E-mail: <a class="url" href="mailto:J.Wielemaker@cs.vu.nl">J.Wielemaker@cs.vu.nl</a></div>
<div class="abstract">
<div class="abstract-title">Abstract</div> This document describes a 
library for dealing with standards from the
<a class="url" href="http://www.w3c.org/">W3C</a> standard for the <em>Semantic 
Web</em>. Like the standards themselves (RDF, RDFS and OWL) this 
infrastructure is modular. It consists of Prolog packages for reading, 
querying and storing semantic web documents as well as XPCE libraries 
that provide visualisation and editing. The Prolog libraries can be used 
without the XPCE GUI modules. The library has been actively used with 
upto 10 million triples, using approximately 1GB of memory. Its 
scalability is limited by memory only. The library can be used both on 
32-bit and 64-bit platforms.
</div>

<h1><a name="document-contents">Table of Contents</a></h1>

<div class="toc">
<div class="toc-h2"><a class="sec" href="#sec:1"><span class="sec-nr">1</span> <span class="sec-title">Introduction</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:2"><span class="sec-nr">2</span> <span class="sec-title">Provided 
libraries</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:3"><span class="sec-nr">3</span> <span class="sec-title">library(semweb/rdf_db): 
The RDF database</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:3.1"><span class="sec-nr">3.1</span> <span class="sec-title">Query 
the RDF database</span></a></div>
<div class="toc-h4"><a class="sec" href="#sec:3.1.1"><span class="sec-nr">3.1.1</span> <span class="sec-title">Literal 
matching and indexing</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:3.2"><span class="sec-nr">3.2</span> <span class="sec-title">Predicate 
properties</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:3.3"><span class="sec-nr">3.3</span> <span class="sec-title">Modifying 
the database</span></a></div>
<div class="toc-h4"><a class="sec" href="#sec:3.3.1"><span class="sec-nr">3.3.1</span> <span class="sec-title">Modifying 
predicates</span></a></div>
<div class="toc-h4"><a class="sec" href="#sec:3.3.2"><span class="sec-nr">3.3.2</span> <span class="sec-title">Transactions</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:3.4"><span class="sec-nr">3.4</span> <span class="sec-title">Loading 
and saving to file</span></a></div>
<div class="toc-h4"><a class="sec" href="#sec:3.4.1"><span class="sec-nr">3.4.1</span> <span class="sec-title">library(semweb/rdf_cache): 
Caching triples</span></a></div>
<div class="toc-h4"><a class="sec" href="#sec:3.4.2"><span class="sec-nr">3.4.2</span> <span class="sec-title">Partial 
save</span></a></div>
<div class="toc-h4"><a class="sec" href="#sec:3.4.3"><span class="sec-nr">3.4.3</span> <span class="sec-title">Fast 
loading and saving</span></a></div>
<div class="toc-h4"><a class="sec" href="#sec:3.4.4"><span class="sec-nr">3.4.4</span> <span class="sec-title">MD5 
digests</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:3.5"><span class="sec-nr">3.5</span> <span class="sec-title">Namespace 
Handling</span></a></div>
<div class="toc-h4"><a class="sec" href="#sec:3.5.1"><span class="sec-nr">3.5.1</span> <span class="sec-title">Namespace 
handling for custom predicates</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:3.6"><span class="sec-nr">3.6</span> <span class="sec-title">Monitoring 
the database</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:3.7"><span class="sec-nr">3.7</span> <span class="sec-title">Miscellaneous 
predicates</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:3.8"><span class="sec-nr">3.8</span> <span class="sec-title">Issues 
with rdf_db</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:4"><span class="sec-nr">4</span> <span class="sec-title">Plugin 
modules for rdf_db</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:4.1"><span class="sec-nr">4.1</span> <span class="sec-title">Hooks 
into the RDF library</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:4.2"><span class="sec-nr">4.2</span> <span class="sec-title">library(semweb/rdf_zlib_plugin): 
Reading compressed RDF</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:4.3"><span class="sec-nr">4.3</span> <span class="sec-title">library(semweb/rdf_http_plugin): 
Reading RDF from a HTTP server</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:4.4"><span class="sec-nr">4.4</span> <span class="sec-title">library(semweb/rdf_litindex): 
Indexing words in literals</span></a></div>
<div class="toc-h4"><a class="sec" href="#sec:4.4.1"><span class="sec-nr">4.4.1</span> <span class="sec-title">Literal 
maps: Creating additional indices on literals</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:4.5"><span class="sec-nr">4.5</span> <span class="sec-title">library(semweb/rdf_persistency): 
Providing persistent storage</span></a></div>
<div class="toc-h4"><a class="sec" href="#sec:4.5.1"><span class="sec-nr">4.5.1</span> <span class="sec-title">Enriching 
the journals</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:5"><span class="sec-nr">5</span> <span class="sec-title">library(semweb/rdf_turtle): 
Turtle: Terse RDF Triple Language</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:6"><span class="sec-nr">6</span> <span class="sec-title">library(semweb/rdf_turtle_write): 
Turtle - Terse RDF Triple Language writer</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:7"><span class="sec-nr">7</span> <span class="sec-title">library(semweb/rdfs): 
RDFS related queries</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:7.1"><span class="sec-nr">7.1</span> <span class="sec-title">Hierarchy 
and class-individual relations</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:7.2"><span class="sec-nr">7.2</span> <span class="sec-title">Collections 
and Containers</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:7.3"><span class="sec-nr">7.3</span> <span class="sec-title">Labels 
and textual search</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:8"><span class="sec-nr">8</span> <span class="sec-title">Managing 
RDF input files</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:8.1"><span class="sec-nr">8.1</span> <span class="sec-title">The 
Manifest file</span></a></div>
<div class="toc-h4"><a class="sec" href="#sec:8.1.1"><span class="sec-nr">8.1.1</span> <span class="sec-title">Support 
for the VoID and VANN vocabularies</span></a></div>
<div class="toc-h4"><a class="sec" href="#sec:8.1.2"><span class="sec-nr">8.1.2</span> <span class="sec-title">Finding 
manifest files</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:8.2"><span class="sec-nr">8.2</span> <span class="sec-title">Usage 
scenarios</span></a></div>
<div class="toc-h4"><a class="sec" href="#sec:8.2.1"><span class="sec-nr">8.2.1</span> <span class="sec-title">Referencing 
resources</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:8.3"><span class="sec-nr">8.3</span> <span class="sec-title">Putting 
it all together</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:8.4"><span class="sec-nr">8.4</span> <span class="sec-title">Example: 
A metadata file for W3C WordNet</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:9"><span class="sec-nr">9</span> <span class="sec-title">library(semweb/sparql_client): 
SPARQL client library</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:10"><span class="sec-nr">10</span> <span class="sec-title">library(semweb/rdf_compare): 
Compare RDF graphs</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:11"><span class="sec-nr">11</span> <span class="sec-title">library(semweb/rdf_portray): 
Portray RDF resources</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:12"><span class="sec-nr">12</span> <span class="sec-title">library(semweb/rdf_edit): 
Keep track of edits (deprecated)</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:12.1"><span class="sec-nr">12.1</span> <span class="sec-title">Transaction 
management</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:12.2"><span class="sec-nr">12.2</span> <span class="sec-title">File 
management</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:12.3"><span class="sec-nr">12.3</span> <span class="sec-title">Encapsulated 
predicates</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:12.4"><span class="sec-nr">12.4</span> <span class="sec-title">High-level 
modification predicates</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:12.5"><span class="sec-nr">12.5</span> <span class="sec-title">Undo</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:12.6"><span class="sec-nr">12.6</span> <span class="sec-title">Journalling</span></a></div>
<div class="toc-h3"><a class="sec" href="#sec:12.7"><span class="sec-nr">12.7</span> <span class="sec-title">Broadcasting 
change events</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:13"><span class="sec-nr">13</span> <span class="sec-title">Related 
packages and issues</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:14"><span class="sec-nr">14</span> <span class="sec-title">OWL</span></a></div>
<div class="toc-h2"><a class="sec" href="#sec:15"><span class="sec-nr">15</span> <span class="sec-title">Forward 
compatibility</span></a></div>
</div>

<h2><a name="sec:1"><span class="sec-nr">1</span> <span class="sec-title">Introduction</span></a></h2>

<p>SWI-Prolog has started support for web-documents with the development 
of a small and fast SGML/XML parser, followed by an RDF parser (early 
2000). With the <code>semweb</code> library we provide more high level 
support for manipulating semantic web documents. The semantic web is the 
likely point of orientation for knowledge representation in the future, 
making a library designed in its spirit promising.

<h2><a name="sec:2"><span class="sec-nr">2</span> <span class="sec-title">Provided 
libraries</span></a></h2>

<p>Central to this library is the module <code>library(semweb/rdf_db.pl)</code>, 
providing storage and basic querying for RDF triples. This triple store 
is filled using the RDF parser realised by <code>library(rdf.pl)</code>. 
The storage module can quickly save and load (partial) databases. The 
modules
<code>library(semweb/rdfs.pl)</code> and <code>library(semweb/owl.pl)</code> 
add querying in terms of the more powerful RDFS and OWL languages. 
Module
<code>library(semweb/rdf_edit.pl)</code> adds editing, undo, journaling 
and change-forwarding. Finally, a variety of XPCE modules visualise and 
edit the database. Figure <a class="fig" href="#fig:modules">figure 1</a> 
summarised the modular design.

<p><a name="fig:modules"></a>
<center>
<img src="modules.gif">
</center>
<table align="center" width="75%"><tr><td>
<b>Figure 1 : </b>Modules for the Semantic Web library
</table>

<h2><a name="sec:3"><span class="sec-nr">3</span> <span class="sec-title">library(semweb/rdf_db): 
The RDF database</span></a></h2>

<p>The central module is called <code>rdf_db</code>. It provides storage 
and indexed querying of RDF triples. Triples are stored as a quintuple. 
The first three elements denote the RDF triple. <var>File</var> and
<var>Line</var> provide information about the origin of the triple.
<blockquote>
{<var>Subject</var> <var>Predicate</var> <var>Object</var> <var>File</var> <var>Line</var>}
</blockquote>

<p>The actual storage is provided by the <em>foreign language (C)</em> 
module <code>rdf_db.c</code>. Using a dedicated C-based implementation 
we can reduced memory usage and improve indexing capabilities.<sup class="fn">1<span class="fn-text">The 
orginal implementation was in Prolog. This version was implemented in 3 
hours, where the C-based implementation costed a full week. The C-based 
implementation requires about half the memory and provides about twice 
the performance.</span></sup> Currently the following indexing is 
provided.

<p>
<ul class="latex">
<li>Any of the 3 fields of the triple
<li><var>Subject</var> + <var>Predicate</var> and <var>Predicate</var> + <var>Object</var>
<li><var>Predicates</var> are indexed on the <em>highest property</em>. 
In other words, if predicates are related through
<code>subPropertyOf</code> predicates indexing happens on the most 
abstract predicate. This makes calls to <a name="idx:rdfhas4:1"></a><a class="pred" href="#rdf_has/4">rdf_has/4</a> 
very efficient.
<li>String literal <var>Objects</var> are indexed case-insensitive to 
make case-insensitive queries fully indexed. See <a name="idx:rdf3:2"></a><a class="pred" href="#rdf/3">rdf/3</a>.
</ul>

<h3><a name="sec:3.1"><span class="sec-nr">3.1</span> <span class="sec-title">Query 
the RDF database</span></a></h3>

<a name="sec:rdfquery"></a>

<dl class="latex">
<dt class="pubdef"><a name="rdf/3"><strong>rdf</strong>(<var>?Subject, 
?Predicate, ?Object</var>)</a></dt>
<dd class="defbody">
Elementary query for triples. <var>Subject</var> and <var>Predicate</var> 
are atoms representing the fully qualified URL of the resource. <var>Object</var> 
is either an atom representing a resource or <code>literal(Value)</code> 
if the object is a literal value. If a value of the form
<code>NameSpaceID : LocalName</code> is provided it is expanded to a 
ground atom using <a name="idx:expandgoal2:3"></a><span class="pred-ext">expand_goal/2</span>. 
This implies you can use this construct in compiled code without paying 
a performance penalty. See also
<a class="sec" href="#sec:3.5">section 3.5</a>. Literal values take one 
of the following forms:

<dl class="latex">
<dt><strong>Atom</strong></dt>
<dd class="defbody">
If the value is a simple atom it is the textual representation of a 
string literal without explicit type or language (<code>xml:lang</code>) 
qualifier.</dd>
<dt><strong>lang</strong>(<var>LangID, Atom</var>)</dt>
<dd class="defbody">
<var>Atom</var> represents the text of a string literal qualified with 
the given language.</dd>
<dt><strong>type</strong>(<var>TypeID, Value</var>)</dt>
<dd class="defbody">
Used for attributes qualified using the <code>rdf:datatype</code>
<var>TypeID</var>. The <var>Value</var> is either the textual 
representation or a natural Prolog representation. See the option
<code>convert_typed_literal(:Convertor)</code> of the parser. The 
storage layer provides efficient handling of atoms, integers (64-bit) 
and floats (native C-doubles). All other data is represented as a Prolog 
record.
</dd>
</dl>

<p>For string querying purposes, <var>Object</var> can be of the form
<code>literal(+Query, -Value)</code>, where <var>Query</var> is one of 
the terms below. Details of literal matching and indexing are described 
in <a class="sec" href="#sec:3.1.1">section 3.1.1</a>.

<dl class="latex">
<dt><strong>plain</strong>(<var>+Text</var>)</dt>
<dd class="defbody">
Perform exact match <b>and</b> demand the language or type qualifiers to 
match. This query is fully indexed.<sup class="fn">2<span class="fn-text">This 
should have been the default when using literal with one argument 
because it is logically consisent (i.e., (rdf(S,P,literal(X)), X == 
hello) would have been the same as rdf(S,P,literal(hello). In addition, 
this is consistent with SPARQL literal identity definition.</span></sup>
</dd>
<dt><strong>exact</strong>(<var>+Text</var>)</dt>
<dd class="defbody">
Perform exact, but case-insensitive match. This query is fully indexed.
</dd>
<dt><strong>substring</strong>(<var>+Text</var>)</dt>
<dd class="defbody">
Match any literal that contains <var>Text</var> as a case-insensitive 
substring. The query is not indexed on <var>Object</var>.
</dd>
<dt><strong>word</strong>(<var>+Text</var>)</dt>
<dd class="defbody">
Match any literal that contains <var>Text</var> delimited by a non 
alpha-numeric character, the start or end of the string. The query is 
not indexed on <var>Object</var>.
</dd>
<dt><strong>prefix</strong>(<var>+Text</var>)</dt>
<dd class="defbody">
Match any literal that starts with <var>Text</var>. This call is 
intended for <em>completion</em>. The query is indexed using the binary 
tree of literals. See <a class="sec" href="#sec:3.1.1">section 3.1.1</a> 
for details.
</dd>
<dt><strong>ge</strong>(<var>+Literal</var>)</dt>
<dd class="defbody">
Match any literal that is equal or larger then <var>Literal</var> in the 
ordered set of literals.
</dd>
<dt><strong>le</strong>(<var>+Literal</var>)</dt>
<dd class="defbody">
Match any literal that is equal or smaller then
<var>Literal</var> in the ordered set of literals.
</dd>
<dt><strong>between</strong>(<var>+Literal1, +Literal2</var>)</dt>
<dd class="defbody">
Match any literal that is between <var>Literal1</var> and
<var>Literal2</var> in the ordered set of literals. This may include 
both <var>Literal1</var> and <var>Literal2</var>.
</dd>
<dt><strong>like</strong>(<var>+Pattern</var>)</dt>
<dd class="defbody">
Match any literal that matches <var>Pattern</var> case insensitively, 
where the `*' character in <var>Pattern</var> matches zero or more 
characters.
</dd>
</dl>

<p>Backtracking never returns duplicate triples. Duplicates can be 
retrieved using <a name="idx:rdf4:4"></a><a class="pred" href="#rdf/4">rdf/4</a>. 
The predicate <a name="idx:rdf3:5"></a><a class="pred" href="#rdf/3">rdf/3</a> 
raises a type-error if called with improper arguments. If <a name="idx:rdf3:6"></a><a class="pred" href="#rdf/3">rdf/3</a> 
is called with a term
<code>literal(_)</code> as <var>Subject</var> or <var>Predicate</var> 
object it fails silently. This allows for graph matching goals like
<code>rdf(S,P,O),rdf(O,P2,O2)</code> to proceed without errors.<sup class="fn">3<span class="fn-text">Discussion 
in the SPARQL community votes for allowing literal values as subject. 
Although we have no principal objections, we fear such an extension will 
promote poor modelling practice.</span></sup></dd>
<dt class="pubdef"><a name="rdf/4"><strong>rdf</strong>(<var>?Subject, 
?Predicate, ?Object, ?Source</var>)</a></dt>
<dd class="defbody">
As <a name="idx:rdf3:7"></a><a class="pred" href="#rdf/3">rdf/3</a> but 
in addition return the source-location of the triple. The source is 
either a plain atom or a term of the format
<code>Atom : Integer</code> where <var>Atom</var> is intended to be used 
as filename or URL and <var>Integer</var> for representing the 
line-number. Unlike <a name="idx:rdf3:8"></a><a class="pred" href="#rdf/3">rdf/3</a>, 
this predicate does not remove duplicates from the result set.</dd>
<dt class="pubdef"><a name="rdf_has/4"><strong>rdf_has</strong>(<var>?Subject, 
?Predicate, ?Object, -TriplePred</var>)</a></dt>
<dd class="defbody">
This query exploits the RDFS <code>subPropertyOf</code> relation. It 
returns any triple whose stored predicate equals <var>Predicate</var> or 
can reach this by following the recursive <var>subPropertyOf</var> 
relation. The actual stored predicate is returned in <var>TriplePred</var>. 
The example below gets all subclasses of an RDFS (or OWL) class, even if 
the relation used is not <code>rdfs:subClassOf</code>, but a 
user-defined sub-property thereof.<sup class="fn">4<span class="fn-text">This 
predicate realises semantics defined in RDF-Schema rather than RDF. It 
is part of the <code>library(rdf_db)</code> module because the indexing 
of this module incorporates the <code>rdfs:subClassOf</code> predicate.</span></sup>

<pre class="code">
subclasses(Class, SubClasses) :-
        findall(S, rdf_has(S, rdfs:subClassOf, Class), SubClasses).
</pre>

<p>In addition, <a name="idx:rdfhas4:9"></a><a class="pred" href="#rdf_has/4">rdf_has/4</a> 
handles the predicate property (see
<a name="idx:rdfpredicateproperty2:10"></a><a class="pred" href="#rdf_predicate_property/2">rdf_predicate_property/2</a>) <code>symetric(true)</code> 
and
<code>inverse_of(P2)</code>.

<p>Note that <a name="idx:rdfhas4:11"></a><a class="pred" href="#rdf_has/4">rdf_has/4</a> 
and <a name="idx:rdfhas3:12"></a><a class="pred" href="#rdf_has/3">rdf_has/3</a> 
can return duplicate answers if they use a different <var>TriplePred</var>.</dd>
<dt class="pubdef"><a name="rdf_has/3"><strong>rdf_has</strong>(<var>?Subject, 
?Predicate, ?Object</var>)</a></dt>
<dd class="defbody">
Same as <code>rdf_has(Subject, Predicate, Object, _)</code>.</dd>
<dt class="pubdef"><a name="rdf_reachable/3"><strong>rdf_reachable</strong>(<var>?Subject, 
+Predicate, ?Object</var>)</a></dt>
<dd class="defbody">
Is true if <var>Object</var> can be reached from <var>Subject</var> 
following the transitive predicate <var>Predicate</var> or a 
sub-property thereof, while repecting the <code>symetric(true)</code> or <code>inverse_of(P2)</code> 
properties.

<p>If used with either <var>Subject</var> or <var>Object</var> unbound, 
it first returns the origin, followed by the reachable nodes in 
breath-first search-order. The implementation internally looks one 
solution ahead and succeeds deterministically on the last solution. This 
predicate never generates the same node twice and is robust against 
cycles in the transitive relation.

<p>With all arguments instantiated, it succeeds deterministically if a 
path can be found from <var>Subject</var> to <var>Object</var>. 
Searching starts at
<var>Subject</var>, assuming the branching factor is normally lower. A 
call with both <var>Subject</var> and <var>Object</var> unbound raises 
an instantiation error.<sup class="fn">5<span class="fn-text">Should be 
using bi-directional search.</span></sup> The following example 
generates all subclasses of <code>rdfs:Resource</code>:

<pre class="code">
?- rdf_reachable(X, rdfs:subClassOf, rdfs:'Resource').
X = 'http://www.w3.org/2000/01/rdf-schema#Resource' ;
X = 'http://www.w3.org/2000/01/rdf-schema#Class' ;
X = 'http://www.w3.org/1999/02/22-rdf-syntax-ns#Property' ;
...
</pre>

</dd>
<dt class="pubdef"><a name="rdf_reachable/5"><strong>rdf_reachable</strong>(<var>?Subject, 
+Predicate, ?Object, +MaxD, -D</var>)</a></dt>
<dd class="defbody">
Same as <a name="idx:rdfreachable3:13"></a><a class="pred" href="#rdf_reachable/3">rdf_reachable/3</a>, 
but in addition, <var>MaxD</var> limits the number of relations expanded 
and <var>D</var> is unified with the `distance' between
<var>Subject</var> and <var>Object</var>. Distance 0 means <var>Subject</var> 
and
<var>Object</var> are the same resource. <var>MaxD</var> can be the 
constant
<code>infinite</code> to impose no distance-limit.</dd>
<dt class="pubdef"><a name="rdf_subject/1"><strong>rdf_subject</strong>(<var>?Subject</var>)</a></dt>
<dd class="defbody">
Enumerate resources appearing as a subject in a triple. The main reason 
for this predicate is to generate the known subjects <em>without 
duplicates</em> as one gets using <code>rdf(Subject, _, _)</code>.</dd>
<dt class="pubdef"><a name="rdf_current_literal/1"><strong>rdf_current_literal</strong>(<var>-Literal</var>)</a></dt>
<dd class="defbody">
Enumerate all known literals. Like <a name="idx:rdfsubject1:14"></a><a class="pred" href="#rdf_subject/1">rdf_subject/1</a>, 
the motivation is to provide access to literals without generation 
duplicates. Otherwise the call is the same as <code>rdf(_,_,literal(Literal))</code>.
</dd>
</dl>

<h4><a name="sec:3.1.1"><span class="sec-nr">3.1.1</span> <span class="sec-title">Literal 
matching and indexing</span></a></h4>

<a name="sec:litindex"></a>

<p>Starting with version 2.5.0 of this library, literal values are 
ordered and indexed using a balanced binary tree (AVL tree). The aim of 
this index is threefold.

<p>
<ul class="latex">
<li>Unlike hash-tables, binary trees allow for efficient
<em>prefix</em> matching. Prefix matching is very useful in interactive 
applications to provide feedback while typing such as auto-completion.

<p>
<li>Having a table of unique literals we generate creation and 
destruction events (see <a name="idx:rdfmonitor2:15"></a><a class="pred" href="#rdf_monitor/2">rdf_monitor/2</a>). 
These events can be used to maintain additional indexing on literals, 
such as `by word'.

<p>
<li>A binary table allow for fast interval matching on typed numeric 
literals.<sup class="fn">6<span class="fn-text">Not yet implemented</span></sup>
</ul>

<p>As string literal matching is most frequently used for searching 
purposes, the match is executed case-insensitive and after removal of 
diacritics. Case matching and diacritics removal is based on Unicode 
character properties and independent from the current locale. Case 
conversion is based on the `simple uppercase mapping' defined by Unicode 
and diacritic removal on the `decomposition type'. The approach is 
lightweight, but somewhat simpleminded for some languages. The tables 
are generated for Unicode characters upto 0x7fff. For more information, 
please check the source-code of the mapping-table generator
<code>unicode_map.pl</code> available in the sources of this package.

<p>Currently the total order of literals is first based on the type of 
literal using the ordering 
<blockquote><var>numeric &lt; string &lt; term</var></blockquote>
Numeric values (integer and float) are ordered by value, integers 
preceed floats if they represent the same value. strings are sorted 
alphabetically after case-mapping and diacritic removal as described 
above. If they match equal, uppercase preceeds lowercase and diacritics 
are ordered on their unicode value. If they still compare equal literals 
without any qualifier preceeds literals with a type qualifier which 
preceeds literals with a language qualifier. Same qualifiers (both type 
or both language) are sorted alphabetically.<sup class="fn">7<span class="fn-text">The 
ordering defined above may change in future versions to deal with new 
queries for literals.</span></sup>

<p>The ordered tree is used for indexed execution of
<code>literal(<code>prefix(Prefix)</code>, Literal)</code> as well as
<code>literal(<code>like(Like)</code>, Literal)</code> if <var>Like</var> 
does not start with a `*'. Note that results of queries that use the 
tree index are returned in alphabetical order.

<h3><a name="sec:3.2"><span class="sec-nr">3.2</span> <span class="sec-title">Predicate 
properties</span></a></h3>

<a name="sec:predproperty"></a>

<p>The predicates below form an experimental interface to provide more 
reasoning inside the kernel of the rdb_db engine. Note that
<code>symetric</code>, <code>inverse_of</code> and <code>transitive</code> 
are not yet supported by the rest of the engine.

<dl class="latex">
<dt class="pubdef"><a name="rdf_current_predicate/1"><strong>rdf_current_predicate</strong>(<var>?Predicate</var>)</a></dt>
<dd class="defbody">
Enumerate all predicates that are used in at least one triple. Behaves 
as the code below, but much more efficient.

<pre class="code">
rdf_current_predicate(Predicate) :-
        findall(P, rdf(_,P,_), Ps),
        sort(Ps, S),
        member(Predicate, S).
</pre>

<p>Note that there is no relation to defined RDF properties. Properties 
that have no triples are not reported by this predicate, while 
predicates that are involved in triples do not need to be defined as an 
instance of rdf:Property.</dd>
<dt class="pubdef"><a name="rdf_set_predicate/2"><strong>rdf_set_predicate</strong>(<var>+Predicate, 
+Property</var>)</a></dt>
<dd class="defbody">
Define a property of the predicate. This predicate currently supports 
the properties <code>symmetric</code>, <code>inverse_of</code> and
<code>transitive</code> as defined with <a name="idx:rdfpredicateproperty2:16"></a><a class="pred" href="#rdf_predicate_property/2">rdf_predicate_property/2</a>. 
Adding an <var>A</var> inverse_of <var>B</var> also adds <var>B</var> 
inverse_of <var>A</var>. An inverse relation is deleted using <code>inverse_of([])</code>. 
`
</dd>
<dt class="pubdef"><a name="rdf_predicate_property/2"><strong>rdf_predicate_property</strong>(<var>?Predicate, 
-Property</var>)</a></dt>
<dd class="defbody">
Query properties of a defined predicate. Currently defined properties 
are given below.

<dl class="latex">
<dt><strong>symmetric</strong>(<var>Bool</var>)</dt>
<dd class="defbody">
True if the predicate is defined to be symetric. I.e.,
{A} P {B} implies {B} P {A}. Setting symmetric is equivalent to <code>inverse_of(Self)</code>.</dd>
<dt><strong>inverse_of</strong>(<var>Inverse</var>)</dt>
<dd class="defbody">
True if this predicate is the inverse of <var>Inverse</var>. This 
property is used by <a name="idx:rdfhas3:17"></a><a class="pred" href="#rdf_has/3">rdf_has/3</a>, <a name="idx:rdfhas4:18"></a><a class="pred" href="#rdf_has/4">rdf_has/4</a>, <a name="idx:rdfreachable3:19"></a><a class="pred" href="#rdf_reachable/3">rdf_reachable/3</a> 
and <a name="idx:rdfreachable5:20"></a><a class="pred" href="#rdf_reachable/5">rdf_reachable/5</a>.</dd>
<dt><strong>transitive</strong>(<var>Bool</var>)</dt>
<dd class="defbody">
True if this predicate is transitive. This predicate is currently not 
used. It might be used to make <a name="idx:rdfhas3:21"></a><a class="pred" href="#rdf_has/3">rdf_has/3</a> 
imply <a name="idx:rdfreachable3:22"></a><a class="pred" href="#rdf_reachable/3">rdf_reachable/3</a> 
for transitive predicates.</dd>
<dt><strong>triples</strong>(<var>Triples</var>)</dt>
<dd class="defbody">
Unify <var>Triples</var> with the number of existing triples using this 
predicate as second argument. Reporting the number of triples is 
intended to support query optimization.</dd>
<dt><strong>rdf_subject_branch_factor</strong>(<var>-Float</var>)</dt>
<dd class="defbody">
Unify <var>Float</var> with the average number of triples associated 
with each unique value for the subject-side of this relation. If there 
are no triples the value 0.0 is returned. This value is cached with the 
predicate and recomputed only after substantial changes to the triple 
set associated to this relation. This property is indented for path 
optimalisation when solving conjunctions of <a name="idx:rdf3:23"></a><a class="pred" href="#rdf/3">rdf/3</a> 
goals.</dd>
<dt><strong>rdf_object_branch_factor</strong>(<var>-Float</var>)</dt>
<dd class="defbody">
Unify <var>Float</var> with the average number of triples associated 
with each unique value for the object-side of this relation. In addition 
to the comments with the subject_branch_factor property, uniqueness of 
the object value is computed from the hash key rather than the actual 
values.</dd>
<dt><strong>rdfs_subject_branch_factor</strong>(<var>-Float</var>)</dt>
<dd class="defbody">
Same as <code>rdf_subject_branch_factor/1</code>, but also considering 
triples of `subPropertyOf' this relation. See also <a name="idx:rdfhas3:24"></a><a class="pred" href="#rdf_has/3">rdf_has/3</a>.</dd>
<dt><strong>rdfs_object_branch_factor</strong>(<var>-Float</var>)</dt>
<dd class="defbody">
Same as <code>rdf_object_branch_factor/1</code>, but also considering 
triples of `subPropertyOf' this relation. See also <a name="idx:rdfhas3:25"></a><a class="pred" href="#rdf_has/3">rdf_has/3</a>.
</dd>
</dl>

</dd>
</dl>

<h3><a name="sec:3.3"><span class="sec-nr">3.3</span> <span class="sec-title">Modifying 
the database</span></a></h3>

<a name="sec:rdfmodify"></a>

<p>As depicted in <a class="fig" href="#fig:modules">figure 1</a>, there 
are two levels of modification. The <code>rdf_db</code> module simply 
modifies, where the <code>rdf_edit</code> library provides transactions 
and undo on top of this. Applications that wish to use the <code>rdf_edit</code> 
layer must <em>never</em> use the predicates from this section directly.

<h4><a name="sec:3.3.1"><span class="sec-nr">3.3.1</span> <span class="sec-title">Modifying 
predicates</span></a></h4>

<a name="sec:modpreds"></a>

<dl class="latex">
<dt class="pubdef"><a name="rdf_assert/3"><strong>rdf_assert</strong>(<var>+Subject, 
+Predicate, +Object</var>)</a></dt>
<dd class="defbody">
Assert a new triple into the database. This is equivalent to
<a name="idx:rdfassert4:26"></a><a class="pred" href="#rdf_assert/4">rdf_assert/4</a> 
using <var>SourceRef</var> <code>user</code>. <var>Subject</var> and
<var>Predicate</var> are resources. <var>Object</var> is either a 
resource or a term <code>literal(Value)</code>. See <a name="idx:rdf3:27"></a><a class="pred" href="#rdf/3">rdf/3</a> 
for an explanation of <var>Value</var> for typed and language qualified 
literals. All arguments are subject to name-space expansion (see <a class="sec" href="#sec:3.5">section 
3.5</a>).</dd>
<dt class="pubdef"><a name="rdf_assert/4"><strong>rdf_assert</strong>(<var>+Subject, 
+Predicate, +Object, +SourceRef</var>)</a></dt>
<dd class="defbody">
As <a name="idx:rdfassert3:28"></a><a class="pred" href="#rdf_assert/3">rdf_assert/3</a>, 
adding <var>SourceRef</var> to specify the orgin of the triple. <var>SourceRef</var> 
is either an atom or a term of the format
<var>Atom</var>:<var>Int</var> where <var>Atom</var> normally refers to 
a filename and <var>Int</var> to the line-number where the description 
starts.</dd>
<dt class="pubdef"><a name="rdf_retractall/3"><strong>rdf_retractall</strong>(<var>?Subject, 
?Predicate, ?Object</var>)</a></dt>
<dd class="defbody">
Remove all matching triples from the database. As <a name="idx:rdfretractall4:29"></a><a class="pred" href="#rdf_retractall/4">rdf_retractall/4</a> 
using an unbound <var>SourceRef</var>.</dd>
<dt class="pubdef"><a name="rdf_retractall/4"><strong>rdf_retractall</strong>(<var>?Subject, 
?Predicate, ?Object, ?SourceRef</var>)</a></dt>
<dd class="defbody">
As <a name="idx:rdfretractall3:30"></a><a class="pred" href="#rdf_retractall/3">rdf_retractall/3</a>, 
also matching <var>SourceRef</var>. This is particulary useful to remove 
all triples coming from a loaded file. See also
<a name="idx:rdfunload1:31"></a><a class="pred" href="#rdf_unload/1">rdf_unload/1</a>.</dd>
<dt class="pubdef"><a name="rdf_update/4"><strong>rdf_update</strong>(<var>+Subject, 
+Predicate, +Object, +Action</var>)</a></dt>
<dd class="defbody">
Replaces one of the three fields on the matching triples depending on <var>Action</var>:

<dl class="latex">
<dt><strong>subject</strong>(<var>Resource</var>)</dt>
<dd class="defbody">
Changes the first field of the triple.
</dd>
<dt><strong>predicate</strong>(<var>Resource</var>)</dt>
<dd class="defbody">
Changes the second field of the triple.
</dd>
<dt><strong>object</strong>(<var>Object</var>)</dt>
<dd class="defbody">
Changes the last field of the triple to the given resource or
<code>literal(Value)</code>.
</dd>
<dt><strong>graph</strong>(<var>Graph</var>)</dt>
<dd class="defbody">
Moves the triple from its current named graph to <var>Graph</var>. Note 
that updating the source has no consequences for the semantics and 
therefore the <em>generation</em> (see <a name="idx:rdfgeneration1:32"></a><a class="pred" href="#rdf_generation/1">rdf_generation/1</a>) 
is <em>not</em> updated.
</dd>
</dl>

</dd>
<dt class="pubdef"><a name="rdf_update/5"><strong>rdf_update</strong>(<var>+Subject, 
+Predicate, +Object, +Graph, +Action</var>)</a></dt>
<dd class="defbody">
As <a name="idx:rdfupdate4:33"></a><a class="pred" href="#rdf_update/4">rdf_update/4</a> 
but allows for specifying the graph.
</dd>
</dl>

<h4><a name="sec:3.3.2"><span class="sec-nr">3.3.2</span> <span class="sec-title">Transactions</span></a></h4>

<a name="transactions"></a>

<p><a name="idx:transaction:34"></a>The predicates from <a class="sec" href="#sec:3.3.1">section 
3.3.1</a> perform immediate and atomic modifications to the database. 
There are two cases where this is not desirable:

<p>
<ol class="latex">
<li>If the database is modified using information based on reading the 
same database. A typical case is a forward reasoner examining the 
database and asserting new triples that can be deduced from the already 
existing ones. For example, <em>if <var>length(X) &gt; 2</var> then 
size(X) is large</em>:

<pre class="code">
        (   rdf(X, length, literal(L)),
            atom_number(L, IL),
            IL &gt; 2,
            rdf_assert(X, size, large),
            fail
        ;   true
        ).
</pre>

<p>Running this code without precautions causes an error because
<a name="idx:rdfassert3:35"></a><a class="pred" href="#rdf_assert/3">rdf_assert/3</a> 
tries to get a write lock on the database which has an a read operation 
(<a name="idx:rdf3:36"></a><a class="pred" href="#rdf/3">rdf/3</a> has 
choicepoints) in progress.

<p>
<li>Multi-threaded access making multiple changes to the database that 
must be handled as a unit.
</ol>

<p>Where the second case is probably obvious, the first case is less so. 
The storage layer may require reindexing after adding or deleting 
triples. Such reindexing operatations however are not possible while 
there are active read operations in other threads or from choicepoints 
that can be in the same thread. For this reason we added
<a name="idx:rdftransaction2:37"></a><a class="pred" href="#rdf_transaction/2">rdf_transaction/2</a>. 
Note that, like the predicates from
<a class="sec" href="#sec:3.3.1">section 3.3.1</a>, <a name="idx:rdftransaction2:38"></a><a class="pred" href="#rdf_transaction/2">rdf_transaction/2</a> 
raises a permission error exception if the calling thread has active 
choicepoints on the database. The problem is illustrated below. The <a name="idx:rdf3:39"></a><a class="pred" href="#rdf/3">rdf/3</a> 
call leaves a choicepoint and as the read lock originates from the 
calling thread itself the system will deadlock if it would not generate 
an exception.

<pre class="code">
1 ?- rdf_assert(a,b,c).

Yes
2 ?- rdf_assert(a,b,d).

Yes
3 ?- rdf(a,b,X), rdf_transaction(rdf_assert(a,b,e)).
ERROR: No permission to write rdf_db `default' (Operation would deadlock)
^  Exception: (8) rdf_db:rdf_transaction(rdf_assert(a, b, e)) ? no debug
4 ?-
</pre>

<dl class="latex">
<dt class="pubdef"><a name="rdf_transaction/1"><strong>rdf_transaction</strong>(<var>:Goal</var>)</a></dt>
<dd class="defbody">
Same as <code>rdf_transaction(Goal, <code>user</code>)</code>.</dd>
<dt class="pubdef"><a name="rdf_transaction/2"><strong>rdf_transaction</strong>(<var>:Goal, 
+Id</var>)</a></dt>
<dd class="defbody">
After starting a transaction, all predicates from <a class="sec" href="#sec:3.3.1">section 
3.3.1</a> append their operation to the <em>transaction</em> instead of 
modifying the database. If <var>Goal</var> succeeds rdf_transaction cuts 
all choicepoints in <var>Goal</var> and executes all recorded 
operations. If
<var>Goal</var> fails or throws an exception, all recorded operations 
are discarded and <a name="idx:rdftransaction1:40"></a><a class="pred" href="#rdf_transaction/1">rdf_transaction/1</a> 
fails or re-throws the exception.

<p>On entry, <a name="idx:rdftransaction1:41"></a><a class="pred" href="#rdf_transaction/1">rdf_transaction/1</a> 
gains exclusive access to the database, but does allow readers to come 
in from all threads. After the successful completion of <var>Goal</var> <a name="idx:rdftransaction1:42"></a><a class="pred" href="#rdf_transaction/1">rdf_transaction/1</a> 
gains completely exclusive access while performing the database updates.

<p>Transactions may be nested. Committing a nested transactions merges 
its change records into the outer transaction, while discarding a nested 
transaction simply destroys the change records belonging to the nested 
transaction.

<p>The <var>Id</var> argument may be used to identify the transaction. 
It is passed to the begin/end events posted to hooks registered with
<a name="idx:rdfmonitor2:43"></a><a class="pred" href="#rdf_monitor/2">rdf_monitor/2</a>. 
The <var>Id</var> <code>log(Term)</code> can be used to enrich the 
journal files with additional history context. See <a class="sec" href="#sec:4.5.1">section 
4.5.1</a>.</dd>
<dt class="pubdef"><a name="rdf_active_transaction/1"><strong>rdf_active_transaction</strong>(<var>?Id</var>)</a></dt>
<dd class="defbody">
True if <var>Id</var> is the identifier of a currently active 
transaction (i.e. <a name="idx:rdfactivetransaction1:44"></a><a class="pred" href="#rdf_active_transaction/1">rdf_active_transaction/1</a> 
is called from <a name="idx:rdftransaction2:45"></a><a class="pred" href="#rdf_transaction/2">rdf_transaction/2</a> 
with matching <var>Id</var>). Note that transaction identifier is not 
copied and therefore need not be ground and can be further instantiated 
during the transaction. <var>Id</var> is first unified with the 
innermost transaction and backtracking with the identifier of other 
active transaction. Fails if there is no matching transaction active, 
which includes the case where there is no transaction in progress.
</dd>
</dl>

<h3><a name="sec:3.4"><span class="sec-nr">3.4</span> <span class="sec-title">Loading 
and saving to file</span></a></h3>

<a name="sec:rdffile"></a>

<p>The <code>rdf_db</code> module can read and write RDF-XML for import 
and export as well as a binary format built for quick load and save 
described in <a class="sec" href="#sec:3.4.3">section 3.4.3</a>. Here 
are the predicates for portable RDF load and save.

<dl class="latex">
<dt class="pubdef"><a name="rdf_load/1"><strong>rdf_load</strong>(<var>+InOrList</var>)</a></dt>
<dd class="defbody">
Load triples from <var>In</var>, which is either a stream opened for 
reading, an atom specifying a filename, a URL or a list of valid inputs. 
This predicate calls <a name="idx:processrdf3:46"></a><span class="pred-ext">process_rdf/3</span> 
to read the source one description at a time, avoiding limits to the 
size of the input. By default, this predicate provides for caching the 
results for quick-load using
<a name="idx:rdfloaddb1:47"></a><a class="pred" href="#rdf_load_db/1">rdf_load_db/1</a> 
described below. Caching strategy and options are description in <a class="sec" href="#sec:3.4.1">section 
3.4.1</a>.</dd>
<dt class="pubdef"><a name="rdf_load/2"><strong>rdf_load</strong>(<var>+FileOrList, 
+Options</var>)</a></dt>
<dd class="defbody">
As <a name="idx:rdfload1:48"></a><a class="pred" href="#rdf_load/1">rdf_load/1</a>, 
providing additional options. The options are handed to the RDF parser 
and implemented by <a name="idx:processrdf3:49"></a><span class="pred-ext">process_rdf/3</span>. 
In addition, the following options are provided:

<dl class="latex">
<dt><strong>cache</strong>(<var>+Bool</var>)</dt>
<dd class="defbody">
If <code>true</code> (default), try to use cached data or create a cache 
file. Otherwise load the source.</dd>
<dt><strong>db</strong>(<var>+Graph</var>)</dt>
<dd class="defbody">
Deprecated. New code should use the <code>graph(+Graph)</code> option.</dd>
<dt><strong>format</strong>(<var>+Format</var>)</dt>
<dd class="defbody">
Specify the source format explicitly. Normally this is deduced from the 
filename extension or the mime-type. The core library understands the 
formats <code>xml</code> (RDF/XML) and <code>triples</code> (internal 
quick load and cache format).</dd>
<dt><strong>graph</strong>(<var>+Graph</var>)</dt>
<dd class="defbody">
Load the data in the given named graph. The default is the URL of the 
source.</dd>
<dt><strong>if</strong>(<var>+Condition</var>)</dt>
<dd class="defbody">
Condition under which to load the source. <var>Condition</var> is the 
same as for the Prolog <a name="idx:loadfiles2:50"></a><span class="pred-ext">load_files/2</span> 
predicate: <code>changed</code> (default) load the source if it was not 
loaded before or has changed; <code>true</code> (re-)loads the source 
unconditionally and <code>not_loaded</code> loads the source if it was 
not loaded, but does not check for modifications.</dd>
<dt><strong>silent</strong>(<var>+Bool</var>)</dt>
<dd class="defbody">
If <var>Bool</var> is <code>true</code>, the message reporting 
completion is printed using level <code>silent</code>. Otherwise the 
level is
<code>informational</code>. See also <a name="idx:printmessage2:51"></a><span class="pred-ext">print_message/2</span>.</dd>
<dt><strong>register_namespaces</strong>(<var>+Bool</var>)</dt>
<dd class="defbody">
If <code>true</code> (default <code>false</code>), register <code>xmlns:ns=url</code> 
namespace declarations as rdf_db:ns(ns,url) namespaces if there is no 
conflict.
</dd>
</dl>

</dd>
<dt class="pubdef"><a name="rdf_unload/1"><strong>rdf_unload</strong>(<var>+Spec</var>)</a></dt>
<dd class="defbody">
Remove all triples loaded from <var>Spec</var>. <var>Spec</var> is 
either a graph name or a source specificatipn. If <var>Spec</var> does 
not refer to a loaded database the predicate succeeds silently.</dd>
<dt class="pubdef"><a name="rdf_save/1"><strong>rdf_save</strong>(<var>+File</var>)</a></dt>
<dd class="defbody">
Save all known triples to the given <var>File</var>. Same as
<code>rdf_save(File,[])</code>.</dd>
<dt class="pubdef"><a name="rdf_save/2"><strong>rdf_save</strong>(<var>+File, 
+Options</var>)</a></dt>
<dd class="defbody">
Save with options. Provided options are:

<dl class="latex">
<dt><strong>graph</strong>(<var>+URI</var>)</dt>
<dd class="defbody">
Save all triples that belong to the named-graph <var>URI</var>. Saving 
arbitrary selections is possible using predicates from
<a class="sec" href="#sec:3.4.2">section 3.4.2</a>.</dd>
<dt><strong>db</strong>(<var>+FileRef</var>)</dt>
<dd class="defbody">
Deprecated synonym for <code>graph(URI)</code>.</dd>
<dt><strong>anon</strong>(<var>+Bool</var>)</dt>
<dd class="defbody">
if <code>anon(false)</code> is provided anonymous resources are only 
saved if the resource appears in the object field of another triple that 
is saved.</dd>
<dt><strong>base_uri</strong>(<var>+BaseURI</var>)</dt>
<dd class="defbody">
If provided, emit <code>xml:base</code>="<var>BaseURI</var>" in the 
header and emit all URIs that are relative to the base-uri. The <code>xml:base</code> 
declaration can be suppressed using the option
<code>write_xml_base(false)</code></dd>
<dt><strong>write_xml_base</strong>(<var>+Bool</var>)</dt>
<dd class="defbody">
If <code>false</code> (default <code>true</code>), do <em>not</em> emit 
the
<code>xml:base</code> declaration from the given <code>base_uri</code> 
option. The idea behind this option is to be able to create documents 
with URIs relative to the document itself:

<pre class="code">
        ...,
        rdf_save(File,
                 [ base_uri(BaseURI),
                   write_xml_base(false)
                 ]),
        ...
</pre>

</dd>
<dt><strong>convert_typed_literal</strong>(<var>:Converter</var>)</dt>
<dd class="defbody">
If present, raw literal values are first passed to <var>Converter</var> 
to apply the reverse of the <code>convert_typed_literal</code> option of 
the RDF parser. The <var>Converter</var> is called with the same 
arguments as in the RDF parser, but now with the last argument 
instantiated and the first two unbound. A proper convertor that can be 
used for both loading and saving must be a logical predicate.</dd>
<dt><strong>encoding</strong>(<var>+Encoding</var>)</dt>
<dd class="defbody">
Define the XML encoding used for the file. Defined values are
<code>utf8</code> (default), <code>iso_latin_1</code> and <code>ascii</code>. 
Using <code>iso_latin_1</code> or <code>ascii</code>, characters not 
covered by the encoding are emitted as XML character entities (<code>&amp;#...;</code>).</dd>
<dt><strong>document_language</strong>(<var>+XMLLang</var>)</dt>
<dd class="defbody">
The value <var>XMLLang</var> is used for the <code>xml:lang</code> 
attribute in the outermost <code>rdf:RDF</code> element. This language 
acts as a default, which implies that the <code>xml:lang</code> tag is 
only used for literals with a <em>different</em> language identifier. 
Please note that this option will cause all literals without language 
tag to be interpreted using <var>XMLLang</var>.</dd>
<dt><strong>namespaces</strong>(<var>+List</var>)</dt>
<dd class="defbody">
Explicitely specify saved namespace declarations. See <a name="idx:rdfsaveheader2:52"></a><a class="pred" href="#rdf_save_header/2">rdf_save_header/2</a> 
option namespaces for details.</dd>
<dt><strong>xml_attributes</strong>(<var>+Boolean</var>)</dt>
<dd class="defbody">
If <code>false</code> (default <code>true</code>), never use xml 
attributes to save plain literal attributes, i.e., always used an XML 
element as in
<code>\bnfmeta{name}Joe&lt;/name&gt;</code>.</dd>
<dt><strong>inline</strong>(<var>+Boolean</var>)</dt>
<dd class="defbody">
If <code>true</code> (default <code>false</code>), inline resources when 
encountered for the first time. Normally, only bnodes are handled this 
way.<sup class="fn">8<span class="fn-text">The <code>inline</code> and <code>xml_attributes</code> 
options were introduced to support the OAEI format for ontology 
alignment.</span></sup>
</dd>
</dl>

</dd>
<dt class="pubdef"><a name="rdf_graph/1"><strong>rdf_graph</strong>(<var>?DB</var>)</a></dt>
<dd class="defbody">
True if <var>DB</var> is the name of a graph with at least one triple.</dd>
<dt class="pubdef"><a name="rdf_graph_property/?Graph, ?Property"><strong>rdf_graph_property</strong>(<var>?Graph, 
?Property</var>)</a></dt>
<dd class="defbody">
rue when Property is a property of Graph. Defined properties are:

<dl class="latex">
<dt><strong>hash</strong>(<var>Hash</var>)</dt>
<dd class="defbody">
Hash is the (MD5-)hash for the content of Graph. See <a class="sec" href="#sec:3.4.4">section 
3.4.4</a> for details.
</dd>
<dt><strong>source</strong>(<var>URL</var>)</dt>
<dd class="defbody">
The graph is loaded from the Source.
</dd>
<dt><strong>source_last_modified</strong>(<var>TimeStamp</var>)</dt>
<dd class="defbody">
Time is the last-modified timestamp of Source at the moment that the 
graph was loaded from Source.
</dd>
<dt><strong>triples</strong>(<var>Count</var>)</dt>
<dd class="defbody">
True when Count is the number of triples in Graph.
</dd>
</dl>

</dd>
<dt class="pubdef"><a name="rdf_source/1"><strong>rdf_source</strong>(<var>?DB</var>)</a></dt>
<dd class="defbody">
Deprecated. Use <a name="idx:rdfgraph1:53"></a><a class="pred" href="#rdf_graph/1">rdf_graph/1</a> 
or <a name="idx:rdfsource2:54"></a><a class="pred" href="#rdf_source/2">rdf_source/2</a> 
in new code.</dd>
<dt class="pubdef"><a name="rdf_source/2"><strong>rdf_source</strong>(<var>?DB, 
?SourceURL</var>)</a></dt>
<dd class="defbody">
True if the named graph <var>DB</var> was loaded from the source
<var>SourceURL</var>. A named graph is associated with a <var>SourceURL</var> 
by
<a name="idx:rdfload2:55"></a><a class="pred" href="#rdf_load/2">rdf_load/2</a>. 
The association is stored in the internal binary format, which ensures 
proper maintenance of the original source through caching and the 
persistency layer.</dd>
<dt class="pubdef"><a name="rdf_make/0"><strong>rdf_make</strong></a></dt>
<dd class="defbody">
Re-load all RDF sourcefiles (see <a name="idx:rdfsource1:56"></a><a class="pred" href="#rdf_source/1">rdf_source/1</a>) 
that have changed since they were loaded the last time. This implies all 
triples that originate from the file are removed and the file is 
re-loaded. If the file is cached a new cache-file is written. Please 
note that the new triples are added at the end of the database, possibly 
changing the order of (conflicting) triples.
</dd>
</dl>

<h4><a name="sec:3.4.1"><span class="sec-nr">3.4.1</span> <span class="sec-title">library(semweb/rdf_cache): 
Caching triples</span></a></h4>

<a name="sec:rdfcache"></a>

<p>The library <code>library(semweb/rdf_cache)</code> defines the 
caching strategy for triples sources. When using large RDF sources, 
caching triples greatly speedup loading RDF documents. The cache library 
implements two caching strategies that are controlled by <a name="idx:rdfsetcacheoptions1:57"></a><a class="pred" href="#rdf_set_cache_options/1">rdf_set_cache_options/1</a>.

<p><b>Local caching</b> This approach applies to files only. Triples are 
cached in a sub-directory of the directory holding the source. This 
directory is called <code>.cache</code> (<code>_cache</code> on 
Windows). If the cache option <code>create_local_directory</code> is <code>true</code>, 
a cache directory is created if posible.

<p><b>Global caching</b> This approach applies to all sources, except 
for unnamed streams. Triples are cached in directory defined by the 
cache option <code>global_directory</code>.

<p>When loading an RDF file, the system scans the configured cache files 
unless <code>cache(false)</code> is specified as option to <a name="idx:rdfload2:58"></a><a class="pred" href="#rdf_load/2">rdf_load/2</a> 
or caching is disabled. If caching is enabled but no cache exists, the 
system will try to create a cache file. First it will try to do this 
locally. On failure it will try to configured global cache.

<dl class="latex">
<dt class="pubdef"><a name="rdf_set_cache_options/1"><strong>rdf_set_cache_options</strong>(<var>+Options</var>)</a></dt>
<dd class="defbody">
Set cache options. Defined options are:

<dl class="latex">
<dt><strong>enabled</strong>(<var>Bool</var>)</dt>
<dd class="defbody">
If <code>true</code> (default), caching is enabled.</dd>
<dt><strong>local_directory</strong>(<var>Atom</var>)</dt>
<dd class="defbody">
Local directory to use for caching. Default <code>.cache</code> 
(Windows: <code>_cache</code>).</dd>
<dt><strong>create_local_directory</strong>(<var>Bool</var>)</dt>
<dd class="defbody">
If <code>true</code> (default <code>false</code>), create a local cache 
directory if none exists and the directory can be created.</dd>
<dt><strong>global_directory</strong>(<var>Atom</var>)</dt>
<dd class="defbody">
Global directory to use for caching. The directory is created if the 
option <code>create_global_directory</code> is also given and set to
<code>true</code>. Sub-directories are created to speedup indexing on 
filesystems that perform poorly on directories with large numbers of 
files. Initially not defined.</dd>
<dt><strong>create_global_directory</strong>(<var>Bool</var>)</dt>
<dd class="defbody">
If <code>true</code> (default <code>false</code>), create a global cache 
directory if none exists.

<p></dd>
</dl>

</dd>
</dl>

<h4><a name="sec:3.4.2"><span class="sec-nr">3.4.2</span> <span class="sec-title">Partial 
save</span></a></h4>

<a name="sec:partsave"></a>

<p>Sometimes it is necessary to make more arbitrary selections of 
material to be saved or exchange RDF descriptions over an open network 
link. The predicates in this section provide for this. Character 
encoding issues are derived from the encoding of the <var>Stream</var>, 
providing support for
<code>utf8</code>, <code>iso_latin_1</code> and <code>ascii</code>.

<dl class="latex">
<dt class="pubdef"><a name="rdf_save_header/2"><strong>rdf_save_header</strong>(<var>+Stream, 
+Options</var>)</a></dt>
<dd class="defbody">
Save an RDF header, with the XML header, <code>DOCTYPE</code>,
<code>ENTITY</code> and opening the <code>rdf:RDF</code> element with 
appropriate namespace declarations. It uses the primitives from <a class="sec" href="#sec:3.5">section 
3.5</a> to generate the required namespaces and desired short-name. <var>Options</var> 
is one of:

<dl class="latex">
<dt><strong>graph</strong>(<var>+URI</var>)</dt>
<dd class="defbody">
Only search for namespaces used in triples that belong to the given 
named graph.</dd>
<dt><strong>db</strong>(<var>+FileRef</var>)</dt>
<dd class="defbody">
Deprecated synonym for <code>graph(FileRef)</code>.</dd>
<dt><strong>namespaces</strong>(<var>+List</var>)</dt>
<dd class="defbody">
Where <var>List</var> is a list of namespace abbreviations (see
<a class="sec" href="#sec:3.5">section 3.5</a>). With this option, the 
expensive search for all namespaces that may be used by your data is 
omitted. The namespaces <code>rdf</code> and <code>rdfs</code> are added 
to the provided
<var>List</var>. If a namespace is not declared, the resource is emitted 
in non-abreviated form.
</dd>
</dl>

</dd>
<dt class="pubdef"><a name="rdf_save_footer/1"><strong>rdf_save_footer</strong>(<var>+Stream</var>)</a></dt>
<dd class="defbody">
Close the work opened with <a name="idx:rdfsaveheader2:59"></a><a class="pred" href="#rdf_save_header/2">rdf_save_header/2</a>.</dd>
<dt class="pubdef"><a name="rdf_save_subject/3"><strong>rdf_save_subject</strong>(<var>+Stream, 
+Subject, :Options</var>)</a></dt>
<dd class="defbody">
Save everything known about <var>Subject</var>. Options:

<dl class="latex">
<dt><strong>graph</strong>(<var>+Graph</var>)</dt>
<dd class="defbody">
Only save properties from <var>Graph</var>.
</dd>
<dt><strong>base_uri</strong>(<var>+URI</var>)</dt>
<dt><strong>convert_typed_literal</strong>(<var>:Goal</var>)</dt>
<dt><strong>document_language</strong>(<var>+XMLLang</var>)</dt>
<dd class="defbody">
See <a name="idx:rdfsave2:60"></a><a class="pred" href="#rdf_save/2">rdf_save/2</a> 
for a description of these options.
</dd>
</dl>

</dd>
<dt class="pubdef"><a name="rdf_quote_uri/2"><strong>rdf_quote_uri</strong>(<var>+URI, 
-Quoted</var>)</a></dt>
<dd class="defbody">
Quote a UNICODE <var>URI</var>. First the Unicode is represented as 
UTF-8 and then the unsafe characters are mapped to be represented as 
US-ASCII.
</dd>
</dl>

<h4><a name="sec:3.4.3"><span class="sec-nr">3.4.3</span> <span class="sec-title">Fast 
loading and saving</span></a></h4>

<a name="sec:rdffastfile"></a>

<p>Loading and saving RDF format is relatively slow. For this reason we 
designed a binary format that is more compact, avoids the complications 
of the RDF parser and avoids repetitive lookup of (URL) identifiers. 
Especially the speed improvement of about 25 times is worth-while when 
loading large databases. These predicates are used for caching by
<a name="idx:rdfload12:61"></a><a class="pred" href="#rdf_load/1">rdf_load/[1,2]</a> 
under certain conditions.

<dl class="latex">
<dt class="pubdef"><a name="rdf_save_db/1"><strong>rdf_save_db</strong>(<var>+File</var>)</a></dt>
<dd class="defbody">
Save all known triples into <var>File</var>. The saved version includes 
the
<var>SourceRef</var> information.</dd>
<dt class="pubdef"><a name="rdf_save_db/1"><strong>rdf_save_db</strong>(<var>+File, 
+FileRef</var>)</a></dt>
<dd class="defbody">
Save all triples with <var>SourceRef</var> <var>FileRef</var>, 
regardless of the line-number. For example, using <code>user</code> all 
information added using <a name="idx:rdfassert3:62"></a><a class="pred" href="#rdf_assert/3">rdf_assert/3</a> 
is stored in the database.</dd>
<dt class="pubdef"><a name="rdf_load_db/1"><strong>rdf_load_db</strong>(<var>+File</var>)</a></dt>
<dd class="defbody">
Load triples from <var>File</var>.
</dd>
</dl>

<h4><a name="sec:3.4.4"><span class="sec-nr">3.4.4</span> <span class="sec-title">MD5 
digests</span></a></h4>

<a name="sec:md5"></a>

<p>The <code>rdf_db</code> library provides for <em>MD5 digests</em>. An 
MD5 digest is a 128 bit long hash key computed from the triples based on 
the RFC-1321 standard. MD5 keys are computed for each individual triple 
and added together to compute the final key, resulting in a key that 
describes the triple-set but is independant from the order in which the 
triples appear. It is claimed that it is practically impossible for two 
different datasets to generate the same MD5 key. The Triple20 editor 
uses the MD5 key for detecting whether the triples associated to a file 
have changed as well as to maintain a directory with snapshots of 
versioned ontology files.

<dl class="latex">
<dt class="pubdef"><a name="rdf_md5/2"><strong>rdf_md5</strong>(<var>+Graph, 
-MD5</var>)</a></dt>
<dd class="defbody">
Return the MD5 digest for all triples in the database associated to
<var>Graph</var>. The <var>MD5</var> digest itself is represented as an 
atom holding a 32-character hexadecimal string. The library maintains 
the digest incrementally on <a name="idx:rdfload12:63"></a><a class="pred" href="#rdf_load/1">rdf_load/[1,2]</a>, <a name="idx:rdfloaddb1:64"></a><a class="pred" href="#rdf_load_db/1">rdf_load_db/1</a>, <a name="idx:rdfassert34:65"></a><a class="pred" href="#rdf_assert/3">rdf_assert/[3,4]</a> 
and <a name="idx:rdfretractall34:66"></a><a class="pred" href="#rdf_retractall/3">rdf_retractall/[3,4]</a>. 
Checking whether the digest has changed since the last <a name="idx:rdfload12:67"></a><a class="pred" href="#rdf_load/1">rdf_load/[1,2]</a> 
call provides a practical means for checking whether the file needs to 
be saved.

<p>Deprecated. New code should use <code>rdf_graph_property(Graph, 
hash(Hash))</code>.</dd>
<dt class="pubdef"><a name="rdf_atom_md5/3"><strong>rdf_atom_md5</strong>(<var>+Text, 
+Times, -MD5</var>)</a></dt>
<dd class="defbody">
Computes the MD5 hash from <var>Text</var>, which is an atom, string or 
list of character codes. <var>Times</var> is an integer <var>&gt;= 1</var>. 
When
<var>&gt; 0</var>, the MD5 algorithm is repeated <var>Times</var> times 
on the generated hash. This can be used for password encryption 
algorithms to make generate-and-test loops slow.

<p>Deprecated. New code should use the <code>library(crypt)</code> 
library provided by the <tt>clib</tt> package.
</dd>
</dl>

<h3><a name="sec:3.5"><span class="sec-nr">3.5</span> <span class="sec-title">Namespace 
Handling</span></a></h3>

<a name="sec:rdfns"></a>

<p>Prolog code often contains references to constant resources in a 
known XML namespace. For example,
<code>http://www.w3.org/2000/01/rdf-schema#Class</code> refers to the 
most general notion of a class. Readability and maintability concerns 
require for abstraction here. The dynamic and multifile predicate 
rdf_db:ns/2 maintains a mapping between short meaningful names and 
namespace locations very much like the XML <code>xmlns</code> construct. 
The initial mapping contains the namespaces required for the semantic 
web languages themselves:

<pre class="code">
ns(rdf,     'http://www.w3.org/1999/02/22-rdf-syntax-ns#').
ns(rdfs,    'http://www.w3.org/2000/01/rdf-schema#').
ns(owl,     'http://www.w3.org/2002/7/owl#').
ns(xsd,     'http://www.w3.org/2000/10/XMLSchema#').
ns(dc,      'http://purl.org/dc/elements/1.1/').
ns(dcterms, 'http://purl.org/dc/terms/').
ns(skos,    'http://www.w3.org/2004/02/skos/core#').
ns(eor,     'http://dublincore.org/2000/03/13/eor#').

</pre>

<p>All predicates for the semweb libraries use <a name="idx:goalexpansion2:68"></a><span class="pred-ext">goal_expansion/2</span> 
rules to make the SWI-Prolog compiler rewrite terms of the form
<code>Id : Local</code> into the fully qualified URL. In addition, the 
following predicates are supplied:

<dl class="latex">
<dt class="pubdef"><a name="rdf_equal/2"><strong>rdf_equal</strong>(<var>Resource1, 
Resource2</var>)</a></dt>
<dd class="defbody">
Defined as <code>Resource1 = Resource2</code>. As this predicate is 
subject to goal-expansion it can be used to obtain or test global URL 
values to readable values. The following goal unifies <var>X</var> with
<code>http://www.w3.org/2000/01/rdf-schema#Class</code> without more 
runtime overhead than normal Prolog unification.

<pre class="code">
        rdf_equal(rdfs:'Class', X)
</pre>

</dd>
<dt class="pubdef"><span class="pred-tag">[nondet]</span><a name="rdf_current_ns/2"><strong>rdf_current_ns</strong>(<var>?Alias, 
?URI</var>)</a></dt>
<dd class="defbody">
Query defined namespace aliases (prefixes).<sup class="fn">9<span class="fn-text">Older 
versions of this library did not export the table rdf_db:ns/2. Please 
use this new public interface.</span></sup></dd>
<dt class="pubdef"><a name="rdf_register_ns/2"><strong>rdf_register_ns</strong>(<var>+Alias, 
+URL</var>)</a></dt>
<dd class="defbody">
Same as <code>rdf_register_ns(Alias, URL,[])</code>.</dd>
<dt class="pubdef"><a name="rdf_register_ns/2"><strong>rdf_register_ns</strong>(<var>+Alias, 
+URL, +Options</var>)</a></dt>
<dd class="defbody">
Register <var>Alias</var> as a shorthand for <var>URL</var>. Note that 
the registration must be done before loading any files using them as 
namespace aliases are handled at compiletime through <a name="idx:goalexpansion2:69"></a><span class="pred-ext">goal_expansion/2</span>. 
If <var>Alias</var> already exists the default is to raise a permission 
error. If the option <code>force(true)</code> is provided, the alias is 
silently modified. Rebinding an alias must be done <em>before</em> any 
code is compiled that relies on the alias. If the option
<code>keep(true)</code> is provided the new registration is silently 
ignored.</dd>
<dt class="pubdef"><a name="rdf_global_id/2"><strong>rdf_global_id</strong>(<var>?Alias:Local, 
?Global</var>)</a></dt>
<dd class="defbody">
Runtime translation between <var>Alias</var> and <var>Local</var> and a
<var>Global</var> URL. Expansion is normally done at compiletime. This 
predicate is often used to turn a global URL into a more readable term.</dd>
<dt class="pubdef"><a name="rdf_global_object/2"><strong>rdf_global_object</strong>(<var>?Object, 
?NameExpandedObject</var>)</a></dt>
<dd class="defbody">
As <a name="idx:rdfglobalid2:70"></a><a class="pred" href="#rdf_global_id/2">rdf_global_id/2</a>, 
but also expands the type field if the object is of the form <code>literal(<code>type(Type, 
Value)</code>)</code>. This predicate is used for goal expansion of the 
object fields in <a name="idx:rdf3:71"></a><a class="pred" href="#rdf/3">rdf/3</a> 
and similar goals.</dd>
<dt class="pubdef"><a name="rdf_global_term/2"><strong>rdf_global_term</strong>(<var>+Term0, 
-Term</var>)</a></dt>
<dd class="defbody">
Expands all <var>Alias</var>:<var>Local</var> in <var>Term0</var> and 
return the result in <var>Term</var>. Use infrequently for runtime 
expansion of namespace identifiers.
</dd>
</dl>

<h4><a name="sec:3.5.1"><span class="sec-nr">3.5.1</span> <span class="sec-title">Namespace 
handling for custom predicates</span></a></h4>

<p>If we implement a new predicate based on one of the predicates of the 
semweb libraries that expands namespaces, namespace expansion is not 
automatically available to it. Consider the following code computing the 
number of distinct objects for a certain property on a certain object.

<pre class="code">
cardinality(S, P, C) :-
        (   setof(O, rdf_has(S, P, O), Os)
        -&gt;  length(Os, C)
        ;   C = 0
        ).
</pre>

<p>Now assume we want to write <a name="idx:labels2:72"></a><span class="pred-ext">labels/2</span> 
that returns the number of distict labels of a resource:

<pre class="code">
labels(S, C) :-
        cardinality(S, rdfs:label, C).
</pre>

<p>This code will <em>not work</em> as <code>rdfs:label</code> is not 
expanded at compile time. To make this work, we need to add an <a name="idx:rdfmeta1:73"></a><a class="pred" href="#rdf_meta/1">rdf_meta/1</a> 
declaration.

<pre class="code">
:- rdf_meta
        cardinality(r,r,-).
</pre>

<dl class="latex">
<dt class="pubdef"><a name="rdf_meta/1"><strong>rdf_meta</strong>(<var>:Heads</var>)</a></dt>
<dd class="defbody">
This predicate defines the argument types of the named predicates, which 
will force compile time namespace expansion for these predicates.
<var>Heads</var> is a coma-separated list of callable terms. Defined 
argument properties are:

<dl class="latex">
<dt><strong><code>:</code></strong></dt>
<dd class="defbody">
Argument is a goal. The goal is processed using <a name="idx:expandgoal2:74"></a><span class="pred-ext">expand_goal/2</span>, 
recursively applying goal transformation on the argument.
</dd>
<dt><strong><code>+</code></strong></dt>
<dd class="defbody">
The argument is instantiated at entry. Nothing is changed.
</dd>
<dt><strong><code>-</code></strong></dt>
<dd class="defbody">
The argument is not instantiated at entry. Nothing is changed.
</dd>
<dt><strong><code>?</code></strong></dt>
<dd class="defbody">
The argument is unbound or instantiated at entry. Nothing is changed.
</dd>
<dt><strong>@</strong></dt>
<dd class="defbody">
The argument is not changed.
</dd>
<dt><strong>r</strong></dt>
<dd class="defbody">
The argument must be a resource. If it is a term &lt;<var>namespace</var>&gt;:&lt;<var>local</var>&gt; 
it is translated.
</dd>
<dt><strong>o</strong></dt>
<dd class="defbody">
The argument is an object or resource.
</dd>
<dt><strong>t</strong></dt>
<dd class="defbody">
The argument is a term that must be translated. Expansion will translate 
all occurences of &lt;<var>namespace</var>&gt;:&lt;<var>local</var>&gt; 
appearing anywhere in the term.
</dd>
</dl>

<p>As it is subject to <a name="idx:termexpansion2:75"></a><span class="pred-ext">term_expansion/2</span>, 
the <a name="idx:rdfmeta1:76"></a><a class="pred" href="#rdf_meta/1">rdf_meta/1</a> 
declaration can only be used as a <em>directive</em>. The directive must 
be processed before the definition of the predicates as well as before 
compiling code that uses the rdf meta-predicates. The atom <code>rdf_meta</code> 
is declared as an operator exported from library <code>rdf_db.pl</code>. 
Files using
<a name="idx:rdfmeta1:77"></a><a class="pred" href="#rdf_meta/1">rdf_meta/1</a> <em>must</em> 
explicitely load <code>rdf_db.pl</code>. The example below defines the 
rule <a name="idx:concept1:78"></a><span class="pred-ext">concept/1</span>.

<pre class="code">
:- use_module(library(semweb/rdf_db)).  % for rdf_meta
:- use_module(library(semweb/rdfs)).    % for rdfs_individual_of

:- rdf_meta
        concept(r).

%%      concept(?C) is nondet.
%
%       True if C is a concept.

concept(C) :-
        rdfs_individual_of(C, skos:'Concept').
</pre>

<p></dd>
</dl>

<p>In addition to expanding <em>calls</em>, <a name="idx:rdfmeta1:79"></a><a class="pred" href="#rdf_meta/1">rdf_meta/1</a> 
also causes expansion of clause-heads for predicates that match a 
declaration. This is typically used write Prolog statements about 
resources. The following example produces three clauses with expanded 
(single-atom) arguments:

<pre class="code">
:- use_module(library(semweb/rdf_db)).

:- rdf_meta
        label_predicate(r).

label_predicate(rdfs:label).
label_predicate(skos:prefLabel).
label_predicate(skos:altLabel).
</pre>

<h3><a name="sec:3.6"><span class="sec-nr">3.6</span> <span class="sec-title">Monitoring 
the database</span></a></h3>

<a name="sec:rdfmonitor"></a>

<p>Considering performance and modularity, we are working on a 
replacement of the <code>rdf_edit</code> (see <a class="sec" href="#sec:12">section 
12</a>) layered design to deal with updates, journalling, transactions, 
etc. Where the rdf_edit approach creates a single layer on top of rdf_db 
and code using the RDF database must select whether to use rdf_db.pl or 
rdf_edit.pl, the new approach allows to register <em>monitors</em>. This 
allows multiple modules to provide additional services, while these 
services will be used regardless of how the database is modified.

<p>Monitors are used by the persistency library (<a class="sec" href="#sec:4.5">section 
4.5</a>) and the literal indexing library (<a class="sec" href="#sec:4.4">section 
4.4</a>).

<dl class="latex">
<dt class="pubdef"><a name="rdf_monitor/2"><strong>rdf_monitor</strong>(<var>:Goal, 
+Mask</var>)</a></dt>
<dd class="defbody">
<var>Goal</var> is called for modifications of the database. It is 
called with a single argument that describes the modification. Defined 
events are:

<dl class="latex">
<dt><strong>assert</strong>(<var>+S, +P, +O, +DB</var>)</dt>
<dd class="defbody">
A triple has been asserted.
</dd>
<dt><strong>retract</strong>(<var>+S, +P, +O, +DB</var>)</dt>
<dd class="defbody">
A triple has been deleted.
</dd>
<dt><strong>update</strong>(<var>+S, +P, +O, +DB, +Action</var>)</dt>
<dd class="defbody">
A triple has been updated.
</dd>
<dt><strong>new_literal</strong>(<var>+Literal</var>)</dt>
<dd class="defbody">
A new literal has been created. <var>Literal</var> is the argument of
<code>literal(Arg)</code> of the triple's object. This event is 
introduced in version 2.5.0 of this library.
</dd>
<dt><strong>old_literal</strong>(<var>+Literal</var>)</dt>
<dd class="defbody">
The literal <var>Literal</var> is no longer used by any triple.
</dd>
<dt><strong>transaction</strong>(<var>+BeginOrEnd, +Id</var>)</dt>
<dd class="defbody">
Mark begin or end of the <em>commit</em> of a transaction started by
<a name="idx:rdftransaction2:80"></a><a class="pred" href="#rdf_transaction/2">rdf_transaction/2</a>. <var>BeginOrEnd</var> 
is <code>begin(Nesting)</code> or
<code>end(Nesting)</code>. <var>Nesting</var> expresses the nesting 
level of transactions, starting at `0' for a toplevel transaction. <var>Id</var> 
is the second argument of <a name="idx:rdftransaction2:81"></a><a class="pred" href="#rdf_transaction/2">rdf_transaction/2</a>. 
The following transaction Ids are pre-defined by the library:

<dl class="latex">
<dt><strong>parse</strong>(<var>Id</var>)</dt>
<dd class="defbody">
A file is loaded using <a name="idx:rdfload2:82"></a><a class="pred" href="#rdf_load/2">rdf_load/2</a>. <var>Id</var> 
is one of <code>file(Path)</code> or <code>stream(Stream)</code>.
</dd>
<dt><strong>unload</strong>(<var>DB</var>)</dt>
<dd class="defbody">
All triples with source <var>DB</var> are being unloaded using <a name="idx:rdfunload1:83"></a><a class="pred" href="#rdf_unload/1">rdf_unload/1</a>.
</dd>
<dt><strong>reset</strong></dt>
<dd class="defbody">
Issued by <a name="idx:rdfresetdb0:84"></a><a class="pred" href="#rdf_reset_db/0">rdf_reset_db/0</a>.
</dd>
</dl>

</dd>
<dt><strong>load</strong>(<var>+BeginOrEnd, +Spec</var>)</dt>
<dd class="defbody">
Mark begin or end of <a name="idx:rdfloaddb1:85"></a><a class="pred" href="#rdf_load_db/1">rdf_load_db/1</a> 
or load through <a name="idx:rdfload2:86"></a><a class="pred" href="#rdf_load/2">rdf_load/2</a> 
from a cached file. <var>Spec</var> is currently defined as <code>file(Path)</code>.
</dd>
<dt><strong>rehash</strong>(<var>+BeginOrEnd</var>)</dt>
<dd class="defbody">
Marks begin/end of a re-hash due to required re-indexing or garbage 
collection.
</dd>
</dl>

<p><var>Mask</var> is a list of events this monitor is interested in. 
Default (empty list) is to report all events. Otherwise each element is 
of the form +Event or -Event to include or exclude monitoring for 
certain events. The event-names are the functor names of the events 
described above. The special name <code>all</code> refers to all events 
and
<code>assert(load)</code> to assert events originating from <a name="idx:rdfloaddb1:87"></a><a class="pred" href="#rdf_load_db/1">rdf_load_db/1</a>. 
As loading triples using <a name="idx:rdfloaddb1:88"></a><a class="pred" href="#rdf_load_db/1">rdf_load_db/1</a> 
is very fast, monitoring this at the triple level may seriously harm 
performance.

<p>This predicate is intended to maintain derived data, such as a 
journal, information for <em>undo</em>, additional indexing in literals, 
etc. There is no way to remove registered monitors. If this is required 
one should register a monitor that maintains a dynamic list of 
subscribers like the XPCE broadcast library. A second subscription of 
the same hook predicate only re-assignes the mask.

<p>The monitor hooks are called in the order of registration and in the 
same thread that issued the database manipulation. To process all 
changes in one thread they should be send to a thread message queue. For 
all updating events, the monitor is called while the calling thread has 
a write lock on the RDF store. This implies that these events are 
processed strickly synchronous, even if modifications originate from 
multiple threads. In particular, the <code>transaction</code> <em>begin</em>, 
... <em>updates</em> ... <em>end</em> sequence is never interleaved with 
other events. Same for <code>load</code> and <code>parse</code>.
</dd>
</dl>

<h3><a name="sec:3.7"><span class="sec-nr">3.7</span> <span class="sec-title">Miscellaneous 
predicates</span></a></h3>

<p>This section describes the remaining predicates of the <code>rdf_db</code> 
module.

<dl class="latex">
<dt class="pubdef"><a name="rdf_node/1"><strong>rdf_node</strong>(<var>-Id</var>)</a></dt>
<dd class="defbody">
Generate a unique reference. The returned atom is guaranteed not to 
occur in the current database in any field of any triple.</dd>
<dt class="pubdef"><a name="rdf_bnode/1"><strong>rdf_bnode</strong>(<var>-Id</var>)</a></dt>
<dd class="defbody">
Generate a unique blank node reference. The returned atom is guaranteed 
not to occur in the current database in any field of any triple and 
starts with '__bnode'.</dd>
<dt class="pubdef"><a name="rdf_is_bnode/1"><strong>rdf_is_bnode</strong>(<var>+Id</var>)</a></dt>
<dd class="defbody">
Succeeds if <var>Id</var> is a blank node identifier (also called
<em>anonymous resource</em>). In the current implementation this implies 
it is an atom starting with a double underscore.</dd>
<dt class="pubdef"><a name="rdf_is_resource/1"><strong>rdf_is_resource</strong>(<var>+Id</var>)</a></dt>
<dd class="defbody">
Succeeds if <var>Id</var> is a resource. Note that this resource need 
not to appear in any triple.</dd>
<dt class="pubdef"><a name="rdf_is_literal/1"><strong>rdf_is_literal</strong>(<var>+Id</var>)</a></dt>
<dd class="defbody">
Succeeds if <var>Id</var> is an RDF literal term. Note that this literal 
need not to appear in any triple.</dd>
<dt class="pubdef"><a name="rdf_source_location/2"><strong>rdf_source_location</strong>(<var>+Subject, 
-SourceRef</var>)</a></dt>
<dd class="defbody">
Return the source-location as <var>File</var>:<var>Line</var> of the 
first triple that is about <var>Subject</var>.</dd>
<dt class="pubdef"><a name="rdf_generation/1"><strong>rdf_generation</strong>(<var>-Generation</var>)</a></dt>
<dd class="defbody">
Returns the <var>Generation</var> of the database. Each modification to 
the database increments the generation. It can be used to check the 
validity of cached results deduced from the database. Modifications 
changing multiple triples increment <var>Generation</var> with the 
number of triples modified, providing a heuristic for `how dirty' cached 
results may be.</dd>
<dt class="pubdef"><a name="rdf_estimate_complexity/4"><strong>rdf_estimate_complexity</strong>(<var>?Subject, 
?Predicate, ?Object, -Complexity</var>)</a></dt>
<dd class="defbody">
Return the number of alternatives as indicated by the database internal 
hashed indexing. This is a rough measure for the number of alternatives 
we can expect for an <a name="idx:rdfhas3:89"></a><a class="pred" href="#rdf_has/3">rdf_has/3</a> 
call using the given three arguments. When called with three variables, 
the total number of triples is returned. This estimate is used in query 
optimisation. See also <a name="idx:rdfpredicateproperty2:90"></a><a class="pred" href="#rdf_predicate_property/2">rdf_predicate_property/2</a> 
and <a name="idx:rdfstatistics1:91"></a><a class="pred" href="#rdf_statistics/1">rdf_statistics/1</a> 
for additional information to help optimisers.</dd>
<dt class="pubdef"><a name="rdf_statistics/1"><strong>rdf_statistics</strong>(<var>?Statistics</var>)</a></dt>
<dd class="defbody">
Report statistics collected by the <code>rdf_db</code> module. Defined 
values for <var>Statistics</var> are:

<dl class="latex">
<dt><strong>lookup</strong>(<var>?Index, -Count</var>)</dt>
<dd class="defbody">
Number of lookups using a pattern of instantiated fields. <var>Index</var> 
is a term <code>rdf(S,P,O)</code>, where <var>S</var>, <var>P</var> and <var>O</var> 
are either <code><code>+</code></code> or <code><code>-</code></code>. 
For example <code>rdf(+,+,-)</code> returns the lookups with subject and 
predicate specified and object unbound.</dd>
<dt><strong>properties</strong>(<var>-Count</var>)</dt>
<dd class="defbody">
Number of unique values for the second field of the triple set.</dd>
<dt><strong>sources</strong>(<var>-Count</var>)</dt>
<dd class="defbody">
Number of files loaded through <a name="idx:rdfload1:92"></a><a class="pred" href="#rdf_load/1">rdf_load/1</a>.</dd>
<dt><strong>subjects</strong>(<var>-Count</var>)</dt>
<dd class="defbody">
Number of unique values for the first field of the triple set.</dd>
<dt><strong>literals</strong>(<var>-Count</var>)</dt>
<dd class="defbody">
Total number of unique literal values in the database. See also
<a class="sec" href="#sec:3.1.1">section 3.1.1</a>.</dd>
<dt><strong>triples</strong>(<var>-Count</var>)</dt>
<dd class="defbody">
Total number of triples in the database.</dd>
<dt><strong>triples_by_file</strong>(<var>?File, -Count</var>)</dt>
<dd class="defbody">
Enumerate the number of triples associated to each file.</dd>
<dt><strong>searched_nodes</strong>(<var>-Count</var>)</dt>
<dd class="defbody">
Number of nodes explored in <a name="idx:rdfreachable3:93"></a><a class="pred" href="#rdf_reachable/3">rdf_reachable/3</a>.</dd>
<dt><strong>gc</strong>(<var>-Count, -Time</var>)</dt>
<dd class="defbody">
Number of garbage collections and time spent in seconds represented as a 
float.</dd>
<dt><strong>rehash</strong>(<var>-Count, -Time</var>)</dt>
<dd class="defbody">
Number of times the hash-tables were enlarged and time spent in seconds 
represented as a float.</dd>
<dt><strong>core</strong>(<var>-Bytes</var>)</dt>
<dd class="defbody">
Core used by the triple store. This includes all memory allocated on 
behalf of the library, but <em>not</em> the memory allocated in Prolog 
atoms referenced (only) by the triple store.
</dd>
</dl>

</dd>
<dt class="pubdef"><a name="rdf_match_label/3"><strong>rdf_match_label</strong>(<var>+Method, 
+Search, +Atom</var>)</a></dt>
<dd class="defbody">
True if <var>Search</var> matches <var>Atom</var> as defined by <var>Method</var>. 
All matching is performed case-insensitive. Defines methods are:

<dl class="latex">
<dt><strong>exact</strong></dt>
<dd class="defbody">
Perform exact, but case-insensitive match.
</dd>
<dt><strong>substring</strong></dt>
<dd class="defbody">
<var>Search</var> is a sub-string of <var>Text</var>.
</dd>
<dt><strong>word</strong></dt>
<dd class="defbody">
<var>Search</var> appears as a whole-word in <var>Text</var>.
</dd>
<dt><strong>prefix</strong></dt>
<dd class="defbody">
<var>Text</var> start with <var>Search</var>.
</dd>
<dt><strong>like</strong></dt>
<dd class="defbody">
<var>Text</var> matches <var>Search</var>, case insensitively, where the 
`*' character in <var>Search</var> matches zero or more characters.
</dd>
</dl>

</dd>
<dt class="pubdef"><a name="lang_matches/2"><strong>lang_matches</strong>(<var>+Lang, 
+Pattern</var>)</a></dt>
<dd class="defbody">
True if <var>Lang</var> matches <var>Pattern</var>. This implements XML 
language matching conform RFC 4647. Both <var>Lang</var> and <var>Pattern</var> 
are dash-separated strings of identifiers or (for <var>Pattern</var>) 
the wildcart <tt><code>*</code></tt>. Identifiers are matched 
case-insensitive and a
<tt><code>*</code></tt> matches any number of identifiers. A short 
pattern is the same as <tt><code>*</code></tt>.</dd>
<dt class="pubdef"><a name="lang_equal/2"><strong>lang_equal</strong>(<var>+Lang1, 
+Lang2</var>)</a></dt>
<dd class="defbody">
True if <var>Lang1</var> and <var>Lang2</var> specify the same language, 
including regional and other modifiers. Language-specifiers are 
case-insensitive.</dd>
<dt class="pubdef"><a name="rdf_reset_db/0"><strong>rdf_reset_db</strong></a></dt>
<dd class="defbody">
Erase all triples from the database and reset all counts and statistics 
information.</dd>
<dt class="pubdef"><a name="rdf_version/1"><strong>rdf_version</strong>(<var>-Version</var>)</a></dt>
<dd class="defbody">
Unify <var>Version</var> with the library version number. This number 
is, like to the SWI-Prolog version flag, defined as <var>10,000 &times; 
Major + 100 &times; Minor + Patch</var>.
</dd>
</dl>

<h3><a name="sec:3.8"><span class="sec-nr">3.8</span> <span class="sec-title">Issues 
with rdf_db</span></a></h3>

<a name="sec:rdfissues"></a>

<p>This RDF low-level module has been created after two year 
experimenting with a plain Prolog based module and a brief evaluation of 
a second generation pure Prolog implementation. The aim was to be able 
to handle upto about 5 million triples on standard (notebook) hardware 
and deal efficiently with <code>subPropertyOf</code> which was 
identified as a crucial feature of RDFS to realise fusion of different 
data-sets.

<p>The following issues are identified and not solved in suitable 
manner.

<dl class="latex">
<dt><b><code>subPropertyOf</code> of <code>subPropertyOf</code></b></dt>
<dd>
is not supported.</dd>
<dt><b>Equivalence</b></dt>
<dd>
Similar to <code>subPropertyOf</code>, it is likely to be profitable to 
handle resource identity efficient. The current system has no support 
for it.
</dd>
</dl>

<h2><a name="sec:4"><span class="sec-nr">4</span> <span class="sec-title">Plugin 
modules for rdf_db</span></a></h2>

<a name="sec:plugin"></a>

<p>The <code>library(rdf_db)</code> module provides several hooks for 
extending its functionality. Database updates can be monitored and acted 
upon through the features described in <a class="sec" href="#sec:3.6">section 
3.6</a>. The predicate <a name="idx:rdfload2:94"></a><a class="pred" href="#rdf_load/2">rdf_load/2</a> 
can be hooked to deal with different formats such as <em>rdfturtle</em>, 
different input sources (e.g. http) and different strategies for caching 
results.

<h3><a name="sec:4.1"><span class="sec-nr">4.1</span> <span class="sec-title">Hooks 
into the RDF library</span></a></h3>

<a name="sec:hooks"></a>

<p>The hooks below are used to add new RDF file formats and sources from 
which to load data to the library. They are used by the modules 
described below and distributed with the package. Please examine the 
source-code if you want to add new formats or locations.

<dl class="latex">
<dt><b><code>rdf_turtle.pl</code></b></dt>
<dd>
Load files in the Turtle format. See <a class="sec" href="#sec:5">section 
5</a>.
</dd>
<dt><b><code>rdf_zlib_plugin.pl</code></b></dt>
<dd>
Load <b>gzip</b> compressed files transparently. See <a class="sec" href="#sec:4.2">section 
4.2</a>.
</dd>
<dt><b><code>rdf_http_plugin.pl</code></b></dt>
<dd>
Load RDF documents from HTTP servers. See <a class="sec" href="#sec:4.3">section 
4.3</a>.
</dd>
</dl>

<dl class="latex">
<dt class="pubdef"><a name="rdf_db:rdf_open_hook/3"><strong>rdf_db:rdf_open_hook</strong>(<var>+Input, 
-Stream, -Format</var>)</a></dt>
<dd class="defbody">
Open an input. <var>Input</var> is one of <code>file(+Name)</code>,
<code>stream(+Stream)</code> or <code>url(Protocol, URL)</code>. If this 
hook succeeds, the RDF will be read from Stream using <a name="idx:rdfloadstream3:95"></a><span class="pred-ext">rdf_load_stream/3</span>. 
Otherwise the default open functionality for file and stream are used.</dd>
<dt class="pubdef"><a name="rdf_db:rdf_load_stream/3"><strong>rdf_db:rdf_load_stream</strong>(<var>+Format, 
+Stream, +Options</var>)</a></dt>
<dd class="defbody">
Actually load the RDF from <var>Stream</var> into the RDF database.
<var>Format</var> describes the format and is produced either by
<a name="idx:rdfinputinfo3:96"></a><span class="pred-ext">rdf_input_info/3</span> 
or <a name="idx:rdffiletype2:97"></a><span class="pred-ext">rdf_file_type/2</span>.</dd>
<dt class="pubdef"><a name="rdf_db:rdf_input_info/3"><strong>rdf_db:rdf_input_info</strong>(<var>+Input, 
-Modified, -Format</var>)</a></dt>
<dd class="defbody">
Gather information on <var>Input</var>. <var>Modified</var> is the last 
modification time of the source as a POSIX time-stamp (see <a name="idx:timefile2:98"></a><span class="pred-ext">time_file/2</span>).
<var>Format</var> is the RDF format of the file. See <a name="idx:rdffiletype2:99"></a><span class="pred-ext">rdf_file_type/2</span> 
for details. It is allowed to leave the output variables unbound. 
Ultimately the default modified time is `0' and the format is assumed to 
be
<code>xml</code>.</dd>
<dt class="pubdef"><a name="rdf_db:rdf_file_type/2"><strong>rdf_db:rdf_file_type</strong>(<var>?Extension, 
?Format</var>)</a></dt>
<dd class="defbody">
True if <var>Format</var> is the default RDF file format for files with 
the given extension. <var>Extension</var> is lowercase and without a 
'.'. E.g. <code>owl</code>. <var>Format</var> is either a built-in 
format (<code>xml</code> or <code>triples</code>) or a format understood 
by the <a name="idx:rdfloadstream3:100"></a><span class="pred-ext">rdf_load_stream/3</span> 
hook.</dd>
<dt class="pubdef"><a name="rdf_db:url_protocol/1"><strong>rdf_db:url_protocol</strong>(<var>?Protocol</var>)</a></dt>
<dd class="defbody">
True if <var>Protocol</var> is a URL protocol recognised by <a name="idx:rdfload2:101"></a><a class="pred" href="#rdf_load/2">rdf_load/2</a>.
</dd>
</dl>

<h3><a name="sec:4.2"><span class="sec-nr">4.2</span> <span class="sec-title">library(semweb/rdf_zlib_plugin): 
Reading compressed RDF</span></a></h3>

<a name="sec:zlib"></a>

<p><a name="idx:gzformat:102"></a><a name="idx:gzip:103"></a><a name="idx:compresseddata:104"></a>This 
module uses the <code>library(zlib)</code> library to load compressed 
files on the fly. The extension of the file must be <code>.gz</code>. 
The file format is deduced by the extension after stripping the <code>.gz</code> 
extension. E.g. <code>rdf_load('file.rdf.gz')</code>.

<h3><a name="sec:4.3"><span class="sec-nr">4.3</span> <span class="sec-title">library(semweb/rdf_http_plugin): 
Reading RDF from a HTTP server</span></a></h3>

<a name="sec:http"></a>

<p><a name="idx:xhtml:105"></a>This module allows for <code>rdf_load('http://...')</code>. 
It exploits the library <code>library(http/http_open.pl)</code>. The 
format of the URL is determined from the mime-type returned by the 
server if this is one of
<code>text/rdf+xml</code>, <code>application/x-turtle</code> or
<code>application/turtle</code>. As RDF mime-types are not yet widely 
supported, the plugin uses the extension of the URL if the claimed 
mime-type is not one of the above. In addition, it recognises
<code>text/html</code> and <code>application/xhtml+xml</code>, scanning 
the XML content for embedded RDF.

<h3><a name="sec:4.4"><span class="sec-nr">4.4</span> <span class="sec-title">library(semweb/rdf_litindex): 
Indexing words in literals</span></a></h3>

<a name="sec:rdflitindex"></a>

<p>The library <code>library(semweb/rdf_litindex.pl)</code> exploits the 
primitives of <a class="sec" href="#sec:4.4.1">section 4.4.1</a> and the 
NLP package to provide indexing on words inside literal constants. It 
also allows for fuzzy matching using stemming and `sounds-like' based on 
the <em>double metaphone</em> algorithm of the NLP package.

<dl class="latex">
<dt class="pubdef"><a name="rdf_find_literals/2"><strong>rdf_find_literals</strong>(<var>+Spec, 
-ListOfLiterals</var>)</a></dt>
<dd class="defbody">
Find literals (without type or language specification) that satisfy
<var>Spec</var>. The required indices are created as needed and kept 
up-to-date using hooks registered with <a name="idx:rdfmonitor2:106"></a><a class="pred" href="#rdf_monitor/2">rdf_monitor/2</a>. 
Numerical indexing is currently limited to integers in the range <var>&#177;2^30</var> 
(<var>&#177;2^62 on 64-bit platforms</var>). <var>Spec</var> is defined 
as:

<dl class="latex">
<dt><strong>and</strong>(<var>Spec1, Spec2</var>)</dt>
<dd class="defbody">
Intersection of both specifications.</dd>
<dt><strong>or</strong>(<var>Spec1, Spec2</var>)</dt>
<dd class="defbody">
Union of both specifications.</dd>
<dt><strong>not</strong>(<var>Spec</var>)</dt>
<dd class="defbody">
Negation of <var>Spec</var>. After translation of the full specification 
to
<em>Disjunctive Normal Form</em> (DNF), negations are only allowed 
inside a conjunction with at least one positive literal.</dd>
<dt><strong>case</strong>(<var>Word</var>)</dt>
<dd class="defbody">
Matches all literals containing the word <var>Word</var>, doing the 
match case insensitive and after removing diacritics.</dd>
<dt><strong>stem</strong>(<var>Like</var>)</dt>
<dd class="defbody">
Matches all literals containing at least one word that has the same stem 
as <var>Like</var> using the Porter stem algorithm. See NLP package for 
details.</dd>
<dt><strong>sounds</strong>(<var>Like</var>)</dt>
<dd class="defbody">
Matches all literals containing at least one word that `sounds like'
<var>Like</var> using the double metaphone algorithm. See NLP package 
for details.</dd>
<dt><strong>prefix</strong>(<var>Prefix</var>)</dt>
<dd class="defbody">
Matches all literals containing at least one word that starts with 
Prefix, discarding diacritics and case.</dd>
<dt><strong>between</strong>(<var>Low, High</var>)</dt>
<dd class="defbody">
Matches all literals containing an integer token in the range
<var>Low</var>..<var>High</var>, including the boundaries.</dd>
<dt><strong>ge</strong>(<var>Low</var>)</dt>
<dd class="defbody">
Matches all literals containing an integer token with value
<var>Low</var> or higher.</dd>
<dt><strong>le</strong>(<var>High</var>)</dt>
<dd class="defbody">
Matches all literals containing an integer token with value
<var>High</var> or lower.</dd>
<dt><strong>Token</strong></dt>
<dd class="defbody">
Matches all literals containing the given token. See <a name="idx:tokenizeatom2:107"></a><span class="pred-ext">tokenize_atom/2</span> 
of the NLP package for details.
</dd>
</dl>

</dd>
<dt class="pubdef"><a name="rdf_token_expansions/2"><strong>rdf_token_expansions</strong>(<var>+Spec, 
-Expansions</var>)</a></dt>
<dd class="defbody">
Uses the same database as <a name="idx:rdffindliterals2:108"></a><a class="pred" href="#rdf_find_literals/2">rdf_find_literals/2</a> 
to find possible expansions of <var>Spec</var>, i.e. which words `sound 
like', `have prefix', etc. <var>Spec</var> is a compound expression as 
in <a name="idx:rdffindliterals2:109"></a><a class="pred" href="#rdf_find_literals/2">rdf_find_literals/2</a>.
<var>Expansions</var> is unified to a list of terms <code>sounds(Like, 
Words)</code>, <code>stem(Like, Words)</code> or <code>prefix(Prefix, 
Words)</code>. On compound expressions, only combinations that provide 
literals are returned. Below is an example after loading the ULAN<sup class="fn">10<span class="fn-text">Unified 
List of Artist Names from the Getty Foundation.</span></sup> database 
and showing all words that sounds like `rembrandt' and appear together 
in a literal with the word `Rijn'. Finding this result from the 228,710 
literals contained in ULAN requires 0.54 milliseconds (AMD 1600+).

<pre class="code">
?- rdf_token_expansions(and('Rijn', sounds(rembrandt)), L).

L = [sounds(rembrandt, ['Rambrandt', 'Reimbrant', 'Rembradt',
                        'Rembrand', 'Rembrandt', 'Rembrandtsz',
                        'Rembrant', 'Rembrants', 'Rijmbrand'])]
</pre>

<p>Here is another example, illustrating handling of diacritics:
<blockquote>

<pre class="code">
?- rdf_token_expansions(case(cafe), L).

L = [case(cafe, [cafe, caf\'e])]
</pre>

</blockquote>
</dd>
<dt class="pubdef"><a name="rdf_tokenize_literal/2"><strong>rdf_tokenize_literal</strong>(<var>+Literal, 
-Tokens</var>)</a></dt>
<dd class="defbody">
Tokenize a literal, returning a list of atoms and integers in the range
<var>-1073741824 ... 1073741823</var>. As tokenization is in general 
domain and task-dependent this predicate first calls the hook
<code>rdf_litindex:tokenization(Literal, -Tokens)</code>. On failure it 
calls <a name="idx:tokenizeatom2:110"></a><span class="pred-ext">tokenize_atom/2</span> 
from the NLP package and deletes the following: atoms of length 1, 
floats, integers that are out of range and the english words <code>and</code>, <code>an</code>, <code>or</code>, <code>of</code>,
<code>on</code>, <code>in</code>, <code>this</code> and <code>the</code>. 
Deletion first calls the hook <code>rdf_litindex:exclude_from_index(token, 
X)</code>. This hook is called as follows:

<pre class="code">
no_index_token(X) :-
        exclude_from_index(token, X), !.
no_index_token(X) :-
        ...
</pre>

<p></dd>
</dl>

<h4><a name="sec:4.4.1"><span class="sec-nr">4.4.1</span> <span class="sec-title">Literal 
maps: Creating additional indices on literals</span></a></h4>

<a name="sec:rdflitmap"></a>

<p>`Literal maps' provide a relation between literal values, intended to 
create additional indexes on literals. The current implementation can 
only deal with integers and atoms (string literals). A literal map 
maintains an ordered set of <em>keys</em>. The ordering uses the same 
rules as described in <a class="sec" href="#sec:3.1.1">section 3.1.1</a>. 
Each key is associated with an ordered set of <em>values</em>. Literal 
map objects can be shared between threads, using a locking strategy that 
allows for multiple concurrent readers.

<p>Typically, this module is used together with <a name="idx:rdfmonitor2:111"></a><a class="pred" href="#rdf_monitor/2">rdf_monitor/2</a> 
on the channals <code>new_literal</code> and <code>old_literal</code> to 
maintain an index of words that appear in a literal. Further abstraction 
using Porter stemming or Metaphone can be used to create additional 
search indices. These can map either directly to the literal values, or 
indirectly to the plain word-map. The SWI-Prolog NLP package provides 
complimentary building blocks, such as a tokenizer, Porter stem and 
Double Metaphone.

<dl class="latex">
<dt class="pubdef"><a name="rdf_new_literal_map/1"><strong>rdf_new_literal_map</strong>(<var>-Map</var>)</a></dt>
<dd class="defbody">
Create a new literal map, returning an opaque handle.</dd>
<dt class="pubdef"><a name="rdf_destroy_literal_map/1"><strong>rdf_destroy_literal_map</strong>(<var>+Map</var>)</a></dt>
<dd class="defbody">
Destroy a literal map. After this call, further use of the <var>Map</var> 
handle is illegal. Additional synchronisation is needed if maps that are 
shared between threads are destroyed to guarantee the handle is no 
longer used. In some scenarios <a name="idx:rdfresetliteralmap1:112"></a><a class="pred" href="#rdf_reset_literal_map/1">rdf_reset_literal_map/1</a> 
provides a safe alternative.</dd>
<dt class="pubdef"><a name="rdf_reset_literal_map/1"><strong>rdf_reset_literal_map</strong>(<var>+Map</var>)</a></dt>
<dd class="defbody">
Delete all content from the literal map.</dd>
<dt class="pubdef"><a name="rdf_insert_literal_map/3"><strong>rdf_insert_literal_map</strong>(<var>+Map, 
+Key, +Value</var>)</a></dt>
<dd class="defbody">
Add a relation between <var>Key</var> and <var>Value</var> to the map. 
If this relation already exists no action is performed.</dd>
<dt class="pubdef"><a name="rdf_insert_literal_map/4"><strong>rdf_insert_literal_map</strong>(<var>+Map, 
+Key, +Value, -KeyCount</var>)</a></dt>
<dd class="defbody">
As <a name="idx:rdfinsertliteralmap3:113"></a><a class="pred" href="#rdf_insert_literal_map/3">rdf_insert_literal_map/3</a>. 
In addition, if <var>Key</var> is a new key in
<var>Map</var>, unify <var>KeyCount</var> with the number of keys in <var>Map</var>. 
This serves two purposes. Derived maps, such as the stem and metaphone 
maps need to know about new keys and it avoids additional foreign calls 
for doing the progress in <code>rdf_litindex.pl</code>.</dd>
<dt class="pubdef"><a name="rdf_delete_literal_map/2"><strong>rdf_delete_literal_map</strong>(<var>+Map, 
+Key</var>)</a></dt>
<dd class="defbody">
Delete <var>Key</var> and all associated values from the map. Succeeds 
always.</dd>
<dt class="pubdef"><a name="rdf_delete_literal_map/2"><strong>rdf_delete_literal_map</strong>(<var>+Map, 
+Key, +Value</var>)</a></dt>
<dd class="defbody">
Delete the association between <var>Key</var> and <var>Value</var> from 
the map. Succeeds always.</dd>
<dt class="pubdef"><span class="pred-tag">[det]</span><a name="rdf_find_literal_map/3"><strong>rdf_find_literal_map</strong>(<var>+Map, 
+KeyList, -ValueList</var>)</a></dt>
<dd class="defbody">
Unify <var>ValueList</var> with an ordered set of values associated to 
all keys from <var>KeyList</var>. Each key in <var>KeyList</var> is 
either an atom, an integer or a term <code>not(Key)</code>. If not-terms 
are provided, there must be at least one positive keywords. The 
negations are tested after establishing the positive matches.</dd>
<dt class="pubdef"><a name="rdf_keys_in_literal_map/3"><strong>rdf_keys_in_literal_map</strong>(<var>+Map, 
+Spec, -Answer</var>)</a></dt>
<dd class="defbody">
Realises various queries on the key-set:

<dl class="latex">
<dt><strong>all</strong></dt>
<dd class="defbody">
Unify <var>Answer</var> with an ordered list of all keys.</dd>
<dt><strong>key</strong>(<var>+Key</var>)</dt>
<dd class="defbody">
Succeeds if <var>Key</var> is a key in the map and unify <var>Answer</var> 
with the number of values associated with the key. This provides a fast 
test of existence without fetching the possibly large associated value 
set as with <a name="idx:rdffindliteralmap3:114"></a><a class="pred" href="#rdf_find_literal_map/3">rdf_find_literal_map/3</a>.</dd>
<dt><strong>prefix</strong>(<var>+Prefix</var>)</dt>
<dd class="defbody">
Unify <var>Answer</var> with an ordered set of all keys that have the 
given prefix. See <a class="sec" href="#sec:3.1">section 3.1</a> for 
details on prefix matching.
<var>Prefix</var> must be an atom. This call is intended for 
auto-completion in user interfaces.</dd>
<dt><strong>ge</strong>(<var>+Min</var>)</dt>
<dd class="defbody">
Unify <var>Answer</var> with all keys that are larger or equal to the 
integer <var>Min</var>.</dd>
<dt><strong>le</strong>(<var>+Max</var>)</dt>
<dd class="defbody">
Unify <var>Answer</var> with all keys that are smaller or equal to the 
integer <var>Max</var>.</dd>
<dt><strong>between</strong>(<var>+Min, +Max</var>)</dt>
<dd class="defbody">
Unify <var>Answer</var> with all keys between <var>Min</var> and <var>Max</var> 
(including).
</dd>
</dl>

</dd>
<dt class="pubdef"><a name="rdf_statistics_literal_map/2"><strong>rdf_statistics_literal_map</strong>(<var>+Map, 
+Key(-Arg...)</var>)</a></dt>
<dd class="defbody">
Query some statistics of the map. Provides keys are:

<dl class="latex">
<dt><strong>size</strong>(<var>-Keys, -Relations</var>)</dt>
<dd class="defbody">
Unify <var>Keys</var> with the total key-count of the index and
<var>Relation</var> with the total <var>Key</var>-<var>Value</var> 
count.
</dd>
</dl>

</dd>
</dl>

<h3><a name="sec:4.5"><span class="sec-nr">4.5</span> <span class="sec-title">library(semweb/rdf_persistency): 
Providing persistent storage</span></a></h3>

<a name="sec:persistency"></a>

<p><a name="idx:Persistentstore:115"></a>The <code>library(semweb/rdf_persistency)</code> 
provides reliable persistent storage for the RDF data. The store uses a 
directory with files for each source (see <a name="idx:rdfsource1:116"></a><a class="pred" href="#rdf_source/1">rdf_source/1</a>) 
present in the database. Each source is represented by two files, one in 
binary format (see <a name="idx:rdfsavedb2:117"></a><span class="pred-ext">rdf_save_db/2</span>) 
representing the base state and one represented as Prolog terms 
representing the changes made since the base state. The latter is called 
the <em>journal</em>.

<dl class="latex">
<dt class="pubdef"><a name="rdf_attach_db/2"><strong>rdf_attach_db</strong>(<var>+Directory, 
+Options</var>)</a></dt>
<dd class="defbody">
Attach <var>Directory</var> as the persistent database. If <var>Directory</var> 
does not exist it is created. Otherwise all sources defined in the 
directory are loaded into the RDF database. Loading a source means 
loading the base state (if any) and replaying the journal (if any). The 
current implementation does not synchronise triples that are in the 
store before attaching a database. They are not removed from the 
database, nor added to the presistent store. Different merging options 
may be supported through the <var>Options</var> argument later. 
Currently defined options are:

<dl class="latex">
<dt><strong>concurrency</strong>(<var>+PosInt</var>)</dt>
<dd class="defbody">
Number of threads used to reload databased and journals from the files 
in <var>Directory</var>. Default is the number of physical CPUs 
determined by the Prolog flag <code>cpu_count</code> or 1 (one) on 
systems where this number is unknown. See also <a name="idx:concurrent3:118"></a><span class="pred-ext">concurrent/3</span>.</dd>
<dt><strong>max_open_journals</strong>(<var>+PosInt</var>)</dt>
<dd class="defbody">
The library maintains a pool of open journal files. This option 
specifies the size of this pool. The default is 10. Raising the option 
can make sense if many writes occur on many different named graphs. The 
value can be lowered for scenarios where write operations are very 
infrequent.</dd>
<dt><strong>silent</strong>(<var>Boolean</var>)</dt>
<dd class="defbody">
If <code>true</code>, supress loading messages from <a name="idx:rdfattachdb2:119"></a><a class="pred" href="#rdf_attach_db/2">rdf_attach_db/2</a>.</dd>
<dt><strong>log_nested_transactions</strong>(<var>Boolean</var>)</dt>
<dd class="defbody">
If <code>true</code>, nested <em>log</em> transactions are added to the 
journal information. By default (<code>false</code>), no log-term is 
added for nested transactions.
</dd>
</dl>

<p>The database is locked against concurrent access using a file
<code>lock</code> in <var>Directory</var>. An attempt to attach to a 
locked database raises a <code>permission_error</code> exception. The 
error context contains a term <code>rdf_locked(Args)</code>, where args 
is a list containing <code>time(Stamp)</code> and <code>pid(PID)</code>. 
The error can be caught by the application. Otherwise it prints:

<pre class="code">
ERROR: No permission to lock rdf_db `/home/jan/src/pl/packages/semweb/DB'
ERROR: locked at Wed Jun 27 15:37:35 2007 by process id 1748
</pre>

</dd>
<dt class="pubdef"><a name="rdf_detach_db/0"><strong>rdf_detach_db</strong></a></dt>
<dd class="defbody">
Detaches the persistent store. No triples are removed from the RDF 
triple store.</dd>
<dt class="pubdef"><a name="rdf_current_db/1"><strong>rdf_current_db</strong>(<var>-Directory</var>)</a></dt>
<dd class="defbody">
Unify <var>Directory</var> with the current database directory. Fails if 
no persistent database is attached.</dd>
<dt class="pubdef"><a name="rdf_persistency/2"><strong>rdf_persistency</strong>(<var>+DB, 
+Bool</var>)</a></dt>
<dd class="defbody">
Change presistency of named database (4th argument of <a name="idx:rdf4:120"></a><a class="pred" href="#rdf/4">rdf/4</a>). 
By default all databases are presistent. Using <code>false</code>, the 
journal and snapshot for the database are deleted and further changes to 
triples associated with <var>DB</var> are not recorded. If <var>Bool</var> 
is <code>true</code> a snapshot is created for the current state and 
further modifications are monitored. Switching persistency does not 
affect the triples in the in-memory RDF database.</dd>
<dt class="pubdef"><a name="rdf_flush_journals/1"><strong>rdf_flush_journals</strong>(<var>+Options</var>)</a></dt>
<dd class="defbody">
Flush dirty journals. With the option <code>min_size(KB)</code> only 
journals larger than <var>KB</var> Kbytes are merged with the base 
state. Flushing a journal takes the following steps, ensuring a stable 
state can be recovered at any moment.
<ol class="latex">
<li>Save the current database in a new file using the extension <code>.new</code>.
<li>On success, delete the journal
<li>On success, atomically move the <code>.new</code> file over the base 
state.
</ol>

<p>Note that journals are <em>not</em> merged automatically for two 
reasons. First of all, some applications may decide never to merge as 
the journal contains a complete <em>changelog</em> of the database. 
Second, merging large databases can be slow and the application may wish 
to schedule such actions at quiet times or scheduled maintenance 
periods.
</dd>
</dl>

<h4><a name="sec:4.5.1"><span class="sec-nr">4.5.1</span> <span class="sec-title">Enriching 
the journals</span></a></h4>

<a name="sec:enrich"></a>

<p>The above predicates suffice for most applications. The predicates in 
this section provide access to the journal files and the base state 
files and are intented to provide additional services, such as reasoning 
about the journals, loaded files, etc.<sup class="fn">11<span class="fn-text">A 
library <code>library(rdf_history)</code> is under development 
exploiting these features supporting wiki style editing of RDF.</span></sup>

<p>Using <code>rdf_transaction(Goal, log(Message))</code>, we can add 
additional records to enrich the journal of affected databases with <var>Term</var> 
and some additional bookkeeping information. Such a transaction adds a 
term
<code>begin(Id, Nest, Time, Message)</code> before the change operations 
on each affected database and <code>end(Id, Nest, Affected)</code> after 
the change operations. Here is an example call and content of the 
journal file <code>mydb.jrn</code>. A full explanation of the terms that 
appear in the journal is in the description of <a name="idx:rdfjournalfile2:121"></a><a class="pred" href="#rdf_journal_file/2">rdf_journal_file/2</a>.

<pre class="code">
?- rdf_transaction(rdf_assert(s,p,o,mydb), log(by(jan))).
</pre>

<pre class="code">
start([time(1183540570)]).
begin(1, 0, 1183540570.36, by(jan)).
assert(s, p, o).
end(1, 0, []).
end([time(1183540578)]).
</pre>

<p>Using <code>rdf_transaction(Goal, log(Message, DB))</code>, where <var>DB</var> 
is an atom denoting a (possibly empty) named graph, the system 
guarantees that a non-empty transaction will leave a possibly empty 
transaction record in DB. This feature assumes named graphs are named 
after the user making the changes. If a user action does not affect the 
user's graph, such as deleting a triple from another graph, we still 
find record of all actions performed by some user in the journal of that 
user.

<dl class="latex">
<dt class="pubdef"><a name="rdf_journal_file/2"><strong>rdf_journal_file</strong>(<var>?DB, 
?JournalFile</var>)</a></dt>
<dd class="defbody">
True if
<var>File</var> is the absolute file name of an existing named graph
<var>DB</var>. A journal file contains a sequence of Prolog terms of the 
following format.<sup class="fn">12<span class="fn-text">Future versions 
of this library may use an XML based language neutral format.</span></sup>

<dl class="latex">
<dt><strong>start</strong>(<var>Attributes</var>)</dt>
<dd class="defbody">
Journal has been opened. Currently <var>Attributes</var> contains a term <code>time(Stamp)</code>.</dd>
<dt><strong>end</strong>(<var>Attributes</var>)</dt>
<dd class="defbody">
Journal was closed. Currently <var>Attributes</var> contains a term <code>time(Stamp)</code>.</dd>
<dt><strong>assert</strong>(<var>Subject, Predicate, Object</var>)</dt>
<dd class="defbody">
A triple {Subject, Predicate, Object} was added to the database.</dd>
<dt><strong>assert</strong>(<var>Subject, Predicate, Object, Line</var>)</dt>
<dd class="defbody">
A triple {Subject, Predicate, Object} was added to the database with 
given <var>Line</var> context.</dd>
<dt><strong>retract</strong>(<var>Subject, Predicate, Object</var>)</dt>
<dd class="defbody">
A triple {Subject, Predicate, Object} was deleted from the database. 
Note that an <a name="idx:rdfretractall3:122"></a><a class="pred" href="#rdf_retractall/3">rdf_retractall/3</a> 
call can retract multiple triples. Each of them have a record in the 
journal. This allows for `undo'.</dd>
<dt><strong>retract</strong>(<var>Subject, Predicate, Object, Line</var>)</dt>
<dd class="defbody">
Same as above, for a triple with associated line info.</dd>
<dt><strong>update</strong>(<var>Subject, Predicate, Object, Action</var>)</dt>
<dd class="defbody">
See <a name="idx:rdfupdate4:123"></a><a class="pred" href="#rdf_update/4">rdf_update/4</a>.</dd>
<dt><strong>begin</strong>(<var>Id, Nest, Time, Message</var>)</dt>
<dd class="defbody">
Added before the changes in each database affected by a transaction with 
transaction identifier <code>log(Message)</code>. <var>Id</var> is an 
integer counting the logged transactions to this database. Numbers are 
increasing and designed for binary search within the journal file.
<var>Nest</var> is the nesting level, where `0' is a toplevel 
transaction.
<var>Time</var> is a time-stamp, currently using float notation with two 
fractional digits. <var>Message</var> is the term provided by the user 
as argument of the <code>log(Message)</code> transaction.</dd>
<dt><strong>end</strong>(<var>Id, Nest, Others</var>)</dt>
<dd class="defbody">
Added after the changes in each database affected by a transaction with 
transaction identifier <code>log(Message)</code>. <var>Id</var> and <var>Nest</var> 
match the begin-term. <var>Others</var> gives a list of other databases 
affected by this transaction and the <var>Id</var> of these records. The 
terms in this list have the format <var>DB</var>:<var>Id</var>.
</dd>
</dl>

</dd>
<dt class="pubdef"><a name="rdf_db_to_file/2"><strong>rdf_db_to_file</strong>(<var>?DB, 
?FileBase</var>)</a></dt>
<dd class="defbody">
Convert between <var>DB</var> (see <a name="idx:rdfsource1:124"></a><a class="pred" href="#rdf_source/1">rdf_source/1</a>) 
and file base-file used for storing information on this database. The 
full file is located in the directory described by <a name="idx:rdfcurrentdb1:125"></a><a class="pred" href="#rdf_current_db/1">rdf_current_db/1</a> 
and has the extension
<code>.trp</code> for the base state and <code>.jrn</code> for the 
journal.
</dd>
</dl>

<h2><a name="sec:5"><span class="sec-nr">5</span> <span class="sec-title">library(semweb/rdf_turtle): 
Turtle: Terse RDF Triple Language</span></a></h2>

<p><a name="sec:rdfturtle"></a>

<dl class="tags">
<dt class="tag">To be done</dt>
<dd>
Better error handling
</dd>
</dl>

<p>This module implements the Turtle language for representing the RDF 
triple model as defined by Dave Beckett from the Institute for Learning 
and Research Technology University of Bristol in the document:

<p>
<ul class="latex">
<li><a class="url" href="http://www.w3.org/TeamSubmission/turtle/">http://www.w3.org/TeamSubmission/turtle/</a>
<li><a class="url" href="http://www.w3.org/TeamSubmission/2008/SUBM-turtle-20080114/\#sec-conformance">http://www.w3.org/TeamSubmission/2008/SUBM-turtle-20080114/\#sec-conformance</a>
</ul>

<p>This parser passes all tests, except for test-28.ttl (decial number 
serialization) and test-29.ttl (uri containing ...%&amp;...). It is 
unclear to me whether these tests are correct. Notably, it is unclear 
whether we must do %-decoding. Certainly, this is expected by various 
real-life datasets that we came accross with.

<p>This module acts as a plugin to <a class="pred" href="#rdf_load/2">rdf_load/2</a>, 
for processing files with one of the extensions <code>.ttl</code>, <code>.n3</code> 
or <code>.nt</code>.

<dl class="latex">
<dt class="pubdef"><a name="rdf_read_turtle/3"><strong>rdf_read_turtle</strong>(<var>+Input, 
-Triples, +Options</var>)</a></dt>
<dd class="defbody">
Read a stream or file into a set of triples of the format

<p>rdf(Subject, Predicate, Object)

<p>The representation is consistent with the SWI-Prolog RDF/XML and 
ntriples parsers. Provided options are:

<dl class="latex">
<dt><strong>base_uri</strong>(<var>+BaseURI</var>)</dt>
<dd class="defbody">
Initial base URI. Defaults to file://<var>&lt;</var>file<var>&gt;</var> 
for loading files.
</dd>
<dt><strong>anon_prefix</strong>(<var>+Prefix</var>)</dt>
<dd class="defbody">
Blank nodes are generated as <var>&lt;</var>Prefix<var>&gt;</var>1, <var>&lt;</var>Prefix<var>&gt;</var>2, 
etc. If Prefix is not an atom blank nodes are generated as node(1), 
node(2), ...
</dd>
<dt><strong>resources</strong>(<var>URIorIRI</var>)</dt>
<dd class="defbody">
Officially, Turtle resources are IRIs. Quite a few applications however 
send URIs. By default we do URI<code>-&gt;</code>IRI mapping because 
this rarely causes errors. To force strictly conforming mode, pass <code>iri</code>.
</dd>
<dt><strong>prefixes</strong>(<var>-Pairs</var>)</dt>
<dd class="defbody">
Return encountered prefix declarations as a list of Alias-URI
</dd>
<dt><strong>namespaces</strong>(<var>-Pairs</var>)</dt>
<dd class="defbody">
Same as prefixes(Pairs). Compatibility to <a class="pred" href="#rdf_load/2">rdf_load/2</a>.
</dd>
<dt><strong>base_used</strong>(<var>-Base</var>)</dt>
<dd class="defbody">
Base URI used for processing the data. Unified to[]if there is no 
base-uri.
</dd>
<dt><strong>on_error</strong>(<var>+ErrorMode</var>)</dt>
<dd class="defbody">
In <code>warning</code> (default), print the error and continue parsing 
the remainder of the file. If <code>error</code>, abort with an 
exception on the first error encountered.
</dd>
<dt><strong>error_count</strong>(<var>-Count</var>)</dt>
<dd class="defbody">
If on_error(warning) is active, this option cane be used to retrieve the 
number of generated errors.
</dd>
</dl>

<table class="paramlist">
<tr valign="top"><td><var>Input</var> </td><td>is one of stream(Stream), 
atom(Atom), a <code>http</code>,
<code>https</code> or <code>file</code> url or a filename specification 
as accepted by <span class="pred-ext">absolute_file_name/3</span>. </td></tr>
</table>
</dd>
<dt class="pubdef"><a name="rdf_load_turtle/3"><strong>rdf_load_turtle</strong>(<var>+Input, 
-Triples, +Options</var>)</a></dt>
<dd class="defbody">

<dl class="tags">
<dt class="tag">deprecated</dt>
<dd>
Use <a class="pred" href="#rdf_read_turtle/3">rdf_read_turtle/3</a>
</dd>
</dl>

</dd>
<dt class="pubdef"><span class="pred-tag">[det]</span><a name="rdf_process_turtle/3"><strong>rdf_process_turtle</strong>(<var>+Input, 
:OnObject, +Options</var>)</a></dt>
<dd class="defbody">
Process Turtle input from <var>Input</var>, calling <var>OnObject</var> 
with a list of triples. <var>Options</var> is the same as for <a class="pred" href="#rdf_load_turtle/3">rdf_load_turtle/3</a>.

<p>Errors encountered are sent to <span class="pred-ext">print_message/2</span>, 
after which the parser tries to recover and parse the remainder of the 
data.
</dd>
</dl>

<h2><a name="sec:6"><span class="sec-nr">6</span> <span class="sec-title">library(semweb/rdf_turtle_write): 
Turtle - Terse RDF Triple Language writer</span></a></h2>

<p><a name="sec:rdfturtlewrite"></a>

<dl class="tags">
<dt class="tag">To be done</dt>
<dd>
Low-level string output takes 28% of the time. Move to C?
</dd>
</dl>

<p>This module implements the Turtle language for representing the RDF 
triple model as defined by Dave Beckett from the Institute for Learning 
and Research Technology University of Bristol in the document:

<p>
<ul class="latex">
<li><a class="url" href="http://www.w3.org/TeamSubmission/turtle/">http://www.w3.org/TeamSubmission/turtle/</a>
<li><a class="url" href="http://www.w3.org/TeamSubmission/2008/SUBM-turtle-20080114/\#sec-conformance">http://www.w3.org/TeamSubmission/2008/SUBM-turtle-20080114/\#sec-conformance</a>
</ul>

<p>The Turtle format is designed as an RDF serialization that is easy to 
read and write by both machines and humans. Due to the latter property, 
this library goes a long way in trying to produce human-readable output.

<p>In addition to the human-readable format, this library can write a
<i>canonical</i> representation of RDF graphs. The canonical 
representation has the following properties:

<p>
<ul class="latex">
<li>Equivalent graphs result in the same document. Graphs are considered 
equivalent iff they contain the same <i>set</i> of triples, regardless 
of the labeling of blank nodes in the graph.
<li>Changes to the graph are diff-friendly. This means

<p>
<ul class="latex">
<li>Prefixes are combined in the header and thus changes to the 
namespaces only result in changes in the header.
<li>Blank nodes that are used only once (including collections) are 
written in-line with the object they belong to.
<li>For other blank nodes we to realise stable labeling that is based on 
property-values.
</ul>
</ul>

<dl class="latex">
<dt class="pubdef"><span class="pred-tag">[det]</span><a name="rdf_save_turtle/2"><strong>rdf_save_turtle</strong>(<var>+Out, 
:Options</var>)</a></dt>
<dd class="defbody">
Save an RDF graph as Turtle. <var>Options</var> processed are:

<dl class="latex">
<dt><strong>align_prefixes</strong>(<var>+Boolean</var>)</dt>
<dd class="defbody">
Nicely align the @prefix declarations
</dd>
<dt><strong>base</strong>(<var>+Base</var>)</dt>
<dd class="defbody">
Save relative to the given Base
</dd>
<dt><strong>canonize_numbers</strong>(<var>+Boolean</var>)</dt>
<dd class="defbody">
If <code>true</code> (default <code>false</code>), emit numeric 
datatypes using Prolog's write to achieve canonical output.
</dd>
<dt><strong>comment</strong>(<var>+Boolean</var>)</dt>
<dd class="defbody">
It <code>true</code> (default), write some informative comments between 
the output segments
</dd>
<dt><strong>encoding</strong>(<var>+Encoding</var>)</dt>
<dd class="defbody">
Encoding used for the output stream. Default is UTF-8.
</dd>
<dt><strong>expand</strong>(<var>:Goal</var>)</dt>
<dd class="defbody">
Query an alternative graph-representation. See below.
</dd>
<dt><strong>indent</strong>(<var>+Column</var>)</dt>
<dd class="defbody">
Indentation for ; -lists. `0' does not indent, but writes on the same 
line. Default is 8.
</dd>
<dt><strong>graph</strong>(<var>+Graph</var>)</dt>
<dd class="defbody">
Save only the named graph
</dd>
<dt><strong>group</strong>(<var>+Boolean</var>)</dt>
<dd class="defbody">
If <code>true</code> (default), using P-O and O-grouping.
</dd>
<dt><strong>only_known_prefixes</strong>(<var>+Boolean</var>)</dt>
<dd class="defbody">
Only use prefix notation for known prefixes. Without, some documents 
produce <i>huge</i> amounts of prefixes.
</dd>
<dt><strong>silent</strong>(<var>+Boolean</var>)</dt>
<dd class="defbody">
If <code>true</code> (default <code>false</code>), do not print the 
final informational message.
</dd>
<dt><strong>single_line_bnodes</strong>(<var>+Bool</var>)</dt>
<dd class="defbody">
If <code>true</code> (default <code>false</code>), write [...] and (...) 
on a single line.
</dd>
<dt><strong>subject_white_lines</strong>(<var>+Count</var>)</dt>
<dd class="defbody">
Extra white lines to insert between statements about a different 
subject. Default is 1.
</dd>
<dt><strong>tab_distance</strong>(<var>+Tab</var>)</dt>
<dd class="defbody">
Distance between tab-stops. `0' forces the library to use only spaces 
for layout. Default is 8.
</dd>
<dt><strong>user_prefixes</strong>(<var>+Boolean</var>)</dt>
<dd class="defbody">
If <code>true</code> (default), use prefixes from <a class="pred" href="#rdf_current_ns/2">rdf_current_ns/2</a>.
</dd>
</dl>

<p>The option <code>expand</code> allows for serializing alternative 
graph representations. It is called through <span class="pred-ext">call/5</span>, 
where the first argument is the expand-option, followed by S,P,O,G. G is 
the graph-option (which is by default a variable). This notably allows 
for writing RDF graphs represented as rdf(S,P,O) using the following 
code fragment:

<pre class="code">
triple_in(RDF, S,P,O,_G) :-
    member(rdf(S,P,O), RDF).

    ...,
    rdf_save_turtle(Out, [ expand(triple_in(RDF)) ]),
</pre>

<table class="paramlist">
<tr valign="top"><td><var>Out</var> </td><td>is one of stream(Stream), a 
stream handle, a file-URL or an atom that denotes a filename. </td></tr>
</table>
</dd>
<dt class="pubdef"><span class="pred-tag">[det]</span><a name="rdf_save_canonical_turtle/2"><strong>rdf_save_canonical_turtle</strong>(<var>+Spec, 
+Options</var>)</a></dt>
<dd class="defbody">
Save triples in a canonical format. This is the same as
<span class="pred-ext">rdf_save_turtle/3</span>, but using different 
defaults. In particular:

<p>
<ul compact>
<li>encoding(utf8),
<li>indent(0),
<li>tab_distance(0),
<li>subject_white_lines(1),
<li>align_prefixes(false),
<li>user_prefixes(false)
<li>comment(false),
<li>group(false),
<li>single_line_bnodes(true)
</ul>

<dl class="tags">
<dt class="tag">To be done</dt>
<dd>
Work in progress. Notably blank-node handling is incomplete.
</dd>
</dl>

</dd>
</dl>

<h2><a name="sec:7"><span class="sec-nr">7</span> <span class="sec-title">library(semweb/rdfs): 
RDFS related queries</span></a></h2>

<a name="sec:rdfs"></a>

<p><a name="idx:RDFSchema:126"></a>The <code>library(semweb/rdfs)</code> 
library adds interpretation of the triple store in terms of concepts 
from RDF-Schema (RDFS). There are two ways to provide support for more 
high level languages in RDF. One is to view such languages as a set of <em>entailment 
rules</em>. In this model the rdfs library would provide a predicate <span class="pred-ext">rdfs/3</span> 
providing the same functionality as <a name="idx:rdf3:127"></a><a class="pred" href="#rdf/3">rdf/3</a> 
on union of the raw graph and triples that can be derived by applying 
the RDFS entailment rules.

<p>Alternatively, RDFS provides a view on the RDF store in terms of 
individuals, classes, properties, etc., and we can provide predicates 
that query the database with this view in mind. This is the approach 
taken in the <code>library(semweb/rdfs.p)</code>l library, providing 
calls like
<code>rdfs_individual_of(?Resource, ?Class)</code>.<sup class="fn">13<span class="fn-text">The 
SeRQL language is based on querying the deductive closure of the triple 
set. The SWI-Prolog SeRQL library provides <em>entailment modules</em> 
that take the approach outlined above.</span></sup>

<h3><a name="sec:7.1"><span class="sec-nr">7.1</span> <span class="sec-title">Hierarchy 
and class-individual relations</span></a></h3>

<p>The predicates in this section explore the <code>rdfs:subPropertyOf</code>,
<code>rdfs:subClassOf</code> and <code>rdf:type</code> relations. Note 
that the most fundamental of these, <code>rdfs:subPropertyOf</code>, is 
also used by <a name="idx:rdfhas34:128"></a><a class="pred" href="#rdf_has/3">rdf_has/[3,4]</a>.

<dl class="latex">
<dt class="pubdef"><a name="rdfs_subproperty_of/2"><strong>rdfs_subproperty_of</strong>(<var>?SubProperty, 
?Property</var>)</a></dt>
<dd class="defbody">
True if <var>SubProperty</var> is equal to <var>Property</var> or <var>Property</var> 
can be reached from <var>SubProperty</var> following the
<code>rdfs:subPropertyOf</code> relation. It can be used to test as well 
as generate sub-properties or super-properties. Note that the commonly 
used semantics of this predicate is wired into <a name="idx:rdfhas34:129"></a><a class="pred" href="#rdf_has/3">rdf_has/[3,4]</a>.<sup class="fn">bug<span class="fn-text">The 
current implementation cannot deal with cycles</span></sup>.<sup class="fn">bug<span class="fn-text">The 
current implementation cannot deal with predicates that are an <code>rdfs:subPropertyOf</code> 
of <code>rdfs:subPropertyOf</code>, such as <code>owl:samePropertyAs</code>.</span></sup></dd>
<dt class="pubdef"><a name="rdfs_subclass_of/2"><strong>rdfs_subclass_of</strong>(<var>?SubClass, 
?Class</var>)</a></dt>
<dd class="defbody">
True if <var>SubClass</var> is equal to <var>Class</var> or <var>Class</var> 
can be reached from <var>SubClass</var> following the
<code>rdfs:subClassOf</code> relation. It can be used to test as well as 
generate sub-classes or super-classes.<sup class="fn">bug<span class="fn-text">The 
current implementation cannot deal with cycles</span></sup>.</dd>
<dt class="pubdef"><a name="rdfs_class_property/2"><strong>rdfs_class_property</strong>(<var>+Class, 
?Property</var>)</a></dt>
<dd class="defbody">
True if the domain of <var>Property</var> includes <var>Class</var>. 
Used to generate all properties that apply to a class.</dd>
<dt class="pubdef"><a name="rdfs_individual_of/2"><strong>rdfs_individual_of</strong>(<var>?Resource, 
?Class</var>)</a></dt>
<dd class="defbody">
True if <var>Resource</var> is an indivisual of <var>Class</var>. This 
implies
<var>Resource</var> has an <code>rdf:type</code> property that refers to
<var>Class</var> or a sub-class thereof. Can be used to test, generate 
classes <var>Resource</var> belongs to or generate individuals described 
by <var>Class</var>.
</dd>
</dl>

<h3><a name="sec:7.2"><span class="sec-nr">7.2</span> <span class="sec-title">Collections 
and Containers</span></a></h3>

<p><a name="idx:parseTypeCollection:130"></a><a name="idx:CollectionparseType:131"></a>The 
RDF construct <code>rdf:parseType</code>=<code>Collection</code> 
constructs a list using the <code>rdf:first</code> and <code>rdf:next</code> 
relations.

<dl class="latex">
<dt class="pubdef"><a name="rdfs_member/2"><strong>rdfs_member</strong>(<var>?Resource, 
+Set</var>)</a></dt>
<dd class="defbody">
Test or generate the members of <var>Set</var>. <var>Set</var> is either 
an individual of <code>rdf:List</code> or <code>rdf:Container</code>.</dd>
<dt class="pubdef"><a name="rdfs_list_to_prolog_list/2"><strong>rdfs_list_to_prolog_list</strong>(<var>+Set, 
-List</var>)</a></dt>
<dd class="defbody">
Convert <var>Set</var>, which must be an individual of <code>rdf:List</code> 
into a Prolog list of objects.</dd>
<dt class="pubdef"><a name="rdfs_assert_list/2"><strong>rdfs_assert_list</strong>(<var>+List, 
-Resource</var>)</a></dt>
<dd class="defbody">
Equivalent to <a name="idx:rdfsassertlist3:132"></a><a class="pred" href="#rdfs_assert_list/3">rdfs_assert_list/3</a> 
using <var>DB</var> = <code>user</code>.</dd>
<dt class="pubdef"><a name="rdfs_assert_list/3"><strong>rdfs_assert_list</strong>(<var>+List, 
-Resource, +DB</var>)</a></dt>
<dd class="defbody">
If <var>List</var> is a list of resources, create an RDF list <var>Resource</var> 
that reflects these resources. <var>Resource</var> and the sublist 
resources are generated with <a name="idx:rdfbnode1:133"></a><a class="pred" href="#rdf_bnode/1">rdf_bnode/1</a>. 
The new triples are associated with the database <var>DB</var>.
</dd>
</dl>

<h3><a name="sec:7.3"><span class="sec-nr">7.3</span> <span class="sec-title">Labels 
and textual search</span></a></h3>

<p>Textual search is partly handled by the predicates from the
<code>library(rdf_db)</code> module and its underlying C-library. For 
example, literal objects are hashed case-insensitive to speed up the 
commonly used case-insensitive search.

<dl class="latex">
<dt class="pubdef"><span class="pred-tag">[multi]</span><a name="rdfs_label/3"><strong>rdfs_label</strong>(<var>?Resource, 
?Language, ?Label</var>)</a></dt>
<dd class="defbody">
Extract the label from <var>Resource</var> or generate all resources 
with the given <var>Label</var>. The label is either associated using a 
sub-property of <code>rdfs:label</code> or it is extracted from <var>Resource</var> 
by taking the part after the last <code>#</code> or <code><code>/</code></code>. 
If this too fails,
<var>Label</var> is unified with <var>Resource</var>. <var>Language</var> 
is unified to the value of the <code>xml:lang</code> attribute of the 
label or a variable if the label has no language specified.</dd>
<dt class="pubdef"><a name="rdfs_label/2"><strong>rdfs_label</strong>(<var>?Resource, 
?Label</var>)</a></dt>
<dd class="defbody">
Defined as <code>rdfs_label(Resource, _, Label)</code>.</dd>
<dt class="pubdef"><a name="rdfs_ns_label/3"><strong>rdfs_ns_label</strong>(<var>?Resource, 
?Language, ?Label</var>)</a></dt>
<dd class="defbody">
Similar to <a name="idx:rdfslabel2:134"></a><a class="pred" href="#rdfs_label/2">rdfs_label/2</a>, 
but prefixes the result using the declared namespace alias (see <a class="sec" href="#sec:3.5">section 
3.5</a>) to facilitate user-friendly labels in applications using 
multiple namespaces that may lead to confusion.</dd>
<dt class="pubdef"><a name="rdfs_ns_label/2"><strong>rdfs_ns_label</strong>(<var>?Resource, 
?Label</var>)</a></dt>
<dd class="defbody">
Defined as <code>rdfs_ns_label(Resource, _, Label)</code>.</dd>
<dt class="pubdef"><a name="rdfs_find/5"><strong>rdfs_find</strong>(<var>+String, 
+Description, ?Properties, +Method, -Subject</var>)</a></dt>
<dd class="defbody">
<a name="idx:search:135"></a>Find (on backtracking) <var>Subject</var>s 
that satisfy a search specification for textual attributes. <var>String</var> 
is the string searched for. <var>Description</var> is an OWL description 
(see <a class="sec" href="#sec:14">section 14</a>) specifying candidate 
resources. <var>Properties</var> is a list of properties to search for 
literal objects, <var>Method</var> defines the textual matching 
algorithm. All textual mapping is performed case-insensitive. The 
matching-methods are described with <a name="idx:rdfmatchlabel3:136"></a><a class="pred" href="#rdf_match_label/3">rdf_match_label/3</a>. 
If
<var>Properties</var> is unbound, the search is performed in any 
property and
<var>Properties</var> is unified with a list holding the property on 
which the match was found.
</dd>
</dl>

<h2><a name="sec:8"><span class="sec-nr">8</span> <span class="sec-title">Managing 
RDF input files</span></a></h2>

<a name="sec:rdflib"></a>

<p>Complex projects require RDF resources from many locations and 
typically wish to load these in different combinations. For example 
loading a small subset of the data for debugging purposes or load a 
different set of files for experimentation. The library <code>library(semweb/rdf_library.pl)</code> 
manages sets of RDF files spread over different locations, including 
file and network locations. The original version of this library 
supported metadata about collections of RDF sources in an RDF file 
called <em>Manifest</em>. The current version supports both the
<a class="url" href="http://www.w3.org/TR/void/">VoID</a> format and the 
original format. VoID files (typically named <code>void.ttl</code>) can 
use elements from the RDF Manifest vocabulary to support features that 
are not supported by VoID.

<h3><a name="sec:8.1"><span class="sec-nr">8.1</span> <span class="sec-title">The 
Manifest file</span></a></h3>

<p>A manifest file is an RDF file, often in
<a class="url" href="http://www.w3.org/TeamSubmission/turtle/">Turtle</a> 
format, that provides meta-data about RDF resources. Often, a manifest 
will describe RDF files in the current directory, but it can also 
describe RDF resources at arbitrary URL locations. The RDF schema for 
RDF library meta-data can be found in <code>rdf_library.ttl</code>. The 
namespace for the RDF library format is defined as
<a class="url" href="http://www.swi-prolog.org/rdf/library/">http://www.swi-prolog.org/rdf/library/</a> 
and abbreviated as
<code>lib</code>.

<p>The schema defines three root classes: lib:Namespace, lib:Ontology 
and lib:Virtual, which we describe below.

<dl class="latex">
<dt class="pubdef"><a name="lib:Ontology"><strong>lib:Ontology</strong></a></dt>
<dd class="defbody">
This is a subclass of owl:Ontology. It has two subclasses, lib:Schema 
and lib:Instances. These three classes are currently processed equally. 
The following properties are recognised on lib:Ontology:

<dl class="latex">
<dt class="pubdef"><a name="dc:title"><strong>dc:title</strong></a></dt>
<dd class="defbody">
Title of the ontology. Displayed by <a name="idx:rdflistlibrary0:137"></a><a class="pred" href="#rdf_list_library/0">rdf_list_library/0</a>.
</dd>
<dt class="pubdef"><a name="owl:versionInfo"><strong>owl:versionInfo</strong></a></dt>
<dd class="defbody">
Version of the ontology. Displayed by <a name="idx:rdflistlibrary0:138"></a><a class="pred" href="#rdf_list_library/0">rdf_list_library/0</a>.
</dd>
<dt class="pubdef"><a name="owl:imports"><strong>owl:imports</strong></a></dt>
<dd class="defbody">
Ontologies imported. If <a name="idx:rdfloadlibrary2:139"></a><a class="pred" href="#rdf_load_library/2">rdf_load_library/2</a> 
is used to load this ontology, the ontologies referenced here are loaded 
as well. There are two subProperties: lib:schema and lib:instances with 
the obvious meaning.
</dd>
<dt class="pubdef"><a name="lib:source"><strong>lib:source</strong></a></dt>
<dd class="defbody">
Defines the named graph into which the resource is loaded. If this ends 
in a <code><code>/</code></code>, the basename of each loaded file is 
appended to the given source. Defaults to the URL the RDF is loaded 
from.
</dd>
<dt class="pubdef"><a name="lib:baseURI"><strong>lib:baseURI</strong></a></dt>
<dd class="defbody">
Defines the base for processing the RDF data. If not provided this 
defaults to the named graph, which in turn defaults to the URL the RDF 
is loaded from.
</dd>
</dl>

</dd>
<dt class="pubdef"><a name="lib:Virtual"><strong>lib:Virtual</strong></a></dt>
<dd class="defbody">
Virtual ontologies do not refer to an RDF resource themselves. They only 
import other resources. For example the W3C WordNet manifest defines <code>wn-basic</code> 
and <code>wn-full</code> as virtual resources. The lib:Virtual resource 
is used as a second rdf:type:

<pre class="code">
&lt;wn-basic&gt;
        a lib:Ontology ;
        a lib:Virtual ;
        ...
</pre>

</dd>
<dt class="pubdef"><a name="lib:CloudNode"><strong>lib:CloudNode</strong></a></dt>
<dd class="defbody">
Used by ClioPatria to combine this ontology and all data it imports into 
a node in the automatically generated datacloud.</dd>
<dt class="pubdef"><a name="lib:Namespace"><strong>lib:Namespace</strong></a></dt>
<dd class="defbody">
Defines a URL to be a namespace. The definition provides the preferred 
mnemonic and can be referenced in the lib:providesNamespace and 
lib:usesNamespace properties. The <a name="idx:rdfloadlibrary2:140"></a><a class="pred" href="#rdf_load_library/2">rdf_load_library/2</a> 
predicates registers encountered namespace mnemonics with rdf-db using
<a name="idx:rdfregisterns2:141"></a><a class="pred" href="#rdf_register_ns/2">rdf_register_ns/2</a>. 
Typically namespace declarations use @prefix declarations. E.g. 

<pre class="code">
@prefix     lib: &lt;http://www.swi-prolog.org/rdf/library/&gt; .
@prefix    rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt; .

[ a lib:Namespace ;
  lib:mnemonic "rdfs" ;
  lib:namespace rdfs:
] .
</pre>

<p></dd>
</dl>

<h4><a name="sec:8.1.1"><span class="sec-nr">8.1.1</span> <span class="sec-title">Support 
for the VoID and VANN vocabularies</span></a></h4>

<p>The <a class="url" href="http://www.w3.org/TR/void/">VoID</a> aims at 
resolving the same problem as the Manifest files described here. In 
addition, the
<a class="url" href="http://vocab.org/vann/">VANN</a> vocabulary 
provides the information about preferred namepaces prefixes. The RDF 
library manager can deal with VoID files. The following relations apply:

<p>
<ul class="latex">
<li>VoID <code>Dataset</code> and <code>Linkset</code> are similar to
<code>lib:Ontology</code>, but a VoID resource is always
<em>Virtual</em>. I.e., the VoID URI itself never refers to an RDF 
document.

<p>
<li>The <code>owl:imports</code> and its lib specializations are 
replaced by <code>void:subset</code> (referring to another VoID dataset) 
and <code>void:dataDump</code> (referring to a concrete document).

<p>
<li>A description of the dataset is given using <code>dcterms:description</code> 
rather than <code>rdfs:comment</code>

<p>
<li>The RDF library recognises <code>lib:source</code>, <code>lib:baseURI</code> 
and <code>lib:Cloudnode</code>, which have no equivalent in VoID.

<p>
<li>The RDF library recognises <code>vann:preferredNamespacePrefix</code> 
and
<code>vann:preferredNamespaceUri</code> as alternatives to its 
proprietary way for defining prefixes. The domain of these predicates is 
unclear. The library recognises them regardless of the domain. Note that 
the range of <code>vann:preferredNamespaceUri</code> is a <em>literal</em>. 
A disadvantage of that is that the Turtle prefix declaration cannot be 
reused.
</ul>

<p>Currently, the RDF metadata is <em>not</em> stored in the RDF 
database. It is processed by low-level primitives that do <em>not</em> 
perform RDFS reasoning. In particular, this means that 
rdfs:supPropertyOf and rdfs:subClassOf cannot be used to specialise the 
RDF meta vocabulary.

<h4><a name="sec:8.1.2"><span class="sec-nr">8.1.2</span> <span class="sec-title">Finding 
manifest files</span></a></h4>

<p>The initial metadata file(s) are loaded into the system using
<a name="idx:rdfattachlibrary1:142"></a><a class="pred" href="#rdf_attach_library/1">rdf_attach_library/1</a>.

<dl class="latex">
<dt class="pubdef"><a name="rdf_attach_library/1"><strong>rdf_attach_library</strong>(<var>+FileOrDirectory</var>)</a></dt>
<dd class="defbody">
Load meta-data on RDF repositories from <var>FileOrDirectory</var>. If 
the argument is a directory, this directory is processed recursively and 
each for each directory, a file named <code>void.ttl</code>,
<code>Manifest.ttl</code> or <code>Manifest.rdf</code> is loaded (in 
this order of preference).

<p>Declared namespaces are added to the rdf-db namespace list. 
Encountered ontologies are added to a private database of
<code>rdf_list_library.pl</code>. Each ontology is given an
<em>identifier</em>, derived from the basename of the URL without the 
extension. This, using the declaration below, the identifier of the 
declared ontology is <code>wn-basic</code>.

<pre class="code">
&lt;wn-basic&gt;
        a void:Dataset ;
        dcterms:title "Basic WordNet" ;
        ...
</pre>

</dd>
<dt class="pubdef"><a name="rdf_list_library/0"><strong>rdf_list_library</strong></a></dt>
<dd class="defbody">
List the available resources in the library. Currently only lists 
resources that have a dcterms:title property. See <a class="sec" href="#sec:8.2">section 
8.2</a> for an example.
</dd>
</dl>

<p>It is possible for the initial set of manifests to refer to RDF files 
that are not covered by a manifest. If such a reference is encountered 
while loading or listing a library, the library manager will look for a 
manifest file in the directory holding the referenced RDF file and load 
this manifest. If a manifest is found that covers the referenced file, 
the directives found in the manifest will be followed. Otherwise the RDF 
resource is simply loaded using the current defaults.

<p>Further exploration of the library is achieved using <a name="idx:rdflistlibrary1:143"></a><a class="pred" href="#rdf_list_library/1">rdf_list_library/1</a> 
or <a name="idx:rdflistlibrary2:144"></a><a class="pred" href="#rdf_list_library/2">rdf_list_library/2</a>:

<dl class="latex">
<dt class="pubdef"><a name="rdf_list_library/1"><strong>rdf_list_library</strong>(<var>+Id</var>)</a></dt>
<dd class="defbody">
Same as <code>rdf_list_library(Id,[])</code>.</dd>
<dt class="pubdef"><a name="rdf_list_library/2"><strong>rdf_list_library</strong>(<var>+Id, 
+Options</var>)</a></dt>
<dd class="defbody">
Lists the resources that will be loaded if <var>Id</var> is handed to
<a name="idx:rdfloadlibrary2:145"></a><a class="pred" href="#rdf_load_library/2">rdf_load_library/2</a>. 
See <a name="idx:rdfattachlibrary1:146"></a><a class="pred" href="#rdf_attach_library/1">rdf_attach_library/1</a> 
for how ontology identifiers are generated. In addition it checks the 
existence of each resource to help debugging library dependencies. 
Before doing its work,
<a name="idx:rdflistlibrary2:147"></a><a class="pred" href="#rdf_list_library/2">rdf_list_library/2</a> 
reloads manifests that have changed since they were loaded the last 
time. For HTTP resources it uses the HEAD method to verify existence and 
last modification time of resources.</dd>
<dt class="pubdef"><a name="rdf_load_library/2"><strong>rdf_load_library</strong>(<var>+Id, 
+Options</var>)</a></dt>
<dd class="defbody">
Load the given library. First <a name="idx:rdfloadlibrary2:148"></a><a class="pred" href="#rdf_load_library/2">rdf_load_library/2</a> 
will establish what resources need to be loaded and whether all 
resources exist. Than it will load the resources.
</dd>
</dl>

<h3><a name="sec:8.2"><span class="sec-nr">8.2</span> <span class="sec-title">Usage 
scenarios</span></a></h3>

<a name="sec:usage"></a>

<p>Typically, a project will use a single file using the same format as 
a manifest file that defines alternative configurations that can be 
loaded. This file is loaded at program startup using
<a name="idx:rdfattachlibrary1:149"></a><a class="pred" href="#rdf_attach_library/1">rdf_attach_library/1</a>. 
Users can now list the available libraries using <a name="idx:rdflistlibrary0:150"></a><a class="pred" href="#rdf_list_library/0">rdf_list_library/0</a> 
and <a name="idx:rdflistlibrary1:151"></a><a class="pred" href="#rdf_list_library/1">rdf_list_library/1</a>:

<pre class="code">
1 ?- rdf_list_library.
ec-core-vocabularies E-Culture core vocabularies
ec-all-vocabularies All E-Culture vocabularies
ec-hacks            Specific hacks
ec-mappings         E-Culture ontology mappings
ec-core-collections E-Culture core collections
ec-all-collections  E-Culture all collections
ec-medium           E-Culture medium sized data (artchive+aria)
ec-all              E-Culture all data
</pre>

<p>Now we can list a specific category using <a name="idx:rdflistlibrary1:152"></a><a class="pred" href="#rdf_list_library/1">rdf_list_library/1</a>. 
Note this loads two additional manifests referenced by resources 
encountered in
<code>ec-mappings</code>. If a resource does not exist is is flagged 
using
<code>[NOT FOUND]</code>.

<pre class="code">
2 ?- rdf_list_library('ec-mappings').
% Loaded RDF manifest /home/jan/src/eculture/vocabularies/mappings/Manifest.ttl
% Loaded RDF manifest /home/jan/src/eculture/collections/aul/Manifest.ttl
&lt;file:///home/jan/src/eculture/src/server/ec-mappings&gt;
. &lt;file:///home/jan/src/eculture/vocabularies/mappings/mappings&gt;
. . &lt;file:///home/jan/src/eculture/vocabularies/mappings/interface&gt;
. . . file:///home/jan/src/eculture/vocabularies/mappings/interface_class_mapping.ttl
. . . file:///home/jan/src/eculture/vocabularies/mappings/interface_property_mapping.ttl
. . &lt;file:///home/jan/src/eculture/vocabularies/mappings/properties&gt;
. . . file:///home/jan/src/eculture/vocabularies/mappings/ethnographic_property_mapping.ttl
. . . file:///home/jan/src/eculture/vocabularies/mappings/eculture_properties.ttl
. . . file:///home/jan/src/eculture/vocabularies/mappings/eculture_property_semantics.ttl
. . &lt;file:///home/jan/src/eculture/vocabularies/mappings/situations&gt;
. . . file:///home/jan/src/eculture/vocabularies/mappings/eculture_situations.ttl
. &lt;file:///home/jan/src/eculture/collections/aul/aul&gt;
. . file:///home/jan/src/eculture/collections/aul/aul.rdfs
. . file:///home/jan/src/eculture/collections/aul/aul.rdf
. . file:///home/jan/src/eculture/collections/aul/aul9styles.rdf
. . file:///home/jan/src/eculture/collections/aul/extractedperiods.rdf
. . file:///home/jan/src/eculture/collections/aul/manual-periods.rdf
</pre>

<h4><a name="sec:8.2.1"><span class="sec-nr">8.2.1</span> <span class="sec-title">Referencing 
resources</span></a></h4>

<p>Resources and manifests are located either on the local filesystem or 
on a network resource. The initial manifest can also be loaded from a 
file or a URL. This defines the initial <em>base URL</em> of the 
document. The base URL can be overruled using the Turtle @base 
directive. Other documents can be referenced relative to this base URL 
by exploiting Turtle's URI expansion rules. Turtle resources can be 
specified in three ways, as absolute URLs (e.g. <code>&lt;http://www.example.com/rdf/ontology.rdf</code>&gt;), 
as relative URL to the base (e.g. <code>&lt;../rdf/ontology.rdf</code>&gt;) 
or following a
<em>prefix</em> (e.g. prefix:ontology).

<p>The prefix notation is powerful as we can define multiple of them and 
define resources relative to them. Unfortunately, prefixes can only be 
defined as absolute URLs or URLs relative to the base URL. Notably, they 
cannot be defined relative to other prefixes. In addition, a prefix can 
only be followed by a Qname, which excludes <code>.</code> and <code>/</code>.

<p>Easily relocatable manifests must define all resources relative to 
the base URL. Relocation is automatic if the manifest remains in the 
same hierarchy as the resources it references. If the manifest is copied 
elsewhere (i.e. for creating a local version) it can use @base to refer 
to the resource hierarchy. We can point to directories holding manifest 
files using @prefix declarations. There, we can reference
<em>Virtual</em> resources using prefix:name. Here is an example, were 
we first give some line from the initial manifest followed by the 
definition of the virtual RDFS resource.

<pre class="code">
@base &lt;http://gollem.science.uva.nl/e-culture/rdf/&gt; .

@prefix base:           &lt;base_ontologies/&gt; .

&lt;ec-core-vocabularies&gt;
        a lib:Ontology ;
        a lib:Virtual ;
        dc:title "E-Culture core vocabularies" ;
        owl:imports
                base:rdfs ,
                base:owl ,
                base:dc ,
                base:vra ,
                ...
</pre>

<pre class="code">
&lt;rdfs&gt;
        a lib:Schema ;
        a lib:Virtual ;
        rdfs:comment "RDF Schema" ;
        lib:source rdfs: ;
        lib:schema &lt;rdfs.rdfs&gt; .
</pre>

<h3><a name="sec:8.3"><span class="sec-nr">8.3</span> <span class="sec-title">Putting 
it all together</span></a></h3>

<p>In this section we provide skeleton code for filling the RDF database 
from a password protected HTTP repository. The first line loads the 
application. Next we include modules that enable us to manage the RDF 
library, RDF database caching and HTTP connections. Then we setup the 
HTTP authentication, enable caching of processed RDF files and load the 
initial manifest. Finally <a name="idx:loaddata0:153"></a><span class="pred-ext">load_data/0</span> 
loads all our RDF data.

<pre class="code">
:- use_module(server).

:- use_module(library(http/http_open)).
:- use_module(library(semweb/rdf_library)).
:- use_module(library(semweb/rdf_cache)).

:- http_set_authorization('http://www.example.org/rdf',
                          basic(john, secret)).

:- rdf_set_cache_options([ global_directory('RDF-Cache'),
                           create_global_directory(true)
                         ]).


:- rdf_attach_library('http://www.example.org/rdf/Manifest.ttl').

%%      load_data
%
%       Load our RDF data

load_data :-
        rdf_load_library('all').
</pre>

<h3><a name="sec:8.4"><span class="sec-nr">8.4</span> <span class="sec-title">Example: 
A metadata file for W3C WordNet</span></a></h3>

<a name="sec:w3cmanifest"></a>

<p>The VoID metadata below allows for loading WordNet in the two 
predefined versions using one of

<pre class="code">
?- rdf_load_library('wn-basic', []).
?- rdf_load_library('wn-full', []).
</pre>

<pre class="code">
@prefix    void: &lt;http://rdfs.org/ns/void#&gt; .
@prefix    vann: &lt;http://purl.org/vocab/vann/&gt; .
@prefix     lib: &lt;http://www.swi-prolog.org/rdf/library/&gt; .
@prefix     owl: &lt;http://www.w3.org/2002/07/owl#&gt; .
@prefix     rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .
@prefix    rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt; .
@prefix     xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt; .
@prefix      dc: &lt;http://purl.org/dc/terms/&gt; .
@prefix   wn20s: &lt;http://www.w3.org/2006/03/wn/wn20/schema/&gt; .
@prefix   wn20i: &lt;http://www.w3.org/2006/03/wn/wn20/instances/&gt; .

[ vann:preferredNamespacePrefix "wn20i" ;
  vann:preferredNamespaceUri "http://www.w3.org/2006/03/wn/wn20/instances/"
] .

[ vann:preferredNamespacePrefix "wn20s" ;
  vann:preferredNamespaceUri "http://www.w3.org/2006/03/wn/wn20/schema/"
] .

&lt;wn20-common&gt;
        a void:Dataset ;
        dc:description "Common files between full and basic version" ;
        lib:source wn20i: ;
        void:dataDump
                &lt;wordnet-attribute.rdf.gz&gt; ,
                &lt;wordnet-causes.rdf.gz&gt; ,
                &lt;wordnet-classifiedby.rdf.gz&gt; ,
                &lt;wordnet-entailment.rdf.gz&gt; ,
                &lt;wordnet-glossary.rdf.gz&gt; ,
                &lt;wordnet-hyponym.rdf.gz&gt; ,
                &lt;wordnet-membermeronym.rdf.gz&gt; ,
                &lt;wordnet-partmeronym.rdf.gz&gt; ,
                &lt;wordnet-sameverbgroupas.rdf.gz&gt; ,
                &lt;wordnet-similarity.rdf.gz&gt; ,
                &lt;wordnet-synset.rdf.gz&gt; ,
                &lt;wordnet-substancemeronym.rdf.gz&gt; ,
                &lt;wordnet-senselabels.rdf.gz&gt; .

&lt;wn20-skos&gt;
        a void:Dataset ;
        void:subset &lt;wnskosmap&gt; ;
        void:dataDump &lt;wnSkosInScheme.ttl.gz&gt; .

&lt;wnskosmap&gt;
        a lib:Schema ;
        lib:source wn20s: ;
        void:dataDump
                &lt;wnskosmap.rdfs&gt; .

&lt;wnbasic-schema&gt;
        a void:Dataset ;
        lib:source wn20s: ;
        void:dataDump
                &lt;wnbasic.rdfs&gt; .

&lt;wn20-basic&gt;
        a void:Dataset ;
        a lib:CloudNode ;
        dc:title "Basic WordNet" ;
        dc:description "Light version of W3C WordNet" ;
        owl:versionInfo "2.0" ;
        lib:source wn20i: ;
        void:subset
                &lt;wnbasic-schema&gt; ,
                &lt;wn20-skos&gt; ,
                &lt;wn20-common&gt; .

&lt;wnfull-schema&gt;
        a void:Dataset ;
        lib:source wn20s: ;
        void:dataDump
                &lt;wnfull.rdfs&gt; .

&lt;wn20-full&gt;
        a void:Dataset ;
        a lib:CloudNode ;
        dc:title "Full WordNet" ;
        dc:description "Full version of W3C WordNet" ;
        owl:versionInfo "2.0" ;
        lib:source wn20i: ;
        void:subset
                &lt;wnfull-schema&gt; ,
                &lt;wn20-skos&gt; ,
                &lt;wn20-common&gt; ;
        void:dataDump
                &lt;wordnet-antonym.rdf.gz&gt; ,
                &lt;wordnet-derivationallyrelated.rdf.gz&gt; ,
                &lt;wordnet-participleof.rdf.gz&gt; ,
                &lt;wordnet-pertainsto.rdf.gz&gt; ,
                &lt;wordnet-seealso.rdf.gz&gt; ,
                &lt;wordnet-wordsensesandwords.rdf.gz&gt; ,
                &lt;wordnet-frame.rdf.gz&gt; .
</pre>

<h2><a name="sec:9"><span class="sec-nr">9</span> <span class="sec-title">library(semweb/sparql_client): 
SPARQL client library</span></a></h2>

<p><a name="sec:sparqlclient"></a>

<p>This module provides a SPARQL client. For example:

<pre class="code">
?- sparql_query('select * where { ?x rdfs:label "Amsterdam" }', Row,
                [ host('dbpedia.org'), path('/sparql/')]).

Row = row('http://www.ontologyportal.org/WordNet#WN30-108949737') ;
false.
</pre>

<p>Or, querying a local server using an <code>ASK</code> query:

<pre class="code">
?- sparql_query('ask { owl:Class rdfs:label "Class" }', Row,
                [ host('localhost'), port(3020), path('/sparql/')]).
Row = true.
</pre>

<dl class="latex">
<dt class="pubdef"><span class="pred-tag">[nondet]</span><a name="sparql_query/3"><strong>sparql_query</strong>(<var>+Query, 
-Result, +Options</var>)</a></dt>
<dd class="defbody">
Execute a SPARQL query on an HTTP SPARQL endpoint. <var>Query</var> is 
an atom that denotes the query. <var>Result</var> is unified to a term 
rdf(S,P,O) for <code>CONSTRUCT</code> and <code>DESCRIBE</code> queries, 
row(...) for
<code>SELECT</code> queries and <code>true</code> or <code>false</code> 
for <code>ASK</code> queries.
<var>Options</var> are

<dl class="latex">
<dt><strong>host</strong>(<var>+Host</var>)</dt>
<dt><strong>port</strong>(<var>+Port</var>)</dt>
<dt><strong>path</strong>(<var>+Path</var>)</dt>
<dd class="defbody">
The above three options set the location of the server.
</dd>
<dt><strong>search</strong>(<var>+ListOfParams</var>)</dt>
<dd class="defbody">
Provide additional query parameters, such as the graph.
</dd>
<dt><strong>variable_names</strong>(<var>-ListOfNames</var>)</dt>
<dd class="defbody">
Unifies ListOfNames with a list of atoms that describe the names of the 
variables in a <code>SELECT</code> query.
</dd>
</dl>

<p>Remaining options are passed to <span class="pred-ext">http_open/3</span>. 
The defaults for Host, Port and Path can be set using <a class="pred" href="#sparql_set_server/1">sparql_set_server/1</a>. 
The initial default for port is 80 and path is <code>/sparql/</code>.

<p>For example, the ClioPatria server understands the parameter
<code>entailment</code>. The code below queries for all triples using 
_rdfs_entailment.

<pre class="code">
?- sparql_query('select * where { ?s ?p ?o }',
                Row,
                [ search([entailment=rdfs])
                ]).
</pre>

</dd>
<dt class="pubdef"><a name="sparql_set_server/1"><strong>sparql_set_server</strong>(<var>+OptionOrList</var>)</a></dt>
<dd class="defbody">
Set sparql server default options. Provided defaults are: host, port and 
repository. For example:

<pre class="code">
    sparql_set_server([ host(localhost),
                        port(8080)
                        path(world)
                      ])
</pre>

<p>The default for port is 80 and path is <code>/sparql/</code>.</dd>
<dt class="pubdef"><a name="sparql_read_xml_result/2"><strong>sparql_read_xml_result</strong>(<var>+Input, 
-Result</var>)</a></dt>
<dd class="defbody">
Specs from <a class="url" href="http://www.w3.org/TR/rdf-sparql-XMLres/.">http://www.w3.org/TR/rdf-sparql-XMLres/.</a> 
The returned
<var>Result</var> term is of the format:

<dl class="latex">
<dt><strong>select</strong>(<var>VarNames, Rows</var>)</dt>
<dd class="defbody">
Where VarNames is a term v(Name, ...) and Rows is a list of row(....) 
containing the column values in the same order as the variable names.
</dd>
<dt><strong>ask</strong>(<var>Bool</var>)</dt>
<dd class="defbody">
Where Bool is either <code>true</code> or <code>false</code>
</dd>
</dl>

</dd>
<dt class="pubdef"><span class="pred-tag">[det]</span><a name="sparql_read_json_result/2"><strong>sparql_read_json_result</strong>(<var>+Input, 
-Result</var>)</a></dt>
<dd class="defbody">
The returned <var>Result</var> term is of the format:

<dl class="latex">
<dt><strong>select</strong>(<var>VarNames, Rows</var>)</dt>
<dd class="defbody">
Where VarNames is a term v(Name, ...) and Rows is a list of row(....) 
containing the column values in the same order as the variable names.
</dd>
<dt><strong>ask</strong>(<var>Bool</var>)</dt>
<dd class="defbody">
Where Bool is either <code>true</code> or <code>false</code>
</dd>
</dl>

<dl class="tags">
<dt class="tag">See also</dt>
<dd>
<a class="url" href="http://www.w3.org/TR/rdf-sparql-json-res/">http://www.w3.org/TR/rdf-sparql-json-res/</a>
</dd>
</dl>

</dd>
</dl>

<h2><a name="sec:10"><span class="sec-nr">10</span> <span class="sec-title">library(semweb/rdf_compare): 
Compare RDF graphs</span></a></h2>

<p><a name="sec:rdfcompare"></a>

<p>This library provides predicates that compare RDF graphs. The current 
version only provides one predicate: <a class="pred" href="#rdf_equal_graphs/3">rdf_equal_graphs/3</a> 
verifies that two graphs are identical after proper labeling of the 
blank nodes.

<p>Future versions of this library may contain more advanced operations, 
such as diffing two graphs.

<dl class="latex">
<dt class="pubdef"><span class="pred-tag">[semidet]</span><a name="rdf_equal_graphs/3"><strong>rdf_equal_graphs</strong>(<var>+GraphA, 
+GraphB, -Substition</var>)</a></dt>
<dd class="defbody">
True if <var>GraphA</var> and <var>GraphB</var> are the same under <var>Substition</var>.
<var>Substition</var> is a list of BNodeA = BNodeB, where BNodeA is a 
blank node that appears in <var>GraphA</var> and BNodeB is a blank node 
that appears in <var>GraphB</var>.
<table class="paramlist">
<tr valign="top"><td><var>GraphA</var> </td><td>is a list of rdf(S,P,O) 
terms </td></tr>
<tr valign="top"><td><var>GraphB</var> </td><td>is a list of rdf(S,P,O) 
terms </td></tr>
<tr valign="top"><td><var>Substition</var> </td><td>is a list if NodeA = 
NodeB terms. </td></tr>
</table>

<dl class="tags">
<dt class="tag">To be done</dt>
<dd>
The current implementation is rather naive. After dealing with the 
subgraphs that contain no bnodes, it performs a fully non-deterministic 
substitution.
</dd>
</dl>

</dd>
</dl>

<h2><a name="sec:11"><span class="sec-nr">11</span> <span class="sec-title">library(semweb/rdf_portray): 
Portray RDF resources</span></a></h2>

<p><a name="sec:rdfportray"></a>

<dl class="tags">
<dt class="mtag">To be done</dt>
<dd>
- Define alternate predicate to use for providing a comment <br>
- Use rdf:type if there is no meaningful label? <br>
- Smarter guess whether or not the local identifier might be meaningful 
to the user without a comment. I.e. does it look `word-like'?
</dd>
</dl>

<p>This module defines rules for <span class="pred-ext">user:portray/1</span> 
to help tracing and debugging RDF resources by printing them in a more 
concise representation and optionally adding comment from the label 
field to help the user interpreting the URL. The main predicates are:

<p>
<ul class="latex">
<li><a class="pred" href="#rdf_portray_as/1">rdf_portray_as/1</a> 
defines the overall style
<li><a class="pred" href="#rdf_portray_lang/1">rdf_portray_lang/1</a> 
selects languages for extracting label comments
</ul>

<dl class="latex">
<dt class="pubdef"><span class="pred-tag">[det]</span><a name="rdf_portray_as/1"><strong>rdf_portray_as</strong>(<var>+Style</var>)</a></dt>
<dd class="defbody">
Set the style used to portray resources. <var>Style</var> is one of:

<dl class="latex">
<dt><var><code>ns()</code></var> <strong><code>:</code></strong> <var><code>id()</code></var></dt>
<dd class="defbody">
Write as NS:ID, compatible with what can be handed to the rdf 
predicates. This is the default.
</dd>
<dt><strong>writeq</strong></dt>
<dd class="defbody">
Use quoted write of the full resource.
</dd>
<dt><var><code>ns()</code></var> <strong><code>:</code></strong> <var><code>label()</code></var></dt>
<dd class="defbody">
Write namespace followed by the label. This format cannot be handed to <a class="pred" href="#rdf/3">rdf/3</a> 
and friends, but can be useful if resource-names are meaningless 
identifiers.
</dd>
<dt><var><code><code>ns()</code>:<code>id()</code></code></var> <strong><code>=</code></strong> <var><code>label()</code></var></dt>
<dd class="defbody">
This combines ns:id with ns:label, providing both human readable output 
and output that can be pasted into the commandline.
</dd>
</dl>

<dl class="tags">
<dt class="tag">Compatibility</dt>
<dd>
also accepts <code>prefix</code> instead of <code>ns</code> for 
compatibility with version 3 of this library.
</dd>
</dl>

</dd>
<dt class="pubdef"><span class="pred-tag">[det]</span><a name="rdf_portray_lang/1"><strong>rdf_portray_lang</strong>(<var>+Lang</var>)</a></dt>
<dd class="defbody">
If <var>Lang</var> is a list, set the list or preferred languages. If it 
is a single atom, push this language as the most preferred language.
</dd>
</dl>

<h2><a name="sec:12"><span class="sec-nr">12</span> <span class="sec-title">library(semweb/rdf_edit): 
Keep track of edits (deprecated)</span></a></h2>

<a name="sec:rdfedit"></a>
<blockquote><em>It is anticipated that this library will eventually be 
superseeded by facilities running on top of the native <a name="idx:rdftransaction2:154"></a><a class="pred" href="#rdf_transaction/2">rdf_transaction/2</a> 
and
<a name="idx:rdfmonitor2:155"></a><a class="pred" href="#rdf_monitor/2">rdf_monitor/2</a> 
facilities. See <a class="sec" href="#sec:3.6">section 3.6</a>.
</em></blockquote>

<p><a name="idx:undo:156"></a><a name="idx:journal:157"></a><a name="idx:transactions:158"></a>The 
module <code>rdf_edit.pl</code> is a layer than encasulates the 
modification predicates from <a class="sec" href="#sec:3.3">section 3.3</a> 
for use from a (graphical) editor of the triple store. It adds the 
following features:

<p>
<ul class="latex">
<li><i>Transaction management</i><br>
Modifications are grouped into <em>transactions</em> to safeguard the 
system from failing operations as well as provide meaningfull chunks for 
undo and journalling.

<p>
<li><i>Undo</i><br>
Undo and redo-transactions using a single mechanism to support 
user-friendly editing.

<p>
<li><i>Journalling</i><br>
Record all actions to support analysis, versioning, crash-recovery and 
an alternative to saving.
</ul>

<h3><a name="sec:12.1"><span class="sec-nr">12.1</span> <span class="sec-title">Transaction 
management</span></a></h3>

<p>Transactions group low-level modification actions together.

<dl class="latex">
<dt class="pubdef"><a name="rdfe_transaction/1"><strong>rdfe_transaction</strong>(<var>:Goal</var>)</a></dt>
<dd class="defbody">
Run <var>Goal</var>, recording all modifications to the triple store 
made through <a class="sec" href="#sec:12.3">section 12.3</a>. Execution 
is performed as in <a name="idx:once1:159"></a><span class="pred-ext">once/1</span>. 
If
<var>Goal</var> succeeds the changes are committed. If <var>Goal</var> 
fails or throws an exception the changes are reverted.

<p>Transactions may be nested. A failing nested transaction only reverts 
the actions performed inside the nested transaction. If the outer 
transaction succeeds it is committed normally. Contrary, if the outer 
transaction fails, comitted nested transactions are reverted as well. If 
any of the modifications inside the transaction modifies a protected 
file (see <a name="idx:rdfesetfileproperty2:160"></a><a class="pred" href="#rdfe_set_file_property/2">rdfe_set_file_property/2</a>) 
the transaction is reverted and <a name="idx:rdfetransaction1:161"></a><a class="pred" href="#rdfe_transaction/1">rdfe_transaction/1</a> 
throws a permission error.

<p>A successful outer transaction (`level-0') may be undone using
<a name="idx:rdfeundo0:162"></a><a class="pred" href="#rdfe_undo/0">rdfe_undo/0</a>.</dd>
<dt class="pubdef"><a name="rdfe_transaction/2"><strong>rdfe_transaction</strong>(<var>:Goal, 
+Name</var>)</a></dt>
<dd class="defbody">
As <a name="idx:rdfetransaction1:163"></a><a class="pred" href="#rdfe_transaction/1">rdfe_transaction/1</a>, 
naming the transaction <var>Name</var>. Transaction naming is intended 
for the GUI to give the user an idea of the next undo action. See also <a name="idx:rdfesettransactionname1:164"></a><a class="pred" href="#rdfe_set_transaction_name/1">rdfe_set_transaction_name/1</a> 
and
<a name="idx:rdfetransactionname2:165"></a><a class="pred" href="#rdfe_transaction_name/2">rdfe_transaction_name/2</a>.</dd>
<dt class="pubdef"><a name="rdfe_set_transaction_name/1"><strong>rdfe_set_transaction_name</strong>(<var>+Name</var>)</a></dt>
<dd class="defbody">
Set the `name' of the current transaction to <var>Name</var>.</dd>
<dt class="pubdef"><a name="rdfe_transaction_name/2"><strong>rdfe_transaction_name</strong>(<var>?TID, 
?Name</var>)</a></dt>
<dd class="defbody">
Query assigned transaction names.</dd>
<dt class="pubdef"><a name="rdfe_transaction_member/2"><strong>rdfe_transaction_member</strong>(<var>+TID, 
-Action</var>)</a></dt>
<dd class="defbody">
Enumerate the actions that took place inside a transaction. This can be 
used by a GUI to optimise the MVC (Model-View-Controller) feedback loop. <var>Action</var> 
is one of:

<dl class="latex">
<dt><strong>assert</strong>(<var>Subject, Predicate, Object</var>)</dt>
<dt><strong>retract</strong>(<var>Subject, Predicate, Object</var>)</dt>
<dt><strong>update</strong>(<var>Subject, Predicate, Object, Action</var>)</dt>
<dt><strong>file</strong>(<var>load(Path)</var>)</dt>
<dt><strong>file</strong>(<var>unload(Path)</var>)</dt>
<dd class="defbody">
</dd>
</dl>

</dd>
</dl>

<h3><a name="sec:12.2"><span class="sec-nr">12.2</span> <span class="sec-title">File 
management</span></a></h3>

<a name="sec:file"></a>

<dl class="latex">
<dt class="pubdef"><a name="rdfe_is_modified/1"><strong>rdfe_is_modified</strong>(<var>?File</var>)</a></dt>
<dd class="defbody">
Enumerate/test whether <var>File</var> is modified sinds it was loaded 
or sinds the last call to <a name="idx:rdfeclearmodified1:166"></a><a class="pred" href="#rdfe_clear_modified/1">rdfe_clear_modified/1</a>. 
Whether or not a file is modified is determined by the MD5 checksum of 
all triples belonging to the file.</dd>
<dt class="pubdef"><a name="rdfe_clear_modified/1"><strong>rdfe_clear_modified</strong>(<var>+File</var>)</a></dt>
<dd class="defbody">
Set the <em>unmodified-MD5</em> to the current MD5 checksum. See also
<a name="idx:rdfeismodified1:167"></a><a class="pred" href="#rdfe_is_modified/1">rdfe_is_modified/1</a>.</dd>
<dt class="pubdef"><a name="rdfe_set_file_property/2"><strong>rdfe_set_file_property</strong>(<var>+File, 
+Property</var>)</a></dt>
<dd class="defbody">
Control access right and default destination of new triples.
<var>Property</var> is one of

<dl class="latex">
<dt><strong>access</strong>(<var>+Access</var>)</dt>
<dd class="defbody">
Where access is one of <code>ro</code> or <code>rw</code>. Access <code>ro</code> 
is default when a file is loaded for which the user has no write access. 
If a transaction (see <a name="idx:rdfetransaction1:168"></a><a class="pred" href="#rdfe_transaction/1">rdfe_transaction/1</a>) 
modifies a file with access <code>ro</code> the transaction is reversed.</dd>
<dt><strong>default</strong>(<var>+Default</var>)</dt>
<dd class="defbody">
Set this file to be the default destination of triples. If
<var>Default</var> is <code>fallback</code> it is only the default for 
triples that have no clear default destination. If it is <code>all</code> 
all new triples are added to this file.
</dd>
</dl>

</dd>
<dt class="pubdef"><a name="rdfe_get_file_property/2"><strong>rdfe_get_file_property</strong>(<var>?File, 
?Property</var>)</a></dt>
<dd class="defbody">
Query properties set with <a name="idx:rdfesetfileproperty2:169"></a><a class="pred" href="#rdfe_set_file_property/2">rdfe_set_file_property/2</a>.
</dd>
</dl>

<h3><a name="sec:12.3"><span class="sec-nr">12.3</span> <span class="sec-title">Encapsulated 
predicates</span></a></h3>

<a name="sec:rdfeencap"></a>

<p>The following predicates encapsulate predicates from the <code>rdf_db</code> 
module that modify the triple store. These predicates can only be called 
when inside a <em>transaction</em>. See <a name="idx:rdfetransaction1:170"></a><a class="pred" href="#rdfe_transaction/1">rdfe_transaction/1</a>.

<dl class="latex">
<dt class="pubdef"><a name="rdfe_assert/3"><strong>rdfe_assert</strong>(<var>+Subject, 
+Predicate, +Object</var>)</a></dt>
<dd class="defbody">
Encapsulates <a name="idx:rdfassert3:171"></a><a class="pred" href="#rdf_assert/3">rdf_assert/3</a>.
</dd>
<dt class="pubdef"><a name="rdfe_retractall/3"><strong>rdfe_retractall</strong>(<var>?Subject, 
?Predicate, ?Object</var>)</a></dt>
<dd class="defbody">
Encapsulates <a name="idx:rdfretractall3:172"></a><a class="pred" href="#rdf_retractall/3">rdf_retractall/3</a>.
</dd>
<dt class="pubdef"><a name="rdfe_update/4"><strong>rdfe_update</strong>(<var>+Subject, 
+Predicate, +Object, +Action</var>)</a></dt>
<dd class="defbody">
Encapsulates <a name="idx:rdfupdate4:173"></a><a class="pred" href="#rdf_update/4">rdf_update/4</a>.
</dd>
<dt class="pubdef"><a name="rdfe_load/1"><strong>rdfe_load</strong>(<var>+In</var>)</a></dt>
<dd class="defbody">
Encapsulates <a name="idx:rdfload1:174"></a><a class="pred" href="#rdf_load/1">rdf_load/1</a>.
</dd>
<dt class="pubdef"><a name="rdfe_unload/1"><strong>rdfe_unload</strong>(<var>+In</var>)</a></dt>
<dd class="defbody">
Encapsulates <a name="idx:rdfunload1:175"></a><a class="pred" href="#rdf_unload/1">rdf_unload/1</a>.
</dd>
</dl>

<h3><a name="sec:12.4"><span class="sec-nr">12.4</span> <span class="sec-title">High-level 
modification predicates</span></a></h3>

<a name="sec:rdfeedit"></a>

<p>This section describes a (yet very incomplete) set of more high-level 
operations one would like to be able to perform. Eventually this set may 
include operations based on RDFS and OWL.

<dl class="latex">
<dt class="pubdef"><a name="rdfe_delete/1"><strong>rdfe_delete</strong>(<var>+Resource</var>)</a></dt>
<dd class="defbody">
Delete all traces of <var>resource</var>. This implies all triples where
<var>Resource</var> appears as <em>subject</em>, <em>predicate</em> or
<em>object</em>. This predicate starts a transation.
</dd>
</dl>

<h3><a name="sec:12.5"><span class="sec-nr">12.5</span> <span class="sec-title">Undo</span></a></h3>

<p><a name="idx:undo:176"></a>Undo aims at user-level undo operations 
from a (graphical) editor.

<dl class="latex">
<dt class="pubdef"><a name="rdfe_undo/0"><strong>rdfe_undo</strong></a></dt>
<dd class="defbody">
Revert the last outermost (`level 0') transaction (see
<a name="idx:rdfetransaction1:177"></a><a class="pred" href="#rdfe_transaction/1">rdfe_transaction/1</a>). 
Successive calls go further back in history. Fails if there is no more 
undo information.</dd>
<dt class="pubdef"><a name="rdfe_redo/0"><strong>rdfe_redo</strong></a></dt>
<dd class="defbody">
Revert the last <a name="idx:rdfeundo0:178"></a><a class="pred" href="#rdfe_undo/0">rdfe_undo/0</a>. 
Successive calls revert more <a name="idx:rdfeundo0:179"></a><a class="pred" href="#rdfe_undo/0">rdfe_undo/0</a> 
operations. Fails if there is no more redo information.</dd>
<dt class="pubdef"><a name="rdfe_can_undo/1"><strong>rdfe_can_undo</strong>(<var>-TID</var>)</a></dt>
<dd class="defbody">
Test if there is another transaction that can be reverted. Used for 
activating menus in a graphical environment. <var>TID</var> is unified 
to the transaction id of the action that will be reverted.</dd>
<dt class="pubdef"><a name="rdfe_can_redo/1"><strong>rdfe_can_redo</strong>(<var>-TID</var>)</a></dt>
<dd class="defbody">
Test if there is another undo that can be reverted. Used for activating 
menus in a graphical environment. <var>TID</var> is unified to the 
transaction id of the action that will be reverted.
</dd>
</dl>

<h3><a name="sec:12.6"><span class="sec-nr">12.6</span> <span class="sec-title">Journalling</span></a></h3>

<p><a name="idx:journal:180"></a>Optionally, every action through this 
module is immediately send to a
<em>journal-file</em>. The journal provides a full log of all actions 
with a time-stamp that may be used for inspection of behaviour, version 
management, crash-recovery or an alternative to regular save operations.

<dl class="latex">
<dt class="pubdef"><a name="rdfe_open_journal/2"><strong>rdfe_open_journal</strong>(<var>+File, 
+Mode</var>)</a></dt>
<dd class="defbody">
Open a existing or new journal. If <var>Mode</var> equala <code>append</code> 
and <var>File</var> exists, the journal is first replayed. See
<a name="idx:rdfereplayjournal1:181"></a><a class="pred" href="#rdfe_replay_journal/1">rdfe_replay_journal/1</a>. 
If <var>Mode</var> is <code>write</code> the journal is truncated if it 
exists.</dd>
<dt class="pubdef"><a name="rdfe_close_journal/0"><strong>rdfe_close_journal</strong></a></dt>
<dd class="defbody">
Close the currently open journal.</dd>
<dt class="pubdef"><a name="rdfe_current_journal/1"><strong>rdfe_current_journal</strong>(<var>-Path</var>)</a></dt>
<dd class="defbody">
Test whether there is a journal and to which file the actions are 
journalled.</dd>
<dt class="pubdef"><a name="rdfe_replay_journal/1"><strong>rdfe_replay_journal</strong>(<var>+File</var>)</a></dt>
<dd class="defbody">
Read a journal, replaying all actions in it. To do so, the system reads 
the journal a transaction at a time. If the transaction is closed with a <em>commit</em> 
it executes the actions inside the journal. If it is closed with a <em>rollback</em> 
or not closed at all due to a crash the actions inside the journal are 
discarded. Using this predicate only makes sense to inspect the state at 
the end of a journal without modifying the journal. Normally a journal 
is replayed using the
<code>append</code> mode of <a name="idx:rdfeopenjournal2:182"></a><a class="pred" href="#rdfe_open_journal/2">rdfe_open_journal/2</a>.
</dd>
</dl>

<h3><a name="sec:12.7"><span class="sec-nr">12.7</span> <span class="sec-title">Broadcasting 
change events</span></a></h3>

<p><a name="idx:event:183"></a><a name="idx:broadcast:184"></a>To 
realise a modular graphical interface for editing the triple store, the 
system must use some sort of <em>event</em> mechanism. This is 
implemented by the XPCE library <code>library(broadcast)</code> which is 
described in the <a class="url" href="http://hcs.science.uva.nl/projects/xpce/UserGuide/libbroadcast.html">XPCE 
User Guide</a>. In this section we describe the terms brodcasted by the 
library.

<dl class="latex">
<dt><strong>rdf_transaction</strong>(<var>+Id</var>)</dt>
<dd class="defbody">
A `level-0' transaction has been committed. The system passes the 
identifier of the transaction in <var>Id</var>. In the current 
implementation there is no way to find out what happened inside the 
transaction. This is likely to change in time.

<p>If a transaction is reverted due to failure or exception <em>no</em> 
event is broadcasted. The initiating GUI element is supposed to handle 
this possibility itself and other components are not affected as the 
triple store is not changed.</dd>
<dt><strong>rdf_undo</strong>(<var>+Type, +Id</var>)</dt>
<dd class="defbody">
This event is broadcasted after an <a name="idx:rdfeundo0:185"></a><a class="pred" href="#rdfe_undo/0">rdfe_undo/0</a> 
or <a name="idx:rdferedo0:186"></a><a class="pred" href="#rdfe_redo/0">rdfe_redo/0</a>.
<var>Type</var> is one of <code>undo</code> or <code>redo</code> and <var>Id</var> 
identifies the transaction as above.
</dd>
</dl>

<h2><a name="sec:13"><span class="sec-nr">13</span> <span class="sec-title">Related 
packages and issues</span></a></h2>

<p><a name="idx:Sesame:187"></a><a name="idx:SeRQL:188"></a>The 
SWI-Prolog SemWeb package is designed to provide access to the Semantic 
Web languages from Prolog. It consists of the low level
<code>rdf_db.pl</code> store with layers such as <code>library(semweb/rdfs.pl)</code> 
to provide more high level querying of a triple set with relations such 
as
<a name="idx:rdfsindividualof2:189"></a><a class="pred" href="#rdfs_individual_of/2">rdfs_individual_of/2</a>, <a name="idx:rdfssubclassof2:190"></a><a class="pred" href="#rdfs_subclass_of/2">rdfs_subclass_of/2</a>, 
etc.
<a class="url" href="http://www.openrdf.org">SeRQL</a> is a semantic web 
query language taking another route. Instead of providing alternative 
relations SeRQL defines a graph query on de <em>deductive closure</em> 
of the triple set. For example, under assumption of RDFS entailment 
rules this makes the query <code>rdf(S, rdf:type, Class)</code> 
equivalent to
<code>rdfs_individual_of(S, Class)</code>.

<p><a name="idx:optimisingquery:191"></a>We developed a parser for SeRQL 
which compiles SeRQL path expressions into Prolog conjunctions of <code>rdf(Subject, 
Predicate, Object)</code> calls. <em>Entailment modules</em> realise a 
fully logical implementation of <a name="idx:rdf3:192"></a><a class="pred" href="#rdf/3">rdf/3</a> 
including the entailment reasoning required to deal with a Semantic Web 
language or application specific reasoning. The infra structure is 
completed with a query optimiser and an HTTP server compliant to the <a class="url" href="http://www.openrdf.org">Sesame</a> 
implementation of the SeRQL language. The Sesame Java client can be used 
to access Prolog servers from Java, while the Prolog client can be used 
to access the Sesame SeRQL server. For further details, see the
<a class="url" href="http://gollem.science.uva.nl/twiki/pl/bin/view/Library/SeRQL">project 
home</a>.

<h2><a name="sec:14"><span class="sec-nr">14</span> <span class="sec-title">OWL</span></a></h2>

<a name="sec:owl"></a>

<p><a name="idx:OWL:193"></a>The SWI-Prolog Semantic Web library 
provides no direct support for OWL. OWL(-2) support is provided through 
Thea, an OWL library for SWI-Prolog See <a class="url" href="http://www.semanticweb.gr/TheaOWLLib/">http://www.semanticweb.gr/TheaOWLLib/</a>.

<h2><a name="sec:15"><span class="sec-nr">15</span> <span class="sec-title">Forward 
compatibility</span></a></h2>

<p>The development version of SWI-Prolog is moving to version 3 of the 
RDF store. This version mainly improves concurrency, allowing for 
concurrent read and write, including support for the Prolog logical 
update view and properly atomic and isolated transactions. This version 
also rationalizes some of the API aspects. Version&nbsp;2 as distributed 
with SWI-Prolog 6.2.4 introduces the following forward compatibility 
predicates:

<dl class="latex">
<dt class="pubdef"><a name="rdf_register_prefix/2"><strong>rdf_register_prefix</strong>(<var>+Prefix, 
+URL</var>)</a></dt>
<dt class="pubdef"><a name="rdf_register_prefix/2"><strong>rdf_register_prefix</strong>(<var>+Prefix, 
+URL, +Options</var>)</a></dt>
<dd class="defbody">
Replaces <a name="idx:rdfregisterns2:194"></a><a class="pred" href="#rdf_register_ns/2">rdf_register_ns/2</a>,3. 
Otherwise fully compatible. Note that version&nbsp;3 provides <a name="idx:rdfregisterns2:195"></a><a class="pred" href="#rdf_register_ns/2">rdf_register_ns/2</a>,3 
as deprecated predicates.
</dd>
<dt class="pubdef"><a name="rdf_unload_graph/1"><strong>rdf_unload_graph</strong>(<var>+Graph</var>)</a></dt>
<dd class="defbody">
Version&nbsp;3 <a name="idx:rdfunload1:196"></a><a class="pred" href="#rdf_unload/1">rdf_unload/1</a> 
is restricted to unloading a graph loaded from a specific source. New 
code must use <a name="idx:rdfunloadgraph1:197"></a><a class="pred" href="#rdf_unload_graph/1">rdf_unload_graph/1</a> 
if a graph must be deleted by name. Version&nbsp;3 provides backward 
compatibility with a warning.
</dd>
</dl>

<h2>Acknowledgements</h2>

<p>This research was supported by the following projects: MIA and 
MultimediaN project (www.multimedian.nl) funded through the BSIK 
programme of the Dutch Government, the FP-6 project HOPS of the European 
Commision.

<p>The implementation of AVL trees is based on libavl by Brad Appleton. 
See the source file <code>avl.c</code> for details.

<h1><a name="document-index">Index</a></h1>

<dl>
<dt class="index-sep">?</dt>
<dt>broadcast</dt>
<dd>
<a class="idx" href="#idx:broadcast:184">12.7</a></dd>
<dt>compressed data</dt>
<dd>
<a class="idx" href="#idx:compresseddata:104">4.2</a></dd>
<dt>concept/1</dt>
<dd>
<a class="idx" href="#idx:concept1:78">3.5.1</a></dd>
<dt>concurrent/3</dt>
<dd>
<a class="idx" href="#idx:concurrent3:118">4.5</a></dd>
<dt><a class="idx" href="#dc:title">dc:title</a></dt>
<dt>event</dt>
<dd>
<a class="idx" href="#idx:event:183">12.7</a></dd>
<dt>expand_goal/2</dt>
<dd>
<a class="idx" href="#idx:expandgoal2:3">3.1</a> <a class="idx" href="#idx:expandgoal2:74">3.5.1</a></dd>
<dt>goal_expansion/2</dt>
<dd>
<a class="idx" href="#idx:goalexpansion2:68">3.5</a> <a class="idx" href="#idx:goalexpansion2:69">3.5</a></dd>
<dt>gz, format</dt>
<dd>
<a class="idx" href="#idx:gzformat:102">4.2</a></dd>
<dt>gzip</dt>
<dd>
<a class="idx" href="#idx:gzip:103">4.2</a></dd>
<dt>journal</dt>
<dd>
<a class="idx" href="#idx:journal:157">12</a> <a class="idx" href="#idx:journal:180">12.6</a></dd>
<dt>labels/2</dt>
<dd>
<a class="idx" href="#idx:labels2:72">3.5.1</a></dd>
<dt><a class="idx" href="#lang_equal/2">lang_equal/2</a></dt>
<dt><a class="idx" href="#lang_matches/2">lang_matches/2</a></dt>
<dt><a class="idx" href="#lib:source">lib:source</a></dt>
<dt>load_data/0</dt>
<dd>
<a class="idx" href="#idx:loaddata0:153">8.3</a></dd>
<dt>load_files/2</dt>
<dd>
<a class="idx" href="#idx:loadfiles2:50">3.4</a></dd>
<dt>once/1</dt>
<dd>
<a class="idx" href="#idx:once1:159">12.1</a></dd>
<dt>optimising,query</dt>
<dd>
<a class="idx" href="#idx:optimisingquery:191">13</a></dd>
<dt><a class="idx" href="#owl:imports">owl:imports</a></dt>
<dt>print_message/2</dt>
<dd>
<a class="idx" href="#idx:printmessage2:51">3.4</a></dd>
<dt>process_rdf/3</dt>
<dd>
<a class="idx" href="#idx:processrdf3:46">3.4</a> <a class="idx" href="#idx:processrdf3:49">3.4</a></dd>
<dt><a class="idx" href="#rdf/3">rdf/3</a></dt>
<dd>
<a class="idx" href="#idx:rdf3:2">3</a> <a class="idx" href="#idx:rdf3:5">3.1</a> <a class="idx" href="#idx:rdf3:6">3.1</a> <a class="idx" href="#idx:rdf3:7">3.1</a> <a class="idx" href="#idx:rdf3:8">3.1</a> <a class="idx" href="#idx:rdf3:23">3.2</a> <a class="idx" href="#idx:rdf3:27">3.3.1</a> <a class="idx" href="#idx:rdf3:36">3.3.2</a> <a class="idx" href="#idx:rdf3:39">3.3.2</a> <a class="idx" href="#idx:rdf3:71">3.5</a> <a class="idx" href="#idx:rdf3:127">7</a> <a class="idx" href="#idx:rdf3:192">13</a></dd>
<dt><a class="idx" href="#rdf/4">rdf/4</a></dt>
<dd>
<a class="idx" href="#idx:rdf4:4">3.1</a> <a class="idx" href="#idx:rdf4:120">4.5</a></dd>
<dt><a class="idx" href="#rdf_active_transaction/1">rdf_active_transaction/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfactivetransaction1:44">3.3.2</a></dd>
<dt><a class="idx" href="#rdf_assert/3">rdf_assert/3</a></dt>
<dd>
<a class="idx" href="#idx:rdfassert3:28">3.3.1</a> <a class="idx" href="#idx:rdfassert3:35">3.3.2</a> <a class="idx" href="#idx:rdfassert3:62">3.4.3</a> <a class="idx" href="#idx:rdfassert3:171">12.3</a></dd>
<dt><a class="idx" href="#rdf_assert/4">rdf_assert/4</a></dt>
<dd>
<a class="idx" href="#idx:rdfassert4:26">3.3.1</a></dd>
<dt>rdf_assert/[3,4]</dt>
<dd>
<a class="idx" href="#idx:rdfassert34:65">3.4.4</a></dd>
<dt><a class="idx" href="#rdf_atom_md5/3">rdf_atom_md5/3</a></dt>
<dt><a class="idx" href="#rdf_attach_db/2">rdf_attach_db/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfattachdb2:119">4.5</a></dd>
<dt><a class="idx" href="#rdf_attach_library/1">rdf_attach_library/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfattachlibrary1:142">8.1.2</a> <a class="idx" href="#idx:rdfattachlibrary1:146">8.1.2</a> <a class="idx" href="#idx:rdfattachlibrary1:149">8.2</a></dd>
<dt><a class="idx" href="#rdf_bnode/1">rdf_bnode/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfbnode1:133">7.2</a></dd>
<dt><a class="idx" href="#rdf_current_db/1">rdf_current_db/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfcurrentdb1:125">4.5.1</a></dd>
<dt><a class="idx" href="#rdf_current_literal/1">rdf_current_literal/1</a></dt>
<dt><a class="idx" href="#rdf_current_ns/2">rdf_current_ns/2</a></dt>
<dt><a class="idx" href="#rdf_current_predicate/1">rdf_current_predicate/1</a></dt>
<dt><a class="idx" href="#rdf_db:rdf_file_type/2">rdf_db:rdf_file_type/2</a></dt>
<dt><a class="idx" href="#rdf_db:rdf_input_info/3">rdf_db:rdf_input_info/3</a></dt>
<dt><a class="idx" href="#rdf_db:rdf_load_stream/3">rdf_db:rdf_load_stream/3</a></dt>
<dt><a class="idx" href="#rdf_db:rdf_open_hook/3">rdf_db:rdf_open_hook/3</a></dt>
<dt><a class="idx" href="#rdf_db:url_protocol/1">rdf_db:url_protocol/1</a></dt>
<dt><a class="idx" href="#rdf_db_to_file/2">rdf_db_to_file/2</a></dt>
<dt><a class="idx" href="#rdf_delete_literal_map/2">rdf_delete_literal_map/2</a></dt>
<dt><a class="idx" href="#rdf_destroy_literal_map/1">rdf_destroy_literal_map/1</a></dt>
<dt><a class="idx" href="#rdf_detach_db/0">rdf_detach_db/0</a></dt>
<dt><a class="idx" href="#rdf_equal/2">rdf_equal/2</a></dt>
<dt><a class="idx" href="#rdf_equal_graphs/3">rdf_equal_graphs/3</a></dt>
<dt><a class="idx" href="#rdf_estimate_complexity/4">rdf_estimate_complexity/4</a></dt>
<dt>rdf_file_type/2</dt>
<dd>
<a class="idx" href="#idx:rdffiletype2:97">4.1</a> <a class="idx" href="#idx:rdffiletype2:99">4.1</a></dd>
<dt><a class="idx" href="#rdf_find_literal_map/3">rdf_find_literal_map/3</a></dt>
<dd>
<a class="idx" href="#idx:rdffindliteralmap3:114">4.4.1</a></dd>
<dt><a class="idx" href="#rdf_find_literals/2">rdf_find_literals/2</a></dt>
<dd>
<a class="idx" href="#idx:rdffindliterals2:108">4.4</a> <a class="idx" href="#idx:rdffindliterals2:109">4.4</a></dd>
<dt><a class="idx" href="#rdf_flush_journals/1">rdf_flush_journals/1</a></dt>
<dt><a class="idx" href="#rdf_generation/1">rdf_generation/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfgeneration1:32">3.3.1</a></dd>
<dt><a class="idx" href="#rdf_global_id/2">rdf_global_id/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfglobalid2:70">3.5</a></dd>
<dt><a class="idx" href="#rdf_global_object/2">rdf_global_object/2</a></dt>
<dt><a class="idx" href="#rdf_global_term/2">rdf_global_term/2</a></dt>
<dt><a class="idx" href="#rdf_graph/1">rdf_graph/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfgraph1:53">3.4</a></dd>
<dt><a class="idx" href="#rdf_has/3">rdf_has/3</a></dt>
<dd>
<a class="idx" href="#idx:rdfhas3:12">3.1</a> <a class="idx" href="#idx:rdfhas3:17">3.2</a> <a class="idx" href="#idx:rdfhas3:21">3.2</a> <a class="idx" href="#idx:rdfhas3:24">3.2</a> <a class="idx" href="#idx:rdfhas3:25">3.2</a> <a class="idx" href="#idx:rdfhas3:89">3.7</a></dd>
<dt><a class="idx" href="#rdf_has/4">rdf_has/4</a></dt>
<dd>
<a class="idx" href="#idx:rdfhas4:1">3</a> <a class="idx" href="#idx:rdfhas4:9">3.1</a> <a class="idx" href="#idx:rdfhas4:11">3.1</a> <a class="idx" href="#idx:rdfhas4:18">3.2</a></dd>
<dt>rdf_has/[3,4]</dt>
<dd>
<a class="idx" href="#idx:rdfhas34:128">7.1</a> <a class="idx" href="#idx:rdfhas34:129">7.1</a></dd>
<dt>rdf_input_info/3</dt>
<dd>
<a class="idx" href="#idx:rdfinputinfo3:96">4.1</a></dd>
<dt><a class="idx" href="#rdf_insert_literal_map/3">rdf_insert_literal_map/3</a></dt>
<dd>
<a class="idx" href="#idx:rdfinsertliteralmap3:113">4.4.1</a></dd>
<dt><a class="idx" href="#rdf_insert_literal_map/4">rdf_insert_literal_map/4</a></dt>
<dt><a class="idx" href="#rdf_is_bnode/1">rdf_is_bnode/1</a></dt>
<dt><a class="idx" href="#rdf_is_literal/1">rdf_is_literal/1</a></dt>
<dt><a class="idx" href="#rdf_is_resource/1">rdf_is_resource/1</a></dt>
<dt><a class="idx" href="#rdf_journal_file/2">rdf_journal_file/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfjournalfile2:121">4.5.1</a></dd>
<dt><a class="idx" href="#rdf_keys_in_literal_map/3">rdf_keys_in_literal_map/3</a></dt>
<dt><a class="idx" href="#rdf_list_library/0">rdf_list_library/0</a></dt>
<dd>
<a class="idx" href="#idx:rdflistlibrary0:137">8.1</a> <a class="idx" href="#idx:rdflistlibrary0:138">8.1</a> <a class="idx" href="#idx:rdflistlibrary0:150">8.2</a></dd>
<dt><a class="idx" href="#rdf_list_library/1">rdf_list_library/1</a></dt>
<dd>
<a class="idx" href="#idx:rdflistlibrary1:143">8.1.2</a> <a class="idx" href="#idx:rdflistlibrary1:151">8.2</a> <a class="idx" href="#idx:rdflistlibrary1:152">8.2</a></dd>
<dt><a class="idx" href="#rdf_list_library/2">rdf_list_library/2</a></dt>
<dd>
<a class="idx" href="#idx:rdflistlibrary2:144">8.1.2</a> <a class="idx" href="#idx:rdflistlibrary2:147">8.1.2</a></dd>
<dt><a class="idx" href="#rdf_load/1">rdf_load/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfload1:48">3.4</a> <a class="idx" href="#idx:rdfload1:92">3.7</a> <a class="idx" href="#idx:rdfload1:174">12.3</a></dd>
<dt><a class="idx" href="#rdf_load/2">rdf_load/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfload2:55">3.4</a> <a class="idx" href="#idx:rdfload2:58">3.4.1</a> <a class="idx" href="#idx:rdfload2:82">3.6</a> <a class="idx" href="#idx:rdfload2:86">3.6</a> <a class="idx" href="#idx:rdfload2:94">4</a> <a class="idx" href="#idx:rdfload2:101">4.1</a></dd>
<dt>rdf_load/[1,2]</dt>
<dd>
<a class="idx" href="#idx:rdfload12:61">3.4.3</a> <a class="idx" href="#idx:rdfload12:63">3.4.4</a> <a class="idx" href="#idx:rdfload12:67">3.4.4</a></dd>
<dt><a class="idx" href="#rdf_load_db/1">rdf_load_db/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfloaddb1:47">3.4</a> <a class="idx" href="#idx:rdfloaddb1:64">3.4.4</a> <a class="idx" href="#idx:rdfloaddb1:85">3.6</a> <a class="idx" href="#idx:rdfloaddb1:87">3.6</a> <a class="idx" href="#idx:rdfloaddb1:88">3.6</a></dd>
<dt><a class="idx" href="#rdf_load_library/2">rdf_load_library/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfloadlibrary2:139">8.1</a> <a class="idx" href="#idx:rdfloadlibrary2:140">8.1</a> <a class="idx" href="#idx:rdfloadlibrary2:145">8.1.2</a> <a class="idx" href="#idx:rdfloadlibrary2:148">8.1.2</a></dd>
<dt>rdf_load_stream/3</dt>
<dd>
<a class="idx" href="#idx:rdfloadstream3:95">4.1</a> <a class="idx" href="#idx:rdfloadstream3:100">4.1</a></dd>
<dt><a class="idx" href="#rdf_load_turtle/3">rdf_load_turtle/3</a></dt>
<dt><a class="idx" href="#rdf_make/0">rdf_make/0</a></dt>
<dt><a class="idx" href="#rdf_match_label/3">rdf_match_label/3</a></dt>
<dd>
<a class="idx" href="#idx:rdfmatchlabel3:136">7.3</a></dd>
<dt><a class="idx" href="#rdf_md5/2">rdf_md5/2</a></dt>
<dt><a class="idx" href="#rdf_meta/1">rdf_meta/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfmeta1:73">3.5.1</a> <a class="idx" href="#idx:rdfmeta1:76">3.5.1</a> <a class="idx" href="#idx:rdfmeta1:77">3.5.1</a> <a class="idx" href="#idx:rdfmeta1:79">3.5.1</a></dd>
<dt><a class="idx" href="#rdf_monitor/2">rdf_monitor/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfmonitor2:15">3.1.1</a> <a class="idx" href="#idx:rdfmonitor2:43">3.3.2</a> <a class="idx" href="#idx:rdfmonitor2:106">4.4</a> <a class="idx" href="#idx:rdfmonitor2:111">4.4.1</a> <a class="idx" href="#idx:rdfmonitor2:155">12</a></dd>
<dt><a class="idx" href="#rdf_new_literal_map/1">rdf_new_literal_map/1</a></dt>
<dt><a class="idx" href="#rdf_node/1">rdf_node/1</a></dt>
<dt><a class="idx" href="#rdf_persistency/2">rdf_persistency/2</a></dt>
<dt><a class="idx" href="#rdf_portray_as/1">rdf_portray_as/1</a></dt>
<dt><a class="idx" href="#rdf_portray_lang/1">rdf_portray_lang/1</a></dt>
<dt><a class="idx" href="#rdf_predicate_property/2">rdf_predicate_property/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfpredicateproperty2:10">3.1</a> <a class="idx" href="#idx:rdfpredicateproperty2:16">3.2</a> <a class="idx" href="#idx:rdfpredicateproperty2:90">3.7</a></dd>
<dt><a class="idx" href="#rdf_process_turtle/3">rdf_process_turtle/3</a></dt>
<dt><a class="idx" href="#rdf_quote_uri/2">rdf_quote_uri/2</a></dt>
<dt><a class="idx" href="#rdf_reachable/3">rdf_reachable/3</a></dt>
<dd>
<a class="idx" href="#idx:rdfreachable3:13">3.1</a> <a class="idx" href="#idx:rdfreachable3:19">3.2</a> <a class="idx" href="#idx:rdfreachable3:22">3.2</a> <a class="idx" href="#idx:rdfreachable3:93">3.7</a></dd>
<dt><a class="idx" href="#rdf_reachable/5">rdf_reachable/5</a></dt>
<dd>
<a class="idx" href="#idx:rdfreachable5:20">3.2</a></dd>
<dt><a class="idx" href="#rdf_read_turtle/3">rdf_read_turtle/3</a></dt>
<dt><a class="idx" href="#rdf_register_ns/2">rdf_register_ns/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfregisterns2:141">8.1</a> <a class="idx" href="#idx:rdfregisterns2:194">15</a> <a class="idx" href="#idx:rdfregisterns2:195">15</a></dd>
<dt><a class="idx" href="#rdf_register_prefix/2">rdf_register_prefix/2</a></dt>
<dt><a class="idx" href="#rdf_reset_db/0">rdf_reset_db/0</a></dt>
<dd>
<a class="idx" href="#idx:rdfresetdb0:84">3.6</a></dd>
<dt><a class="idx" href="#rdf_reset_literal_map/1">rdf_reset_literal_map/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfresetliteralmap1:112">4.4.1</a></dd>
<dt><a class="idx" href="#rdf_retractall/3">rdf_retractall/3</a></dt>
<dd>
<a class="idx" href="#idx:rdfretractall3:30">3.3.1</a> <a class="idx" href="#idx:rdfretractall3:122">4.5.1</a> <a class="idx" href="#idx:rdfretractall3:172">12.3</a></dd>
<dt><a class="idx" href="#rdf_retractall/4">rdf_retractall/4</a></dt>
<dd>
<a class="idx" href="#idx:rdfretractall4:29">3.3.1</a></dd>
<dt>rdf_retractall/[3,4]</dt>
<dd>
<a class="idx" href="#idx:rdfretractall34:66">3.4.4</a></dd>
<dt><a class="idx" href="#rdf_save/1">rdf_save/1</a></dt>
<dt><a class="idx" href="#rdf_save/2">rdf_save/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfsave2:60">3.4.2</a></dd>
<dt><a class="idx" href="#rdf_save_canonical_turtle/2">rdf_save_canonical_turtle/2</a></dt>
<dt><a class="idx" href="#rdf_save_db/1">rdf_save_db/1</a></dt>
<dt>rdf_save_db/2</dt>
<dd>
<a class="idx" href="#idx:rdfsavedb2:117">4.5</a></dd>
<dt><a class="idx" href="#rdf_save_footer/1">rdf_save_footer/1</a></dt>
<dt><a class="idx" href="#rdf_save_header/2">rdf_save_header/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfsaveheader2:52">3.4</a> <a class="idx" href="#idx:rdfsaveheader2:59">3.4.2</a></dd>
<dt><a class="idx" href="#rdf_save_subject/3">rdf_save_subject/3</a></dt>
<dt><a class="idx" href="#rdf_save_turtle/2">rdf_save_turtle/2</a></dt>
<dt><a class="idx" href="#rdf_set_cache_options/1">rdf_set_cache_options/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfsetcacheoptions1:57">3.4.1</a></dd>
<dt><a class="idx" href="#rdf_set_predicate/2">rdf_set_predicate/2</a></dt>
<dt><a class="idx" href="#rdf_source/1">rdf_source/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfsource1:56">3.4</a> <a class="idx" href="#idx:rdfsource1:116">4.5</a> <a class="idx" href="#idx:rdfsource1:124">4.5.1</a></dd>
<dt><a class="idx" href="#rdf_source/2">rdf_source/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfsource2:54">3.4</a></dd>
<dt><a class="idx" href="#rdf_source_location/2">rdf_source_location/2</a></dt>
<dt><a class="idx" href="#rdf_statistics/1">rdf_statistics/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfstatistics1:91">3.7</a></dd>
<dt><a class="idx" href="#rdf_statistics_literal_map/2">rdf_statistics_literal_map/2</a></dt>
<dt><a class="idx" href="#rdf_subject/1">rdf_subject/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfsubject1:14">3.1</a></dd>
<dt><a class="idx" href="#rdf_token_expansions/2">rdf_token_expansions/2</a></dt>
<dt><a class="idx" href="#rdf_tokenize_literal/2">rdf_tokenize_literal/2</a></dt>
<dt><a class="idx" href="#rdf_transaction/1">rdf_transaction/1</a></dt>
<dd>
<a class="idx" href="#idx:rdftransaction1:40">3.3.2</a> <a class="idx" href="#idx:rdftransaction1:41">3.3.2</a> <a class="idx" href="#idx:rdftransaction1:42">3.3.2</a></dd>
<dt><a class="idx" href="#rdf_transaction/2">rdf_transaction/2</a></dt>
<dd>
<a class="idx" href="#idx:rdftransaction2:37">3.3.2</a> <a class="idx" href="#idx:rdftransaction2:38">3.3.2</a> <a class="idx" href="#idx:rdftransaction2:45">3.3.2</a> <a class="idx" href="#idx:rdftransaction2:80">3.6</a> <a class="idx" href="#idx:rdftransaction2:81">3.6</a> <a class="idx" href="#idx:rdftransaction2:154">12</a></dd>
<dt><a class="idx" href="#rdf_unload/1">rdf_unload/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfunload1:31">3.3.1</a> <a class="idx" href="#idx:rdfunload1:83">3.6</a> <a class="idx" href="#idx:rdfunload1:175">12.3</a> <a class="idx" href="#idx:rdfunload1:196">15</a></dd>
<dt><a class="idx" href="#rdf_unload_graph/1">rdf_unload_graph/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfunloadgraph1:197">15</a></dd>
<dt><a class="idx" href="#rdf_update/4">rdf_update/4</a></dt>
<dd>
<a class="idx" href="#idx:rdfupdate4:33">3.3.1</a> <a class="idx" href="#idx:rdfupdate4:123">4.5.1</a> <a class="idx" href="#idx:rdfupdate4:173">12.3</a></dd>
<dt><a class="idx" href="#rdf_update/5">rdf_update/5</a></dt>
<dt><a class="idx" href="#rdf_version/1">rdf_version/1</a></dt>
<dt><a class="idx" href="#rdfe_assert/3">rdfe_assert/3</a></dt>
<dt><a class="idx" href="#rdfe_can_redo/1">rdfe_can_redo/1</a></dt>
<dt><a class="idx" href="#rdfe_can_undo/1">rdfe_can_undo/1</a></dt>
<dt><a class="idx" href="#rdfe_clear_modified/1">rdfe_clear_modified/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfeclearmodified1:166">12.2</a></dd>
<dt><a class="idx" href="#rdfe_close_journal/0">rdfe_close_journal/0</a></dt>
<dt><a class="idx" href="#rdfe_current_journal/1">rdfe_current_journal/1</a></dt>
<dt><a class="idx" href="#rdfe_delete/1">rdfe_delete/1</a></dt>
<dt><a class="idx" href="#rdfe_get_file_property/2">rdfe_get_file_property/2</a></dt>
<dt><a class="idx" href="#rdfe_is_modified/1">rdfe_is_modified/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfeismodified1:167">12.2</a></dd>
<dt><a class="idx" href="#rdfe_load/1">rdfe_load/1</a></dt>
<dt><a class="idx" href="#rdfe_open_journal/2">rdfe_open_journal/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfeopenjournal2:182">12.6</a></dd>
<dt><a class="idx" href="#rdfe_redo/0">rdfe_redo/0</a></dt>
<dd>
<a class="idx" href="#idx:rdferedo0:186">12.7</a></dd>
<dt><a class="idx" href="#rdfe_replay_journal/1">rdfe_replay_journal/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfereplayjournal1:181">12.6</a></dd>
<dt><a class="idx" href="#rdfe_retractall/3">rdfe_retractall/3</a></dt>
<dt><a class="idx" href="#rdfe_set_file_property/2">rdfe_set_file_property/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfesetfileproperty2:160">12.1</a> <a class="idx" href="#idx:rdfesetfileproperty2:169">12.2</a></dd>
<dt><a class="idx" href="#rdfe_set_transaction_name/1">rdfe_set_transaction_name/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfesettransactionname1:164">12.1</a></dd>
<dt><a class="idx" href="#rdfe_transaction/1">rdfe_transaction/1</a></dt>
<dd>
<a class="idx" href="#idx:rdfetransaction1:161">12.1</a> <a class="idx" href="#idx:rdfetransaction1:163">12.1</a> <a class="idx" href="#idx:rdfetransaction1:168">12.2</a> <a class="idx" href="#idx:rdfetransaction1:170">12.3</a> <a class="idx" href="#idx:rdfetransaction1:177">12.5</a></dd>
<dt><a class="idx" href="#rdfe_transaction/2">rdfe_transaction/2</a></dt>
<dt><a class="idx" href="#rdfe_transaction_member/2">rdfe_transaction_member/2</a></dt>
<dt><a class="idx" href="#rdfe_transaction_name/2">rdfe_transaction_name/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfetransactionname2:165">12.1</a></dd>
<dt><a class="idx" href="#rdfe_undo/0">rdfe_undo/0</a></dt>
<dd>
<a class="idx" href="#idx:rdfeundo0:162">12.1</a> <a class="idx" href="#idx:rdfeundo0:178">12.5</a> <a class="idx" href="#idx:rdfeundo0:179">12.5</a> <a class="idx" href="#idx:rdfeundo0:185">12.7</a></dd>
<dt><a class="idx" href="#rdfe_unload/1">rdfe_unload/1</a></dt>
<dt><a class="idx" href="#rdfe_update/4">rdfe_update/4</a></dt>
<dt><a class="idx" href="#rdfs_assert_list/2">rdfs_assert_list/2</a></dt>
<dt><a class="idx" href="#rdfs_assert_list/3">rdfs_assert_list/3</a></dt>
<dd>
<a class="idx" href="#idx:rdfsassertlist3:132">7.2</a></dd>
<dt><a class="idx" href="#rdfs_class_property/2">rdfs_class_property/2</a></dt>
<dt><a class="idx" href="#rdfs_find/5">rdfs_find/5</a></dt>
<dt><a class="idx" href="#rdfs_individual_of/2">rdfs_individual_of/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfsindividualof2:189">13</a></dd>
<dt><a class="idx" href="#rdfs_label/2">rdfs_label/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfslabel2:134">7.3</a></dd>
<dt><a class="idx" href="#rdfs_label/3">rdfs_label/3</a></dt>
<dt><a class="idx" href="#rdfs_list_to_prolog_list/2">rdfs_list_to_prolog_list/2</a></dt>
<dt><a class="idx" href="#rdfs_member/2">rdfs_member/2</a></dt>
<dt><a class="idx" href="#rdfs_ns_label/2">rdfs_ns_label/2</a></dt>
<dt><a class="idx" href="#rdfs_ns_label/3">rdfs_ns_label/3</a></dt>
<dt><a class="idx" href="#rdfs_subclass_of/2">rdfs_subclass_of/2</a></dt>
<dd>
<a class="idx" href="#idx:rdfssubclassof2:190">13</a></dd>
<dt><a class="idx" href="#rdfs_subproperty_of/2">rdfs_subproperty_of/2</a></dt>
<dt>search</dt>
<dd>
<a class="idx" href="#idx:search:135">7.3</a></dd>
<dt><a class="idx" href="#sparql_query/3">sparql_query/3</a></dt>
<dt><a class="idx" href="#sparql_read_json_result/2">sparql_read_json_result/2</a></dt>
<dt><a class="idx" href="#sparql_read_xml_result/2">sparql_read_xml_result/2</a></dt>
<dt><a class="idx" href="#sparql_set_server/1">sparql_set_server/1</a></dt>
<dt>term_expansion/2</dt>
<dd>
<a class="idx" href="#idx:termexpansion2:75">3.5.1</a></dd>
<dt>time_file/2</dt>
<dd>
<a class="idx" href="#idx:timefile2:98">4.1</a></dd>
<dt>tokenize_atom/2</dt>
<dd>
<a class="idx" href="#idx:tokenizeatom2:107">4.4</a> <a class="idx" href="#idx:tokenizeatom2:110">4.4</a></dd>
<dt>transaction</dt>
<dd>
<a class="idx" href="#idx:transaction:34">3.3.2</a></dd>
<dt>transactions</dt>
<dd>
<a class="idx" href="#idx:transactions:158">12</a></dd>
<dt>undo</dt>
<dd>
<a class="idx" href="#idx:undo:156">12</a> <a class="idx" href="#idx:undo:176">12.5</a></dd>
<dt>xhtml</dt>
<dd>
<a class="idx" href="#idx:xhtml:105">4.3</a></dd>
<dt><a class="idx" href="#lib:CloudNode">lib:CloudNode</a></dt>
<dt>Collection,parseType</dt>
<dd>
<a class="idx" href="#idx:CollectionparseType:131">7.2</a></dd>
<dt class="index-sep">G</dt>
<dt><a class="idx" href="#rdf_graph_property/?Graph, ?Property">rdf_graph_property/?Graph, 
?Property</a></dt>
<dt class="index-sep">I</dt>
<dt><a class="idx" href="#owl:versionInfo">owl:versionInfo</a></dt>
<dt class="index-sep">N</dt>
<dt><a class="idx" href="#lib:Namespace">lib:Namespace</a></dt>
<dt class="index-sep">O</dt>
<dt><a class="idx" href="#lib:Ontology">lib:Ontology</a></dt>
<dt>OWL</dt>
<dd>
<a class="idx" href="#idx:OWL:193">14</a></dd>
<dt class="index-sep">P</dt>
<dt>Persistent store</dt>
<dd>
<a class="idx" href="#idx:Persistentstore:115">4.5</a></dd>
<dt class="index-sep">R</dt>
<dt>RDF-Schema</dt>
<dd>
<a class="idx" href="#idx:RDFSchema:126">7</a></dd>
<dt class="index-sep">S</dt>
<dt>Sesame</dt>
<dd>
<a class="idx" href="#idx:Sesame:187">13</a></dd>
<dt>SeRQL</dt>
<dd>
<a class="idx" href="#idx:SeRQL:188">13</a></dd>
<dt class="index-sep">T</dt>
<dt>parseType,Collection</dt>
<dd>
<a class="idx" href="#idx:parseTypeCollection:130">7.2</a></dd>
<dt class="index-sep">U</dt>
<dt><a class="idx" href="#lib:baseURI">lib:baseURI</a></dt>
<dt class="index-sep">V</dt>
<dt><a class="idx" href="#lib:Virtual">lib:Virtual</a></dt>
<dd>
</dd>
</dl>

</body></html>